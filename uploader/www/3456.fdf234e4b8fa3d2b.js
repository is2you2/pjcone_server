"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3456],{3456:(B,m,l)=>{l.r(m),l.d(m,{ServerDetailPageModule:()=>N});var S=l(177),p=l(4341),d=l(5374),c=l(9858),f=l(467),e=l(3953),C=l(4234),D=l(9900),b=l(755),j=l(3307),R=l(4237),I=l(482),M=l(3656);const P=["ServerDetailuseSSL"];function k(r,_){if(1&r){const s=e.RV6();e.j41(0,"img",26),e.bIt("click",function(){e.eBV(s);const i=e.XpG();return e.Njj(i.copy_startup_address())}),e.k0s()}if(2&r){const s=e.XpG();e.Y8G("src",s.QRCodeSRC,e.B4B)}}function G(r,_){1&r&&(e.j41(0,"div",27),e.EFF(1,"Ctrl + Enter"),e.k0s())}const y=[{path:"",component:(()=>{var r;class _{constructor(t,i,o,a,n,g,u,h,v){this.lang=t,this.p5toast=i,this.indexed=o,this.p5loading=a,this.nakama=n,this.global=g,this.route=u,this.router=h,this.navCtrl=v,this.dedicated_info={},this.index=0}ngOnDestroy(){var t,i;this.global.RestoreShortCutAct("server-detail"),this.route.queryParams.unsubscribe(),null===(t=(i=this.global.PageDismissAct)["quick-server-detail"])||void 0===t||t.call(i)}ngOnInit(){this.route.queryParams.subscribe(t=>{const i=this.router.getCurrentNavigation().extras.state;this.dedicated_info=i.data,this.GenerateQRCode()})}GenerateQRCode(){var t=this;return(0,f.A)(function*(){let i=yield t.nakama.GenerateQRCode(t.dedicated_info);t.QRCodeSRC=t.global.readasQRCodeFromString(i)})()}open_custom_check(){this.global.open_custom_site((this.dedicated_info.useSSL?"https://":"http://")+this.dedicated_info.address,this.dedicated_info.cdn_port)}reGenerateWebRTCInfo(){var t=this;return(0,f.A)(function*(){yield t.nakama.AutoGenWebRTCInfo(t.dedicated_info),t.p5loading.toast(t.lang.text.ServerDetail.RegenWebRTCDone,"restore_webrtc")})()}ionViewDidEnter(){this.ServerDetailuseSSL.checked=this.dedicated_info.useSSL,this.global.StoreShortCutAct("server-detail"),this.global.p5KeyShortCut.EnterAct=t=>{t.ctrlKey&&this.apply_changed_info()},this.global.p5KeyShortCut.Escape=()=>{this.navCtrl.pop()}}copy_startup_address(){this.global.GetHeaderAddress().then(t=>{let i=`${t}?server=${this.dedicated_info.useSSL?"https":"http"}://${this.dedicated_info.address||""}${this.dedicated_info.nakama_port?`:${this.dedicated_info.nakama_port}`:""},${this.dedicated_info.key||""},${this.dedicated_info.cdn_port||""},${this.dedicated_info.apache_port||""},${this.dedicated_info.square_port||""},${this.dedicated_info.webrtc_port||""}`.replace(/ /g,"%20");this.global.WriteValueToClipboard("text/plain",i)})}apply_changed_info(){var t=this;return(0,f.A)(function*(){var i,o;if(!t.dedicated_info.name)return void t.p5toast.show({text:t.lang.text.GroupServer.NeedSetDIsplayName});t.dedicated_info.name=t.dedicated_info.name,t.dedicated_info.target=t.dedicated_info.target||t.dedicated_info.name,t.dedicated_info.address=t.dedicated_info.address||"192.168.0.1",t.dedicated_info.nakama_port=t.dedicated_info.nakama_port,t.dedicated_info.cdn_port=t.dedicated_info.cdn_port,t.dedicated_info.apache_port=t.dedicated_info.apache_port,t.dedicated_info.square_port=t.dedicated_info.square_port,t.dedicated_info.webrtc_port=t.dedicated_info.webrtc_port,t.dedicated_info.useSSL=t.ServerDetailuseSSL.checked||!1,t.dedicated_info.isOfficial=t.dedicated_info.isOfficial||"unofficial",t.dedicated_info.key=t.dedicated_info.key||"";let a=(new Date).getTime().toString();a+=`,${t.dedicated_info.isOfficial}`,a+=`,${t.dedicated_info.name}`,a+=`,${t.dedicated_info.target}`,a+=`,${t.dedicated_info.address}`,a+=`,${t.dedicated_info.nakama_port||""}`,a+=`,${t.dedicated_info.useSSL||""}`,a+=`,${t.dedicated_info.cdn_port||""}`,a+=`,${t.dedicated_info.apache_port||""}`,a+=`,${t.dedicated_info.square_port||""}`,a+=`,${t.dedicated_info.webrtc_port||""}`;let n=yield t.indexed.loadTextFromUserPath("servers/list_detail.csv"),g=[];n&&(g=n.split("\n"));for(let u=0,h=g.length;u<h;u++)if(g[u].split(",")[3]==t.dedicated_info.target){g.splice(u,1);break}g.push(a),yield t.indexed.saveTextFileToUserPath(g.join("\n"),"servers/list_detail.csv"),t.nakama.init_server(t.dedicated_info),t.nakama.servers[t.dedicated_info.isOfficial][t.dedicated_info.target].info={...t.dedicated_info};try{t.nakama.servers[t.dedicated_info.isOfficial][t.dedicated_info.target].socket.disconnect(!0)}catch{}null===(i=(o=t.global.PageDismissAct)["quick-server-detail"])||void 0===i||i.call(o),t.navCtrl.pop()})()}ionViewWillLeave(){delete this.global.p5KeyShortCut.Escape,delete this.global.p5KeyShortCut.EnterAct}}return(r=_).\u0275fac=function(t){return new(t||r)(e.rXU(C.y),e.rXU(D.G),e.rXU(b.n),e.rXU(j.f),e.rXU(R.X),e.rXU(I.z3),e.rXU(c.nX),e.rXU(c.Ix),e.rXU(M.q9))},r.\u0275cmp=e.VBU({type:r,selectors:[["app-server-detail"]],viewQuery:function(t,i){if(1&t&&e.GBs(P,5),2&t){let o;e.mGM(o=e.lsd())&&(i.ServerDetailuseSSL=o.first)}},decls:52,vars:29,consts:[["ServerDetailInfo",""],["ServerDetailuseSSL",""],[1,"ion-no-border"],["slot","start"],["defaultHref",""],["style","width: 100%; height: auto; cursor: copy;","alt","Loading",3,"src","click",4,"ngIf"],["button",""],[1,"ion-text-right",3,"ionInput","ngModelChange","label","ngModel","placeholder"],["placeholder","192.168.0.1",1,"ion-text-right",3,"ngModelChange","ionInput","label","ngModel"],["slot","end","name","open-outline",3,"click"],["value","Detail"],["slot","header"],["slot","content"],["button","",3,"click"],["color","tertiary",1,"ion-text-center"],["button","","disabled",""],["placeholder","defaultkey",1,"ion-text-right",3,"ngModelChange","ionInput","label","ngModel"],["type","number","placeholder","7350",1,"ion-text-right",3,"ngModelChange","ionInput","label","ngModel"],["type","number","placeholder","9001",1,"ion-text-right",3,"ngModelChange","ionInput","label","ngModel"],["type","number","placeholder","9002",1,"ion-text-right",3,"ngModelChange","ionInput","label","ngModel"],["type","number","placeholder","12013",1,"ion-text-right",3,"ngModelChange","ionInput","label","ngModel"],["type","number","placeholder","3478",1,"ion-text-right",3,"ngModelChange","ionInput","label","ngModel"],[2,"pointer-events","none",3,"ngModelChange","ionChange","ngModel"],[2,"position","relative"],["class","shortcut_hint",4,"ngIf"],[1,"ion-text-center"],["alt","Loading",2,"width","100%","height","auto","cursor","copy",3,"click","src"],[1,"shortcut_hint"]],template:function(t,i){if(1&t){const o=e.RV6();e.j41(0,"ion-header",2)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s(),e.j41(4,"ion-buttons",3),e.nrm(5,"ion-back-button",4),e.k0s()()(),e.j41(6,"ion-content")(7,"ion-item-divider")(8,"ion-label"),e.EFF(9),e.k0s()(),e.DNE(10,k,1,1,"img",5),e.j41(11,"ion-item-divider")(12,"ion-label"),e.EFF(13,"\uc11c\ubc84 \uc124\uc815"),e.k0s()(),e.j41(14,"ion-item",6)(15,"ion-input",7),e.bIt("ionInput",function(){return e.eBV(o),e.Njj(i.GenerateQRCode())}),e.mxI("ngModelChange",function(n){return e.eBV(o),e.DH7(i.dedicated_info.name,n)||(i.dedicated_info.name=n),e.Njj(n)}),e.k0s()(),e.j41(16,"ion-item",6)(17,"ion-input",8),e.mxI("ngModelChange",function(n){return e.eBV(o),e.DH7(i.dedicated_info.address,n)||(i.dedicated_info.address=n),e.Njj(n)}),e.bIt("ionInput",function(){return e.eBV(o),e.Njj(i.GenerateQRCode())}),e.k0s(),e.j41(18,"ion-icon",9),e.bIt("click",function(){return e.eBV(o),e.Njj(i.open_custom_check())}),e.k0s()(),e.j41(19,"ion-accordion-group",null,0)(21,"ion-accordion",10)(22,"ion-item",11)(23,"ion-label"),e.EFF(24),e.k0s()(),e.j41(25,"div",12)(26,"ion-item",13),e.bIt("click",function(){return e.eBV(o),e.Njj(i.reGenerateWebRTCInfo())}),e.j41(27,"ion-label",14),e.EFF(28),e.k0s()(),e.j41(29,"ion-item",15)(30,"ion-input",7),e.bIt("ionInput",function(){return e.eBV(o),e.Njj(i.GenerateQRCode())}),e.mxI("ngModelChange",function(n){return e.eBV(o),e.DH7(i.dedicated_info.target,n)||(i.dedicated_info.target=n),e.Njj(n)}),e.k0s()(),e.j41(31,"ion-item",6)(32,"ion-input",16),e.mxI("ngModelChange",function(n){return e.eBV(o),e.DH7(i.dedicated_info.key,n)||(i.dedicated_info.key=n),e.Njj(n)}),e.bIt("ionInput",function(){return e.eBV(o),e.Njj(i.GenerateQRCode())}),e.k0s()(),e.j41(33,"ion-item",6)(34,"ion-input",17),e.mxI("ngModelChange",function(n){return e.eBV(o),e.DH7(i.dedicated_info.nakama_port,n)||(i.dedicated_info.nakama_port=n),e.Njj(n)}),e.bIt("ionInput",function(){return e.eBV(o),e.Njj(i.GenerateQRCode())}),e.k0s()(),e.j41(35,"ion-item",6)(36,"ion-input",18),e.mxI("ngModelChange",function(n){return e.eBV(o),e.DH7(i.dedicated_info.cdn_port,n)||(i.dedicated_info.cdn_port=n),e.Njj(n)}),e.bIt("ionInput",function(){return e.eBV(o),e.Njj(i.GenerateQRCode())}),e.k0s()(),e.j41(37,"ion-item",6)(38,"ion-input",19),e.mxI("ngModelChange",function(n){return e.eBV(o),e.DH7(i.dedicated_info.apache_port,n)||(i.dedicated_info.apache_port=n),e.Njj(n)}),e.bIt("ionInput",function(){return e.eBV(o),e.Njj(i.GenerateQRCode())}),e.k0s()(),e.j41(39,"ion-item",6)(40,"ion-input",20),e.mxI("ngModelChange",function(n){return e.eBV(o),e.DH7(i.dedicated_info.square_port,n)||(i.dedicated_info.square_port=n),e.Njj(n)}),e.bIt("ionInput",function(){return e.eBV(o),e.Njj(i.GenerateQRCode())}),e.k0s()(),e.j41(41,"ion-item",6)(42,"ion-input",21),e.mxI("ngModelChange",function(n){return e.eBV(o),e.DH7(i.dedicated_info.webrtc_port,n)||(i.dedicated_info.webrtc_port=n),e.Njj(n)}),e.bIt("ionInput",function(){return e.eBV(o),e.Njj(i.GenerateQRCode())}),e.k0s()(),e.j41(43,"ion-item",13),e.bIt("click",function(){return e.eBV(o),e.Njj(i.dedicated_info.useSSL=!i.dedicated_info.useSSL)}),e.j41(44,"ion-toggle",22,1),e.mxI("ngModelChange",function(n){return e.eBV(o),e.DH7(i.dedicated_info.useSSL,n)||(i.dedicated_info.useSSL=n),e.Njj(n)}),e.bIt("ionChange",function(){return e.eBV(o),e.Njj(i.GenerateQRCode())}),e.EFF(46),e.k0s()()()()(),e.j41(47,"div",23),e.DNE(48,G,2,0,"div",24),e.j41(49,"ion-item",13),e.bIt("click",function(){return e.eBV(o),e.Njj(i.apply_changed_info())}),e.j41(50,"ion-label",25),e.EFF(51),e.k0s()()()()}2&t&&(e.R7$(3),e.JRh(i.lang.text.GroupServer.ServerDetail),e.R7$(6),e.JRh(i.lang.text.ServerDetail.copy_scan_below),e.R7$(),e.Y8G("ngIf",i.QRCodeSRC),e.R7$(5),e.Y8G("label",i.lang.text.GroupServer.DisplayName),e.R50("ngModel",i.dedicated_info.name),e.Y8G("placeholder",i.lang.text.GroupServer.DisplayName_placeholder),e.R7$(2),e.Y8G("label",i.lang.text.GroupServer.Address),e.R50("ngModel",i.dedicated_info.address),e.R7$(7),e.JRh(i.lang.text.ServerDetail.detailInfo),e.R7$(4),e.JRh(i.lang.text.ServerDetail.RegenWebRTC),e.R7$(2),e.Y8G("label",i.lang.text.GroupServer.DivisionName),e.R50("ngModel",i.dedicated_info.target),e.Y8G("placeholder",i.dedicated_info.name||i.lang.text.GroupServer.DivisionName_placeholder),e.R7$(2),e.Y8G("label",i.lang.text.GroupServer.Key),e.R50("ngModel",i.dedicated_info.key),e.R7$(2),e.Y8G("label",i.lang.text.GroupServer.Port),e.R50("ngModel",i.dedicated_info.nakama_port),e.R7$(2),e.Y8G("label",i.lang.text.GroupServer.cdnPort),e.R50("ngModel",i.dedicated_info.cdn_port),e.R7$(2),e.Y8G("label",i.lang.text.GroupServer.apachePort),e.R50("ngModel",i.dedicated_info.apache_port),e.R7$(2),e.Y8G("label",i.lang.text.GroupServer.SquarePort),e.R50("ngModel",i.dedicated_info.square_port),e.R7$(2),e.Y8G("label",i.lang.text.GroupServer.WebRTCPort),e.R50("ngModel",i.dedicated_info.webrtc_port),e.R7$(2),e.R50("ngModel",i.dedicated_info.useSSL),e.R7$(2),e.JRh(i.lang.text.GroupServer.isSSL),e.R7$(2),e.Y8G("ngIf",i.global.ShowHint),e.R7$(3),e.JRh(i.lang.text.ServerDetail.ApplyChangeServerInfo))},dependencies:[S.bT,p.BC,p.vS,d.xk,d.YH,d.QW,d.W9,d.eU,d.iq,d.$w,d.uz,d.Dg,d.he,d.BC,d.BY,d.ai,d.hB,d.su,d.Gw,d.el],styles:[".icon_style[_ngcontent-%COMP%]{width:22px;height:22px;transform:translateY(2px);margin-left:4px;margin-right:4px}ion-input[_ngcontent-%COMP%]{--highlight-color-valid: var(--ion-color-primary)}"]}),_})()}];let T=(()=>{var r;class _{}return(r=_).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[c.iI.forChild(y),c.iI]}),_})(),N=(()=>{var r;class _{}return(r=_).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[S.MD,p.YN,d.bv,T]}),_})()}}]);