"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6767],{6767:(De,T,_)=>{_.r(T),_.d(T,{ArcadePageModule:()=>$e});var C=_(177),I=_(4341),h=_(5374),S=_(9858),m=_(467),B=_(617),F=_(8326),$=_(482),w=_(5402),D=_(92),e=_(3953),E=_(4234),V=_(8065),N=_(4237),O=_(3656),M=_(9347),U=_(755),X=_(9900),Q=_(3307),Y=_(7476),J=_(5547);const W=["ArcadeDetail"],z=["ArcadeQRShare"],H=["InAppQRScanner"],K=["arcadeInput"];function Z(n,s){if(1&n){const i=e.RV6();e.j41(0,"ion-header",11)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s(),e.j41(4,"img",12),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.QuickLinkAct())})("contextmenu",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.QuickLinkContextmenu())}),e.k0s(),e.j41(5,"input",13),e.bIt("change",function(a){e.eBV(i);const r=e.XpG();return e.Njj(r.SelectVoidDrawBackgroundImage(a))}),e.k0s(),e.j41(6,"div",14),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.JoinInstantCall())}),e.nrm(7,"ion-icon",15),e.k0s(),e.j41(8,"div",16),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.JoinSmallTalk())}),e.nrm(9,"ion-icon",17),e.k0s(),e.j41(10,"div",18),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.nakama.toggle_all_session())}),e.k0s()()()}if(2&n){const i=e.XpG();e.R7$(3),e.JRh(i.lang.text.Arcade.Title),e.R7$(7),e.Aen("background-color: "+i.statusBar.colors[i.statusBar.settings.groupServer]+"; cursor: pointer;")}}function q(n,s){if(1&n&&e.nrm(0,"div"),2&n){const i=e.XpG(2);e.Aen("width: 100%; height: 100%; background-image: url("+i.global.AvatarThumbnailURL+"); background-size: cover; background-position: center; opacity: 0.5;")}}function ee(n,s){1&n&&e.nrm(0,"ion-icon",29)}function te(n,s){if(1&n&&e.nrm(0,"div",36),2&n){const i=e.XpG().$implicit;e.Aen("background-image: url("+i.cover+");")}}function ae(n,s){if(1&n){const i=e.RV6();e.j41(0,"div",34),e.bIt("click",function(){const a=e.eBV(i).$implicit,r=e.XpG(3);return e.Njj(r.ShowGameInfo(a))}),e.DNE(1,te,1,2,"div",35),e.j41(2,"div",22),e.EFF(3),e.k0s()()}if(2&n){const i=s.$implicit;e.Y8G("hidden",i.hide),e.R7$(),e.Y8G("ngIf",i.cover),e.R7$(2),e.SpI(" ",i.name," ")}}function ie(n,s){if(1&n){const i=e.RV6();e.j41(0,"div")(1,"ion-item-divider")(2,"ion-label"),e.EFF(3),e.k0s(),e.j41(4,"div",30),e.nrm(5,"ion-icon",31),e.j41(6,"input",32),e.bIt("input",function(a){e.eBV(i);const r=e.XpG(2);return e.Njj(r.SearchTextInput("official",a))}),e.k0s()()(),e.j41(7,"div",19),e.DNE(8,ae,4,3,"div",33),e.k0s()()}if(2&n){const i=e.XpG(2);e.R7$(3),e.JRh(i.lang.text.Arcade.OfficialList),e.R7$(3),e.Y8G("placeholder",i.lang.text.Arcade.Search),e.R7$(2),e.Y8G("ngForOf",i.nakama.ArcadeListOfficial)}}function ne(n,s){if(1&n&&e.nrm(0,"div",36),2&n){const i=e.XpG().$implicit;e.Aen("background-image: url("+i.cover+");")}}function re(n,s){if(1&n){const i=e.RV6();e.j41(0,"div",40),e.bIt("click",function(){const a=e.eBV(i).$implicit,r=e.XpG(3);return e.Njj(r.ShowGameInfo(a))}),e.DNE(1,ne,1,2,"div",35),e.j41(2,"div",22),e.EFF(3),e.k0s()()}if(2&n){const i=s.$implicit;e.Y8G("hidden",i.hide),e.R7$(),e.Y8G("ngIf",i.cover),e.R7$(2),e.SpI(" ",i.name," ")}}function oe(n,s){if(1&n){const i=e.RV6();e.j41(0,"div")(1,"ion-item-divider")(2,"ion-label"),e.EFF(3),e.k0s(),e.j41(4,"div",30),e.nrm(5,"ion-icon",31),e.j41(6,"input",37),e.bIt("input",function(a){e.eBV(i);const r=e.XpG(2);return e.Njj(r.SearchTextInput("dedicated",a))}),e.k0s()()(),e.j41(7,"div",38),e.DNE(8,re,4,3,"div",39),e.k0s()()}if(2&n){const i=e.XpG(2);e.R7$(3),e.JRh(i.lang.text.Arcade.DediList),e.R7$(3),e.Y8G("placeholder",i.lang.text.Arcade.Search),e.R7$(2),e.Y8G("ngForOf",i.nakama.ArcadeList)}}function le(n,s){if(1&n){const i=e.RV6();e.j41(0,"div")(1,"ion-item-divider")(2,"ion-label"),e.EFF(3),e.k0s()(),e.j41(4,"div",19)(5,"div",20),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.LoadCharacter())})("contextmenu",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.LoadCharacterFromLink())}),e.DNE(6,q,1,2,"div",21),e.j41(7,"div",22),e.DNE(8,ee,1,0,"ion-icon",23),e.j41(9,"div")(10,"ion-label",24),e.EFF(11),e.k0s()()()(),e.j41(12,"input",25),e.bIt("change",function(a){e.eBV(i);const r=e.XpG();return e.Njj(r.LoadUserCharacter(a))}),e.k0s(),e.j41(13,"div",20),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.OpenScanner())})("contextmenu",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.OpenQuickLink())}),e.j41(14,"div",22),e.nrm(15,"ion-icon",26),e.j41(16,"div")(17,"ion-label",24),e.EFF(18,"QRCode"),e.k0s()()()(),e.j41(19,"input",27),e.bIt("change",function(a){e.eBV(i);const r=e.XpG();return e.Njj(r.LoadFileFromLocalAct(a))}),e.k0s(),e.j41(20,"div",20),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.LoadFileFromLocal())})("contextmenu",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.LoadFileFromClipboard())}),e.j41(21,"div",22),e.nrm(22,"ion-icon",28),e.j41(23,"div")(24,"ion-label",24),e.EFF(25),e.k0s()()()()(),e.DNE(26,ie,9,3,"div",7)(27,oe,9,3,"div",7),e.k0s()}if(2&n){const i=e.XpG();e.R7$(3),e.JRh(i.lang.text.Arcade.AddCustom),e.R7$(3),e.Y8G("ngIf",i.global.AvatarThumbnailURL),e.R7$(2),e.Y8G("ngIf",!i.global.AvatarThumbnailURL),e.R7$(3),e.JRh(i.lang.text.Arcade.RegAvatar),e.R7$(14),e.JRh(i.lang.text.Arcade.FromFile),e.R7$(),e.Y8G("ngIf",i.nakama.ArcadeListOfficial.length),e.R7$(),e.Y8G("ngIf",i.nakama.ArcadeList.length)}}function ce(n,s){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&n){const i=e.XpG().$implicit;e.Aen("color: #"+i.color),e.R7$(),e.JRh(" "+i.text)}}function se(n,s){if(1&n&&(e.j41(0,"b"),e.EFF(1),e.k0s()),2&n){const i=e.XpG(2).$implicit;e.R7$(),e.SpI("",i.target,":")}}function de(n,s){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&n){const i=e.XpG().$implicit;e.R7$(),e.JRh(i.text)}}function _e(n,s){if(1&n){const i=e.RV6();e.j41(0,"a",60),e.bIt("click",function(){e.eBV(i);const a=e.XpG().$implicit,r=e.XpG(6);return e.Njj(r.nakama.open_url_link(a.text))}),e.EFF(1),e.k0s()}if(2&n){const i=e.XpG().$implicit;e.Y8G("href",i.text,e.B4B),e.R7$(),e.JRh(i.text)}}function ge(n,s){if(1&n&&(e.j41(0,"span"),e.DNE(1,de,2,1,"span",7)(2,_e,2,2,"a",59),e.k0s()),2&n){const i=s.$implicit;e.R7$(),e.Y8G("ngIf",!i.href),e.R7$(),e.Y8G("ngIf",i.href)}}function pe(n,s){if(1&n&&(e.j41(0,"span"),e.DNE(1,ge,3,2,"span",48),e.k0s()),2&n){const i=e.XpG(2).$implicit;e.Aen(i.isSystem?"color: var(--arcade-fix-system-color)":""),e.R7$(),e.Y8G("ngForOf",i.text)}}function ue(n,s){if(1&n){const i=e.RV6();e.j41(0,"span")(1,"span",61),e.bIt("click",function(){e.eBV(i);const a=e.XpG(2).$implicit,r=e.XpG(3);return e.Njj(r.open_file_viewer(a.file.info))}),e.EFF(2),e.k0s()()}if(2&n){const i=e.XpG(2).$implicit,t=e.XpG(3);e.R7$(2),e.JRh(t.lang.text.ChatRoom.attachments+": "+i.file.info.filename)}}function me(n,s){if(1&n&&(e.j41(0,"span",58)(1,"span"),e.DNE(2,se,2,1,"b",7),e.k0s(),e.DNE(3,pe,2,3,"span",21)(4,ue,3,1,"span",7),e.k0s()),2&n){const i=e.XpG().$implicit;e.R7$(),e.Aen("color: #"+i.color),e.R7$(),e.Y8G("ngIf",i.target),e.R7$(),e.Y8G("ngIf",i.text),e.R7$(),e.Y8G("ngIf",i.file)}}function he(n,s){if(1&n&&(e.j41(0,"p"),e.DNE(1,ce,2,3,"span",21)(2,me,5,5,"span",57),e.k0s()),2&n){const i=s.$implicit;e.R7$(),e.Y8G("ngIf",!i.target),e.R7$(),e.Y8G("ngIf",i.target)}}function fe(n,s){if(1&n&&e.nrm(0,"ion-icon",68),2&n){const i=e.XpG().$implicit;e.Y8G("name",i.icon||"close-circle")}}function ve(n,s){if(1&n&&e.nrm(0,"img",69),2&n){const i=e.XpG().$implicit;e.Y8G("src","assets/icon/"+i.icon_img,e.B4B)("alt",i.title)}}function be(n,s){if(1&n){const i=e.RV6();e.j41(0,"div",64)(1,"div",65),e.bIt("click",function(){const a=e.eBV(i).$implicit;return e.Njj(a.act())})("contextmenu",function(){const a=e.eBV(i).$implicit;return e.Njj(a.context?a.context():null)}),e.DNE(2,fe,1,1,"ion-icon",66)(3,ve,1,2,"img",67),e.j41(4,"div"),e.EFF(5),e.k0s()()()}if(2&n){const i=s.$implicit;e.R7$(),e.Aen("cursor: "+(i.cursor||"pointer")+";"),e.Y8G("hidden",i.isHide),e.R7$(),e.Y8G("ngIf",i.icon),e.R7$(),e.Y8G("ngIf",i.icon_img),e.R7$(2),e.JRh(i.name)}}function xe(n,s){if(1&n&&(e.j41(0,"div",62),e.DNE(1,be,6,6,"div",63),e.k0s()),2&n){const i=e.XpG(3);e.R7$(),e.Y8G("ngForOf",i.extended_buttons)}}function Ae(n,s){if(1&n){const i=e.RV6();e.j41(0,"div",44)(1,"div",45)(2,"div",46)(3,"div",47),e.DNE(4,he,3,2,"p",48),e.k0s()(),e.j41(5,"table",49)(6,"tr")(7,"td")(8,"ion-button",50),e.bIt("click",function(){e.eBV(i);const a=e.XpG(2);return e.Njj(a.ToggleExtMenu())}),e.nrm(9,"ion-icon",51),e.k0s(),e.j41(10,"input",52),e.bIt("change",function(a){e.eBV(i);const r=e.XpG(2);return e.Njj(r.SendAttachAct(a))}),e.k0s()(),e.j41(11,"td",53)(12,"ion-input",54,3),e.bIt("ionFocus",function(){e.eBV(i);const a=e.XpG(2);return e.Njj(a.focus_on_input(120))})("keyup.enter",function(){e.eBV(i);const a=e.XpG(2);return e.Njj(a.send())}),e.mxI("ngModelChange",function(a){e.eBV(i);const r=e.XpG(2);return e.DH7(r.global.arcadeChat.text,a)||(r.global.arcadeChat.text=a),e.Njj(a)}),e.k0s()(),e.j41(14,"td")(15,"ion-button",50),e.bIt("click",function(){e.eBV(i);const a=e.XpG(2);return e.Njj(a.send())}),e.nrm(16,"ion-icon",55),e.k0s()()()(),e.DNE(17,xe,2,1,"div",56),e.k0s()()}if(2&n){const i=e.XpG(2);e.R7$(4),e.Y8G("ngForOf",i.global.arcadeChat.logs),e.R7$(8),e.Y8G("placeholder",i.lang.text.ChatRoom.input_placeholder),e.R50("ngModel",i.global.arcadeChat.text),e.R7$(5),e.Y8G("ngIf",i.ShowExtMenus)}}function ke(n,s){if(1&n&&(e.j41(0,"div",41)(1,"div",42),e.DNE(2,Ae,18,4,"div",43),e.k0s()()),2&n){const i=e.XpG();e.R7$(2),e.Y8G("ngIf",i.global.ToggleChatInput)}}function Re(n,s){if(1&n){const i=e.RV6();e.j41(0,"ion-item",87),e.bIt("click",function(){const a=e.eBV(i).index,r=e.XpG(3);return e.Njj(r.select_server(a))}),e.j41(1,"ion-label"),e.EFF(2),e.k0s()()}if(2&n){const i=s.$implicit;e.R7$(2),e.JRh(i.name)}}function ye(n,s){if(1&n){const i=e.RV6();e.j41(0,"ion-accordion-group",79,4),e.bIt("click",function(){e.eBV(i);const a=e.XpG(2);return e.Njj(a.isExpanded=!0)}),e.j41(2,"ion-accordion",80)(3,"ion-item",81)(4,"ion-label",82),e.EFF(5),e.k0s(),e.j41(6,"ion-label",83),e.EFF(7),e.k0s(),e.nrm(8,"ion-icon",84),e.k0s(),e.j41(9,"div",85),e.DNE(10,Re,3,1,"ion-item",86),e.k0s()()()}if(2&n){const i=e.XpG(2);e.Y8G("value",i.isExpanded),e.R7$(5),e.JRh(i.lang.text.AddGroup.SelectServer),e.R7$(2),e.JRh(i.servers[i.index].name),e.R7$(3),e.Y8G("ngForOf",i.servers)}}function je(n,s){if(1&n){const i=e.RV6();e.j41(0,"ion-item",88)(1,"ion-input",89),e.mxI("ngModelChange",function(a){e.eBV(i);const r=e.XpG(2);return e.DH7(r.global.ArcadeUserInputAddress,a)||(r.global.ArcadeUserInputAddress=a),e.Njj(a)}),e.k0s()()}if(2&n){const i=e.XpG(2);e.R7$(),e.Y8G("label",i.lang.text.voidDraw.LocalAddrInput),e.R50("ngModel",i.global.ArcadeUserInputAddress)}}function Pe(n,s){if(1&n){const i=e.RV6();e.j41(0,"div",70),e.bIt("click",function(a){e.eBV(i);const r=e.XpG();return e.Njj(r.CheckIfDismissAct(a))}),e.j41(1,"div",71)(2,"div",72)(3,"div",73)(4,"h1"),e.EFF(5),e.k0s(),e.j41(6,"div",74),e.EFF(7),e.k0s(),e.j41(8,"div",75),e.EFF(9),e.k0s(),e.DNE(10,ye,11,4,"ion-accordion-group",76),e.j41(11,"div"),e.DNE(12,je,2,2,"ion-item",77),e.j41(13,"ion-button",78),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.StartGame())}),e.EFF(14),e.k0s()()()()()()}if(2&n){const i=e.XpG();e.R7$(2),e.Aen(i.TargetArcadeInfo.cover?"background-image: url("+i.TargetArcadeInfo.cover+"); background-size: cover; background-position: center;":""),e.R7$(3),e.JRh(i.TargetArcadeInfo.name),e.R7$(2),e.SpI(" ",i.lang.text.Arcade.GameLang+": "+i.TargetArcadeInfo.lang," "),e.R7$(2),e.SpI(" ",i.TargetArcadeInfo.desc," "),e.R7$(),e.Y8G("ngIf",i.servers.length),e.R7$(2),e.Y8G("ngIf",0==i.index),e.R7$(),e.Y8G("disabled",!i.servers.length),e.R7$(),e.SpI(" ",i.lang.text.Arcade.StartGame," ")}}function Ce(n,s){if(1&n){const i=e.RV6();e.j41(0,"img",95),e.bIt("click",function(){e.eBV(i);const a=e.XpG(2);return e.Njj(a.copy_address(a.global.ArcadeQRAddress))}),e.k0s()}if(2&n){const i=e.XpG(2);e.Y8G("src",i.global.ArcadeQRCodeSRC,e.B4B)}}function Ie(n,s){if(1&n){const i=e.RV6();e.j41(0,"div",90),e.bIt("click",function(a){e.eBV(i);const r=e.XpG();return e.Njj(r.CheckIfDismissAct(a))}),e.j41(1,"div",91)(2,"div",92),e.DNE(3,Ce,1,1,"img",93),e.j41(4,"ion-item",87),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.copy_address(a.global.ArcadeQRAddress))}),e.j41(5,"ion-label",94),e.EFF(6),e.k0s()()()()()}if(2&n){const i=e.XpG();e.R7$(3),e.Y8G("ngIf",i.global.ArcadeQRCodeSRC),e.R7$(3),e.JRh(i.global.ArcadeQRAddress)}}function we(n,s){if(1&n&&(e.j41(0,"ion-label",103),e.EFF(1),e.k0s()),2&n){const i=e.XpG(2);e.R7$(),e.JRh(i.lang.text.Subscribes.QRScanPlaceholder)}}function Ge(n,s){if(1&n&&(e.j41(0,"ion-label",94),e.EFF(1),e.k0s()),2&n){const i=e.XpG(2);e.R7$(),e.JRh(i.QRScanResult)}}function Te(n,s){if(1&n){const i=e.RV6();e.j41(0,"div",96),e.bIt("click",function(a){e.eBV(i);const r=e.XpG();return e.Njj(r.CheckIfDismissAct(a))}),e.j41(1,"div",91)(2,"div",97)(3,"div",98),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.ChangeScanDevice())}),e.nrm(4,"ion-icon",99),e.k0s(),e.nrm(5,"iframe",100),e.j41(6,"ion-item",87),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.copy_address(a.QRScanResult))}),e.DNE(7,we,2,1,"ion-label",101)(8,Ge,2,1,"ion-label",102),e.k0s()()()()}if(2&n){const i=e.XpG();e.R7$(7),e.Y8G("ngIf",!i.QRScanResult),e.R7$(),e.Y8G("ngIf",i.QRScanResult)}}const Se=[{path:"",component:(()=>{var n;class s{constructor(t,a,r,c,o,l,d,u,p,f,A,L){var v,g=this;this.lang=t,this.statusBar=a,this.nakama=r,this.navCtrl=c,this.client=o,this.global=l,this.indexed=d,this.animationCtrl=u,this.p5toast=p,this.p5loading=f,this.floatButton=A,this.noti=L,this.WillLeave=!1,this.TargetArcadeInfo={},this.servers=[],this.index=0,this.isExpanded=!1,this.enterAnimation=v=>{const b=v.shadowRoot,k=this.animationCtrl.create().addElement(b.querySelector("ion-backdrop")).fromTo("opacity","0.01","var(--backdrop-opacity)"),x=this.animationCtrl.create().addElement(b.querySelector(".modal-wrapper")).keyframes([{offset:0,opacity:"0",transform:"scale(0)"},{offset:1,opacity:"1",transform:"scale(1)"}]);return this.animationCtrl.create().addElement(v).easing("ease-out").duration(250).addAnimation([k,x])},this.leaveAnimation=v=>this.enterAnimation(v).direction("reverse"),this.ShowExtMenus=!1,this.useVoiceRecording=!1,this.extended_buttons=[{icon:"document-attach-outline",name:this.lang.text.ChatRoom.attachments,act:(v=(0,m.A)(function*(){g.new_attach({detail:{value:"load"}})}),function(){return v.apply(this,arguments)}),context:()=>(this.new_attach({detail:{value:"link"}}),!1)},{icon_img:"voidDraw.png",name:this.lang.text.ChatRoom.voidDraw,act:()=>{this.new_attach({detail:{value:"image"}})},context:()=>(function(){var b=(0,m.A)(function*(){const k=yield g.global.GetValueFromClipboard("voiddraw");if("image/png"===k.type){const x=k.value,y=`tmp_files/minimal_chat/${x.name}`;yield g.indexed.saveBlobToUserPath(x,y);const j=URL.createObjectURL(x);new F(R=>{R.setup=()=>{R.noCanvas(),R.loadImage(j,P=>{g.global.PageDismissAct["arcade-image"]=function(){var Le=(0,m.A)(function*(G){if(G.data){let Be=yield g.global.voidDraw_fileAct_callback(G,"tmp_files/square/",{display_name:g.nakama.users.self.display_name});g.TrySendingAttach(Be,"arcade_chat")}delete g.global.PageDismissAct["arcade-image"]});return function(G){return Le.apply(this,arguments)}}(),g.global.ActLikeModal("void-draw",{path:y,width:P.width,height:P.height,type:x.type,dismiss:"arcade-image"}),URL.revokeObjectURL(j),R.remove()},P=>{console.log("\ube60\ub978 \uadf8\ub9bc\ud310 \uc5f4\uae30 \uc2e4\ud328: ",P),URL.revokeObjectURL(j),R.remove()})}})}else g.extended_buttons[1].act()});return function(){return b.apply(this,arguments)}}()(),!1)},{icon:"reader-outline",name:this.lang.text.ChatRoom.newText,act:()=>{this.new_attach({detail:{value:"text"}})}},{icon:"camera-outline",name:this.lang.text.ChatRoom.Camera,act:()=>{this.new_attach({detail:{value:"camera"}})}},{icon:"mic-circle-outline",name:this.lang.text.ChatRoom.Voice,act:function(){var v=(0,m.A)(function*(){if(g.useVoiceRecording=!g.useVoiceRecording,g.useVoiceRecording){if(g.global.useVoiceRecording&&"ArcadeRecording"!=g.global.useVoiceRecording)return void g.p5toast.show({text:g.lang.text.GlobalAct[g.global.useVoiceRecording]});(yield w.R.hasAudioRecordingPermission()).value?(g.global.useVoiceRecording="ArcadeRecording",g.extended_buttons[4].icon="stop-circle-outline",g.extended_buttons[4].name=g.lang.text.ChatRoom.VoiceStop,g.p5loading.toast(g.lang.text.ChatRoom.StartVRecord),yield w.R.startRecording(),g.CreateFloatingVoiceTimeHistoryAddButton()):(g.useVoiceRecording=!1,g.extended_buttons[4].icon="mic-circle-outline",yield w.R.requestAudioRecordingPermission())}else yield g.StopAndSaveVoiceRecording()});return function(){return v.apply(this,arguments)}}()},{icon:"trash-outline",name:this.lang.text.MinimalChat.TrashChat,act:()=>{this.global.arcadeChat.logs.length=0,this.global.arcadeChat.logs.push({color:$.ud?"bbb":"444",text:this.lang.text.MinimalChat.TrashChatLog,isSystem:!0}),this.ShowExtMenus=!1}}]}ngOnInit(){this.loadAvatarImage(),this.global.ArcadeSendAttachFunc=(t,a)=>this.SendAttachAct(t,a)}loadAvatarImage(){var t=this;return(0,m.A)(function*(){try{const a=yield t.indexed.loadBlobFromUserPath("servers/self/avatar.pck_thumbnail.png","image/png");t.global.AvatarThumbnailURL=URL.createObjectURL(a),setTimeout(()=>{URL.revokeObjectURL(t.global.AvatarThumbnailURL)},1e3)}catch{try{(yield t.indexed.checkIfFileExist("servers/self/avatar.pck"))&&(t.global.AvatarThumbnailURL="about:blank")}catch(r){console.log("\uc544\ubc14\ud0c0 \uc5c6\uc74c: ",r)}}})()}ionViewWillEnter(){var t=this;return(0,m.A)(function*(){if(t.WillLeave=!1,!t.nakama.ArcadeListOfficial.length)try{let a=yield fetch("https://is2you2.github.io/pjcone_arcade.json");if(!a.ok)throw a;{let r=yield a.json();t.nakama.ArcadeListOfficial=r}}catch(a){console.log("\uacf5\uc2dd \uc544\ucf00\uc774\ub4dc \ub9ac\uc2a4\ud2b8 \ubd88\ub7ec\uc624\uae30 \uc2e4\ud328: ",a)}t.global.ArcadeLoaded&&(t.noti.Current="arcade")})()}ionViewDidEnter(){this.global.ArcadeObject.QRCode||(this.global.ArcadeObject.QRCode=this.ArcadeQRShare);try{const t=document.getElementById("official_filter");t.onfocus||(t.onfocus=()=>{this.global.BlockMainShortcut=!0}),t.onblur||(t.onblur=()=>{this.global.BlockMainShortcut=!0})}catch{}try{const t=document.getElementById("dedicated_filter");t.onfocus||(t.onfocus=()=>{this.global.BlockMainShortcut=!0}),t.onblur||(t.onblur=()=>{this.global.BlockMainShortcut=!0})}catch{}}WaitingCurrent(){var t=this;return(0,m.A)(function*(){for(;t.WillLeave;)yield new Promise(a=>setTimeout(a,0))})()}ionViewWillLeave(){this.global.RestoreShortCutAct("arcade-fileviewer"),this.global.ToggleFullScreen(!1),this.WillLeave=!0,this.global.ArcadeLoaded&&(this.noti.Current="")}QuickLinkAct(){this.global.PageDismissAct["voiddraw-remote"]=t=>{delete this.global.PageDismissAct["voiddraw-remote"]},this.global.ActLikeModal("portal/arcade/void-draw",{dismiss:"voiddraw-remote"})}CheckIfDismissAct(t){switch(t.target.id){case"arcade_detail":this.ArcadeDetail.dismiss();break;case"inapp_qrscanner":this.InAppQRScanner.dismiss();break;case"arcade_qrmodal":this.ArcadeQRShare.dismiss()}}SearchTextInput(t,a){let r=[];switch(t){case"official":r=this.nakama.ArcadeListOfficial;break;case"dedicated":r=this.nakama.ArcadeList}for(let c of r){let o=c.name;for(let d of c.searchKey||[])o+=d;const l=o.toLowerCase().indexOf(a.target.value.toLowerCase())<0;c.hide=l}}LoadFileFromLocal(){document.getElementById("arcade_file_load").click()}LoadFileFromLocalAct(t){var a=this;return(0,m.A)(function*(){let r,c=[];try{for(let o=0,l=t.target.files.length;o<l;o++){let d={};d.filename=t.target.files[o].name,d.file_ext=t.target.files[o].name.split(".").pop()||t.target.files[o].type||a.lang.text.ChatRoom.unknown_ext,d.size=t.target.files[o].size,d.type=t.target.files[o].type||t.target.files[o].type_override,d.blob=t.target.files[o],a.global.set_viewer_category_from_ext(d),d.path=`tmp_files/arcade/[${o}] ${t.target.files[o].name}`,yield a.indexed.saveBlobToUserPath(t.target.files[o],d.path),r||(r=d),c.push({content:d})}}catch(o){a.p5toast.show({text:`${a.lang.text.Arcade.InputError}: ${o}`}),console.log("\uc544\ucf00\uc774\ub4dc \ud30c\uc77c \uc785\ub825 \uc2e4\ud328: ",o)}a.global.PageDismissAct["arcade-fileviewer"]=o=>{a.global.RestoreShortCutAct("arcade-fileviewer"),a.indexed.GetFileListFromDB("tmp_files/arcade/").then(l=>{l.forEach(d=>a.indexed.removeFileFromUserPath(d))}),delete a.global.PageDismissAct["arcade-fileviewer"]},a.global.StoreShortCutAct("arcade-fileviewer"),a.global.ActLikeModal("portal/arcade/ionic-viewer",{info:{content:r},relevance:c,noEdit:!0,noTextEdit:!0,quick:!0,dismiss:"arcade-fileviewer"}),document.getElementById("arcade_file_load").value=null})()}LoadFileFromClipboard(){var t=this;return function(){var r=(0,m.A)(function*(){let c=yield t.global.GetValueFromClipboard();switch(c.type){case"text/plain":{t.global.PageDismissAct["arcade-clipboard"]=l=>{t.global.RestoreShortCutAct("arcade-fileviewer"),delete t.global.PageDismissAct["arcade-clipboard"]};let o={};o.filename=c.value.split("/").pop(),o.file_ext=o.filename.split(".").pop(),o.url=c.value,o.path=`tmp_files/arcade/${o.filename}`,o.type="html"==o.file_ext?"text/html":o.type,t.global.set_viewer_category_from_ext(o),t.global.StoreShortCutAct("arcade-fileviewer"),t.global.ActLikeModal("portal/arcade/ionic-viewer",{info:{content:o},relevance:[{content:o}],noEdit:!0,noTextEdit:!0,quick:!0,dismiss:"arcade-clipboard"})}break;case"image/png":t.LoadFileFromLocalAct({target:{files:[c.value]}});break;default:console.log("\uc544\ucf00\uc774\ub4dc-\ud074\ub9bd\ubcf4\ub4dc\ub85c\ubd80\ud130 \ud30c\uc77c \uc77d\uae30 \uc624\ub958: ",c.value),t.LoadFileFromLocal()}});return function(){return r.apply(this,arguments)}}()(),!1}ShowGameInfo(t){this.TargetArcadeInfo=t,this.ArcadeDetail.onDidDismiss().then(()=>{this.TargetArcadeInfo={},this.global.RestoreShortCutAct("arcade_detail")}),this.servers=this.nakama.get_all_server_info(!0,!0),this.servers.unshift({name:this.lang.text.voidDraw.LocalAddrInput,isOfficial:"local",target:"target",local:!0}),this.index=Math.max(0,Math.min(this.servers.length-1,1)),this.select_server(this.index),this.global.StoreShortCutAct("arcade_detail"),this.ArcadeDetail.present()}select_server(t){this.index=t,this.isExpanded=!1,0==t?this.global.ArcadeUserInputAddress="":(this.global.ArcadeWSAddress=this.global.CatchWebSocketAddressFromServerInfo(this.servers[t]),this.global.ArcadeSquarePort=this.servers[t].square_port||12013,this.global.ArcadeCdnPort=this.servers[t].cdn_port||9001,this.global.ArcadeFilePort=this.servers[t].apache_port||9002,this.global.ArcadeUserInputAddress=`${this.global.ArcadeWSAddress}:${this.global.ArcadeSquarePort}`)}StartGame(){var t=this;return(0,m.A)(function*(){if(t.ShowExtMenus=!1,0==t.index){const c=t.global.ArcadeUserInputAddress.split(",");t.global.ArcadeWSAddress=c[0],t.global.ArcadeSquarePort=Number(c[1])||12013,t.global.ArcadeCdnPort=Number(c[2])||9001,t.global.ArcadeFilePort=Number(c[3])||9002}const a=JSON.parse(JSON.stringify(t.TargetArcadeInfo));yield t.ArcadeDetail.dismiss(),yield t.global.CreateArcadeFrame({url:a.url}),t.global.CreateInfoSocket(a.url);const r=yield t.indexed.checkIfFileExist("servers/self/avatar.pck");console.log("\uc0ac\uc6a9\uc790 \uc544\ubc14\ud0c0 \uc5ec\ubd80: ",r),console.log("\uc2dc\uc791 \ubc84\ud2bc \ub20c\ub9bc: \uc774\ub984 \uc788\uc74c")})()}QuickLinkContextmenu(){var t=this;return function(){var r=(0,m.A)(function*(){let c=yield t.global.GetValueFromClipboard();"image/png"===c.type?t.SelectVoidDrawBackgroundImage({target:{files:[c.value]}}):document.getElementById("arcade_voiddraw_img").click()});return function(){return r.apply(this,arguments)}}()(),!1}SelectVoidDrawBackgroundImage(t){var a=this;return(0,m.A)(function*(){const r=t.target.files[0],c=`tmp_files/quick_act/${r.name}`;yield a.indexed.saveBlobToUserPath(r,c);let o=yield a.indexed.loadBlobFromUserPath(c,r.type);const l=URL.createObjectURL(o);new F(d=>{d.setup=()=>{document.getElementById("arcade_voiddraw_img").value="",d.noCanvas(),d.loadImage(l,u=>{a.global.PageDismissAct["voiddraw-remote"]=p=>{delete a.global.PageDismissAct["voiddraw-remote"]},a.global.ActLikeModal("portal/arcade/void-draw",{path:c,width:u.width,height:u.height,type:r.type,dismiss:"voiddraw-remote"}),URL.revokeObjectURL(l),d.remove()},u=>{console.log("\ube60\ub978 \ud3b8\uc9d1\uae30 \uc774\ub3d9 \uc2e4\ud328: ",u),URL.revokeObjectURL(l),d.remove()})}})})()}JoinSmallTalk(){"online"!=this.statusBar.settings.dedicated_groupchat&&"certified"!=this.statusBar.settings.dedicated_groupchat&&(this.statusBar.settings.dedicated_groupchat="pending"),this.client.RejoinGroupChat()}JoinInstantCall(){this.navCtrl.navigateForward("portal/arcade/instant-call",{animation:B.NC})}copy_address(t){this.global.WriteValueToClipboard("text/plain",t)}LoadCharacter(){var t=this;return(0,m.A)(function*(){if(t.global.AvatarThumbnailURL){const r=t.nakama.get_all_server_info(!0,!0);for(let c of r)try{var a;const l=null===(a=(yield t.nakama.servers[c.isOfficial][c.target].client.readStorageObjects(t.nakama.servers[c.isOfficial][c.target].session,{object_ids:[{collection:"user_public",key:"avatar",user_id:t.nakama.servers[c.isOfficial][c.target].session.user_id}]})).objects)||void 0===a||null===(a=a[0])||void 0===a||null===(a=a.value)||void 0===a?void 0:a.data;yield t.global.remove_file_from_storage(l.url,{cdn_port:c.cdn_port,user_id:t.nakama.servers[c.isOfficial][c.target].session.user_id}),yield t.global.remove_file_from_storage(l.thumbnail,{cdn_port:c.cdn_port,user_id:t.nakama.servers[c.isOfficial][c.target].session.user_id}),yield t.nakama.servers[c.isOfficial][c.target].client.deleteStorageObjects(t.nakama.servers[c.isOfficial][c.target].session,{object_ids:[{collection:"user_public",key:"avatar"}]})}catch(o){t.p5toast.show({text:`${t.lang.text.AdminTools.FailedClear}: ${o}`,lateable:!0})}t.indexed.removeFileFromUserPath("servers/self/avatar.pck"),t.indexed.removeFileFromUserPath("servers/self/avatar.pck_thumbnail.png"),t.global.AvatarThumbnailURL=null}else document.getElementById("avatar_file_load").click()})()}LoadUserCharacter(t){var a=this;const r=t.target.files[0];this.global.PageDismissAct["arcade-character-set"]=function(){var o=(0,m.A)(function*(l){yield a.WaitingCurrent(),a.global.ArcadeWithFullScreen=!1,a.loadAvatarImage(),a.global.RestoreShortCutAct("arcade-character-set"),delete a.global.PageDismissAct["arcade-character-set"]});return function(l){return o.apply(this,arguments)}}();let c={creator_name:"",character_name:"",file:r};this.global.StoreShortCutAct("arcade-character-set"),this.global.ActLikeModal("portal/arcade/register-character",{info:c,dismiss:"arcade-character-set"}),document.getElementById("avatar_file_load").value=null,setTimeout(()=>{this.global.CreateGodotIFrameWithDuplicateAct({blob:c.file},"avatar_sample",{path:"tmp_files/duplicate/arcade_avatar.pck",model:!0,success:(l,d)=>{c.creator_name=l,c.character_name=d}},void 0,()=>{this.navCtrl.pop()})},100)}LoadCharacterFromLink(){var t=this;return function(){var r=(0,m.A)(function*(){const c="AvatarLink",o=yield t.global.GetValueFromClipboard(c);if("text/plain"===o.type)try{const l=o.value.split(".").pop();if("pck"!=l)throw`${t.lang.text.RegAvatar.wrong_ext}: ${l}`;const d=yield t.global.downloadWithProgressAsBlob(o.value);t.LoadUserCharacter({target:{files:[d]}})}catch(l){console.log("\uc8fc\uc18c\ub85c\ubd80\ud130 \ubd88\ub7ec\uc624\uae30 \uc2e4\ud328: ",l),t.p5loading.update({id:c,message:l,progress:0,forceEnd:350})}});return function(){return r.apply(this,arguments)}}()(),!1}OpenScanner(){var t=this;return(0,m.A)(function*(){const a=`arcade_OpenScanner_${Date.now()}`;yield t.p5loading.update({id:a,message:t.lang.text.Arcade.OpeningCamera,forceEnd:null}),t.QRScanResult=null,t.global.StoreShortCutAct("qrcode-scanner");let c=yield(yield fetch("assets/p5js/zxing_scanner.js")).blob(),o=URL.createObjectURL(c),d=yield(yield fetch("assets/p5js/libraries/p5.min.js")).blob(),u=URL.createObjectURL(d),f=yield(yield fetch("assets/p5js/libraries/zxing@0.21.3.min.js")).blob(),A=URL.createObjectURL(f),g=yield(yield fetch("assets/p5js/zxing.html")).text();g=g.replace('<script language="javascript" type="text/javascript" src="libraries/p5.min.js"><\/script>',`<script language="javascript" type="text/javascript" src="${u}"><\/script>`).replace('<script language="javascript" type="text/javascript" src="libraries/zxing@0.21.3.min.js"><\/script>',`<script language="javascript" type="text/javascript" src="${A}"><\/script>`).replace('<script language="javascript" type="text/javascript" src="zxing_scanner.js"><\/script>',`<script language="javascript" type="text/javascript" src="${o}"><\/script>`);let v=new Blob([g],{type:"text/html"}),b=URL.createObjectURL(v);t.InAppQRScanner.onDidDismiss().then(()=>{URL.revokeObjectURL(b),URL.revokeObjectURL(o),URL.revokeObjectURL(u),URL.revokeObjectURL(A),t.ChangeDeviceFunc=null,t.global.RestoreShortCutAct("qrcode-scanner")}),yield t.InAppQRScanner.present(),t.p5loading.remove(a);let k=document.getElementById("qr_scan_frame");k.src=b;let x=k.contentWindow||k.contentDocument;setTimeout(()=>{t.ChangeDeviceFunc=x.ChangeDevice,x.load_failed=y=>{t.p5toast.show({text:`${t.lang.text.Subscribes.QRScanInitFailed}: ${y}`}),t.InAppQRScanner.dismiss()},x.scan_result=function(){var y=(0,m.A)(function*(j){try{t.QRScanResult=j.text,t.QRScanResult&&(yield t.nakama.open_url_link(t.QRScanResult,!1))&&t.InAppQRScanner.dismiss()}catch(R){console.log("QR\uc2a4\uce94 \uc2e4\ud328: ",R)}});return function(j){return y.apply(this,arguments)}}()},1e3)})()}ChangeScanDevice(){this.ChangeDeviceFunc&&this.ChangeDeviceFunc()}OpenQuickLink(){var t=this;const a=`arcade_OpenQuickLink_${Date.now()}`;return function(){var c=(0,m.A)(function*(){const o=yield t.global.GetValueFromClipboard(a);switch(o.type){case"text/plain":const l=o.value,d=t.global.GetConnectedAddress(),u=yield t.global.GetHeaderAddress();if(0==l.indexOf("https://is2you2.github.io/pjcone_pwa/?")||0==l.indexOf(`${d}?`)||0==l.indexOf(`${u}?`)){const p=t.global.CatchGETs(l)||{};try{const f=yield t.nakama.AddressToQRCodeAct(p,!0);yield t.nakama.act_from_QRInfo(f,"portal/arcade/")}catch(f){console.log("open_url_link: ",f),t.p5toast.show({text:`${t.lang.text.AddGroup.DiffFormat}: ${f}`})}}else t.p5loading.update({id:a,message:`${t.lang.text.AddGroup.DiffFormat}: ${l}`,progress:0});break;case"image/png":t.LoadFileFromLocalAct({target:{files:[o.value]}});break;case"error":t.p5toast.show({text:`${t.lang.text.GlobalAct.FailedToReadClipboard}: ${o.value}`})}});return function(){return c.apply(this,arguments)}}()(),!1}ToggleExtMenu(t){this.ShowExtMenus=null!=t?t:!this.ShowExtMenus,setTimeout(()=>{this.global.auto_scroll_down()},0)}focus_on_input(t){"DesktopPWA"==D.aH&&this.arcadeInput.setFocus(),this.global.auto_scroll_down(t)}StopAndSaveVoiceRecording(){var t=this;return(0,m.A)(function*(){t.floatButton.RemoveFloatButton("sqaure-record");const a="arcade_chat";t.p5loading.update({id:a,message:t.lang.text.AddPost.SavingRecord});try{let r=yield t.global.StopAndSaveVoiceRecording();yield t.SendAttachAct({target:{files:[r]}},a)}catch{}t.p5loading.remove(a),t.extended_buttons[4].icon="mic-circle-outline",t.extended_buttons[4].name=t.lang.text.ChatRoom.Voice})()}open_file_viewer(t){var a=this;const r="arcade_chat";let c=[];for(let o=0,l=this.global.arcadeChat.logs.length;o<l;o++)try{this.global.arcadeChat.logs[o].file.info.filename&&c.push({content:JSON.parse(JSON.stringify(this.global.arcadeChat.logs[o].file.info))})}catch{}this.global.PageDismissAct["minimal-ionic-viewer"]=function(){var o=(0,m.A)(function*(l){if(l.data)switch(l.data.type){case"image":let d=[];if(l.data.msg.content.content_related_creator&&(d=[...l.data.msg.content.content_related_creator]),l.data.msg.content.content_creator){let u=!1;for(let p=0,f=d.length;p<f;p++)if(d[p].user_id==l.data.msg.content.content_creator.user_id){u=!0;break}u||d.push(l.data.msg.content.content_creator)}return a.global.PageDismissAct["minimal-ionic-viewer-edit"]=u=>{if(u.data){a.p5loading.remove(u.data.loadingCtrl);let p=u.data.img;a.indexed.saveBase64ToUserPath(p,`tmp_files/sqaure/${u.data.name}`);let A=a.global.Base64ToBlob(p,"image/png");A.name=u.data.name,a.SendAttachAct({target:{files:[A]}},r)}delete a.global.PageDismissAct["minimal-ionic-viewer-edit"]},yield a.WaitingCurrent(),void a.global.ActLikeModal("void-draw",{path:l.data.path||t.path,width:l.data.width,height:l.data.height,type:l.data.filetype,isDarkMode:l.data.isDarkMode,scrollHeight:l.data.scrollHeight,dismiss:"minimal-ionic-viewer-edit"});case"text":l.data.blob.name=a.global.TextEditorNewFileName(),l.data.path=`tmp_files/texteditor/${l.data.blob.name}`,a.SendAttachAct({target:{files:[l.data.blob]}},r)}delete a.global.PageDismissAct["minimal-ionic-viewer"]});return function(l){return o.apply(this,arguments)}}(),this.global.ActLikeModal("ionic-viewer",{info:{content:t},isOfficial:"local",path:t.path,relevance:c,dismiss:"minimal-ionic-viewer"})}CreateFloatingVoiceTimeHistoryAddButton(){this.floatButton.RemoveFloatButton("sqaure-record"),this.floatButton.AddFloatButton("sqaure-record","mic-outline").mouseClicked(()=>{this.p5toast.show({text:`${this.lang.text.GlobalAct.ArcadeRecording}`})})}SelectAttach(){document.getElementById("arcade_file_input").click()}new_attach(t){var a=this;return(0,m.A)(function*(){const r="arcade_chat";switch(t.detail.value){case"camera":try{let l=yield a.global.from_camera("tmp_files/square/",{display_name:a.nakama.users.self.display_name},r);l&&a.TrySendingAttach(l,r)}catch{}break;case"text":let c=a.global.TextEditorNewFileName();a.global.PageDismissAct["minimal-textedit"]=l=>{if(l.data){let d=a.global.TextEditorAfterAct(l.data,{display_name:a.nakama.users.self.display_name});a.TrySendingAttach(d,r)}delete a.global.PageDismissAct["minimal-textedit"]},a.global.ActLikeModal("ionic-viewer",{info:{content:{is_new:"text",type:"text/plain",viewer:"text",filename:c}},noEdit:!0,dismiss:"minimal-textedit"});break;case"image":a.global.PageDismissAct["arcade-image"]=function(){var l=(0,m.A)(function*(d){if(d.data){let u=yield a.global.voidDraw_fileAct_callback(d,"tmp_files/square/",{display_name:a.nakama.users.self.display_name});a.TrySendingAttach(u,r)}delete a.global.PageDismissAct["arcade-image"]});return function(d){return l.apply(this,arguments)}}(),a.global.ActLikeModal("void-draw",{dismiss:"arcade-image"});break;case"load":a.SelectAttach();break;case"link":let o;try{try{let p=yield a.global.GetValueFromClipboard(r);switch(p.type){case"text/plain":o=p.value;break;case"image/png":return void a.SendAttachAct({target:{files:[p.value]}},r);case"error":throw p.value}}catch(p){throw p}try{let p=a.global.Base64ToBlob(o),f=o.split(";")[0].split(":")[1],A=new File([p],`${a.lang.text.ChatRoom.FileLink}.${f.split("/").pop()}`,{type:f});throw a.SendAttachAct({target:{files:[A]}},r),"done"}catch(p){if("done"===p)throw p}try{if(0!=o.indexOf("http:")&&0!=o.indexOf("https:"))throw"\uc62c\ubc14\ub978 \uc6f9 \uc8fc\uc18c\uac00 \uc544\ub2d8"}catch(p){throw p}let l={};l.url=o,l.content_related_creator=[],l.content_related_creator.push({user_id:a.global.ArcadeWSPeerId,timestamp:(new Date).getTime(),display_name:a.nakama.users.self.display_name,various:"link"}),l.content_creator={user_id:a.global.ArcadeWSPeerId,timestamp:(new Date).getTime(),display_name:a.nakama.users.self.display_name,various:"link"};let d=l.url.split(".");l.file_ext=d.pop().split("?").shift(),l.filename=decodeURIComponent(`${d.pop().split("/").pop()||a.lang.text.ChatRoom.ExternalLinkFile}.${l.file_ext}`),a.global.set_viewer_category_from_ext(l),l.type="",l.typeheader=l.viewer,a.global.ArcadeWS.send(JSON.stringify({type:"file",info:l,name:a.nakama.users.self.display_name}))}catch(l){throw"done"==l?l:`\uc778\uc2dd \ubd88\uac00\ub2a5\ud55c URL \uc815\ubcf4: ${l}`}}})()}SendAttachAct(t,a){var r=this;return(0,m.A)(function*(){let c=t.target.files[0],o={};o.blob=c,o.filename=c.name,o.size=c.size,o.file_ext=c.name.split(".").pop(),o.type=c.type,r.global.set_viewer_category(o),o.content_related_creator=[{user_id:r.global.ArcadeWSPeerId,timestamp:(new Date).getTime(),display_name:r.nakama.users.self.display_name,various:"loaded"}],o.content_creator={user_id:r.global.ArcadeWSPeerId,timestamp:(new Date).getTime(),display_name:r.nakama.users.self.display_name,various:"loaded"},yield r.TrySendingAttach(o,a)})()}TrySendingAttach(t,a){var r=this;return(0,m.A)(function*(){let c={type:"file",info:t,name:r.nakama.users.self.display_name};try{const o=r.global.ArcadeWSAddress.split("://"),l=`${"wss"==o[0]?"https":"http"}://${o[1]},${r.global.ArcadeCdnPort||9001},${r.global.ArcadeFilePort||9002}`,d=(new Date).getTime(),u=`tmp_${r.global.ArcadeJoinedChannel}_${r.global.ArcadeWSPeerId}`;t.override_name=`${u.replace(/\//g,"_")}_${d}_${t.filename}`,t.override_path="",t.override_filename=t.override_name,delete t.thumbnail;const p=yield r.global.try_upload_to_user_custom_fs(t,u,a,r.lang.text.Arcade.Title,l);if(!p)throw"\uc11c\ubc84\uc5d0 \uc5c5\ub85c\ub4dc \uc2e4\ud328";t.url=p,delete t.blob,r.global.ArcadeWS.send(JSON.stringify(c))}catch(o){console.log("\ud30c\uc77c \uc804\uc1a1 \uc2e4\ud328: ",o),r.p5toast.show({text:`${r.lang.text.Nakama.FailedUpload}: ${o}`})}r.p5loading.remove(a),r.global.auto_scroll_down()})()}send(t){var a;null===(a=this.global.ArcadeChatLog)||void 0===a||a.scrollTo({top:this.global.ArcadeChatLog.scrollHeight,behavior:"smooth"});let r={type:"text",msg:t||this.global.arcadeChat.text};r.msg.trim()&&(this.ShowExtMenus=!1,r.name=this.nakama.users.self.display_name,this.global.ArcadeWS.send(JSON.stringify(r)),this.global.arcadeChat.text="",this.focus_on_input())}}return(n=s).\u0275fac=function(t){return new(t||n)(e.rXU(E.y),e.rXU(V.j),e.rXU(N.X),e.rXU(O.q9),e.rXU(M.z),e.rXU($.z3),e.rXU(U.n),e.rXU(h.Hx),e.rXU(X.G),e.rXU(Q.f),e.rXU(Y.u),e.rXU(J.r))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-arcade"]],viewQuery:function(t,a){if(1&t&&(e.GBs(W,5),e.GBs(z,5),e.GBs(H,5),e.GBs(K,5)),2&t){let r;e.mGM(r=e.lsd())&&(a.ArcadeDetail=r.first),e.mGM(r=e.lsd())&&(a.ArcadeQRShare=r.first),e.mGM(r=e.lsd())&&(a.InAppQRScanner=r.first),e.mGM(r=e.lsd())&&(a.arcadeInput=r.first)}},decls:13,vars:6,consts:[["ArcadeDetail",""],["ArcadeQRShare",""],["InAppQRScanner",""],["arcadeInput",""],["ArcadePlayServer",""],["class","ion-no-border",4,"ngIf"],[3,"fullscreen"],[4,"ngIf"],["style","position: relative;",4,"ngIf"],[1,"transparent-modal",3,"enterAnimation","leaveAnimation"],[1,"transparent-modal"],[1,"ion-no-border"],["src","assets/icon/voidDraw.png",1,"add_group","top_icon_override_2",2,"width","32px","height","32px",3,"click","contextmenu"],["hidden","","type","file","id","arcade_voiddraw_img","accept","image/*",3,"change"],[1,"add_group","top_icon_override_1",3,"click"],["button","","name","call-outline",2,"width","24px","height","24px"],[1,"add_group",3,"click"],["button","","name","chatbubbles-outline",2,"width","24px","height","24px"],[1,"header_online_circle",3,"click"],[1,"fixed_btn_size"],[1,"list_ele","list_add_btn",3,"click","contextmenu"],[3,"style",4,"ngIf"],[1,"disconnect_info"],["style","width: 36px; height: 36px;","color","medium","name","person-circle-outline",4,"ngIf"],["color","medium"],["hidden","","type","file","id","avatar_file_load","accept",".pck",3,"change"],["color","medium","name","qr-code-outline",2,"width","36px","height","36px"],["hidden","","type","file","id","arcade_file_load","multiple","","accept","*",3,"change"],["color","medium","name","document-outline",2,"width","36px","height","36px"],["color","medium","name","person-circle-outline",2,"width","36px","height","36px"],[2,"position","absolute","right","16px"],["name","search-outline",2,"margin-right","8px","cursor","pointer"],["id","official_filter","type","text",1,"searchInput",3,"input","placeholder"],["class","list_ele list_add_btn",3,"hidden","click",4,"ngFor","ngForOf"],[1,"list_ele","list_add_btn",3,"click","hidden"],["class","cover_image",3,"style",4,"ngIf"],[1,"cover_image"],["id","dedicated_filter","type","text",1,"searchInput",3,"input","placeholder"],[1,"list_form"],["class","list_ele",3,"hidden","click",4,"ngFor","ngForOf"],[1,"list_ele",3,"click","hidden"],[2,"position","relative"],["id","arcade_pck_loaded",1,"full_screen",2,"position","fixed"],["style","display: flex; justify-content: center; align-items: center; width: 100%; position: absolute; bottom: 0; color: var(--arcade-fix-color);",4,"ngIf"],[2,"display","flex","justify-content","center","align-items","center","width","100%","position","absolute","bottom","0","color","var(--arcade-fix-color)"],[2,"width","100%","max-width","650px"],["id","arcadeChatLog",2,"width","100%","height","fit-content","max-height","170px","overflow-y","scroll","padding","8px","background","linear-gradient(to top, var(--arcade-background-transparent), transparent)"],[2,"user-select","text"],[4,"ngFor","ngForOf"],["id","input_table",2,"width","100%","background-color","var(--arcade-background-transparent)"],["expand","block","fill","clear",3,"click"],["name","add-outline"],["hidden","","type","file","id","arcade_file_input","accept","*",3,"change"],[2,"width","100%"],["id","arcadeInput","type","text",3,"ionFocus","keyup.enter","ngModelChange","placeholder","ngModel"],["name","send"],["style","overflow-x: hidden; overflow-y: auto; scroll-behavior: smooth; text-align: center; background-color: var(--arcade-background-transparent); padding-bottom: 16px;",4,"ngIf"],["class","default_text",4,"ngIf"],[1,"default_text"],["target","_system","onclick","return false;",3,"href","click",4,"ngIf"],["target","_system","onclick","return false;",3,"click","href"],[1,"file_attach_box",3,"click"],[2,"overflow-x","hidden","overflow-y","auto","scroll-behavior","smooth","text-align","center","background-color","var(--arcade-background-transparent)","padding-bottom","16px"],["style","display: inline-block;",4,"ngFor","ngForOf"],[2,"display","inline-block"],[1,"ext_button",3,"click","contextmenu","hidden"],["slot","icon-only","style","width: 36px; height: 36px;",3,"name",4,"ngIf"],["class","ext_icon_img",3,"src","alt",4,"ngIf"],["slot","icon-only",2,"width","36px","height","36px",3,"name"],[1,"ext_icon_img",3,"src","alt"],["id","arcade_detail",1,"OutterModal",3,"click"],[2,"justify-content","center","align-items","center","overflow-y","auto"],[1,"arcade_modal"],[2,"display","flex","flex-direction","column","width","100%","height","100%","background-color","var(--arcade-detail-modal)","padding","16px","border-radius","16px"],[2,"text-align","start","margin","8px 0px"],[2,"text-align","start","flex-grow","1","overflow-y","scroll"],["value","colors","expand","inset",3,"value","click",4,"ngIf"],["style","margin-bottom: 8px;",4,"ngIf"],[1,"ion-align-self-center",3,"click","disabled"],["value","colors","expand","inset",3,"click","value"],["value","colors"],["slot","header"],[2,"display","contents"],[1,"ion-text-right"],[1,"ion-accordion-toggle-icon","hide_accordion_icon"],["slot","content"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"],[2,"margin-bottom","8px"],["type","text","placeholder","(wss://)0.0.0.0,12013,9001",1,"ion-text-end",3,"ngModelChange","label","ngModel"],["id","arcade_qrmodal",1,"OutterModal",3,"click"],[2,"display","flex","justify-content","center","align-items","center"],[2,"width","400px","min-height","455px","background-color","var(--chatroom-background)","text-align","center","padding","16px"],["style","width: 100%; height: auto; cursor: copy; margin-bottom: 8px;","alt","ArcadeQuickLink",3,"src","click",4,"ngIf"],[1,"ion-text-center"],["alt","ArcadeQuickLink",2,"width","100%","height","auto","cursor","copy","margin-bottom","8px",3,"click","src"],["id","inapp_qrscanner",1,"OutterModal",3,"click"],[2,"width","400px","min-height","455px","background-color","var(--chatroom-background)","text-align","center","padding","16px","position","relative"],[2,"position","absolute","width","64px","height","64px","cursor","pointer","margin","16px","background-color","#8888","border-radius","24px","top","0","right","0","text-align","center","align-content","center",3,"click"],["name","camera-reverse-outline",2,"width","36px","height","36px"],["id","qr_scan_frame","frameborder","0",2,"width","100%","height","368px","margin-bottom","8px"],["class","ion-text-center","color","medium",4,"ngIf"],["class","ion-text-center",4,"ngIf"],["color","medium",1,"ion-text-center"]],template:function(t,a){1&t&&(e.DNE(0,Z,11,3,"ion-header",5),e.j41(1,"ion-content",6),e.DNE(2,le,28,7,"div",7)(3,ke,3,1,"div",8),e.j41(4,"ion-modal",9,0),e.DNE(6,Pe,15,9,"ng-template"),e.k0s(),e.j41(7,"ion-modal",10,1),e.DNE(9,Ie,7,2,"ng-template"),e.k0s(),e.j41(10,"ion-modal",10,2),e.DNE(12,Te,9,2,"ng-template"),e.k0s()()),2&t&&(e.Y8G("ngIf",!a.global.ArcadeLoaded),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(),e.Y8G("ngIf",!a.global.ArcadeLoaded),e.R7$(),e.Y8G("ngIf",a.global.ArcadeLoaded),e.R7$(),e.Y8G("enterAnimation",a.enterAnimation)("leaveAnimation",a.leaveAnimation))},dependencies:[C.Sq,C.bT,I.BC,I.vS,h.xk,h.YH,h.Jm,h.W9,h.eU,h.iq,h.$w,h.uz,h.Dg,h.he,h.BC,h.ai,h.Sb,h.Gw],styles:[".list_form[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(135px,1fr));padding:16px;gap:16px}.list_add_btn[_ngcontent-%COMP%]{flex:0 1}p[_ngcontent-%COMP%]{margin:8px 0 0}.default_text[_ngcontent-%COMP%]{color:var(--arcade-fix-color)}.file_attach_box[_ngcontent-%COMP%]{margin-left:8px;padding:2px 8px;border-radius:6px;background-color:#8888;cursor:pointer;color:var(--arcade-fix-color)}.fixed_btn_size[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:16px;overflow-x:auto;margin:16px 16px 0;padding-bottom:16px}.searchInput[_ngcontent-%COMP%]{border:none;border-bottom:1px solid;outline:none}.cover_image[_ngcontent-%COMP%]{width:100%;height:100%;background-size:cover;background-position:center;opacity:.35}.arcade_modal[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:400px;height:455px;background-color:var(--chatroom-background);text-align:center;border-radius:16px}.list_ele[_ngcontent-%COMP%]{overflow:hidden;cursor:pointer;border:1px solid var(--list-shortcut-hint-background);border-radius:8px;min-width:135px;min-height:90px;text-align:center;align-content:center;position:relative}.add_group[_ngcontent-%COMP%]{position:absolute;right:68px;top:16px;cursor:pointer}.top_icon_override_1[_ngcontent-%COMP%]{right:116px}.top_icon_override_2[_ngcontent-%COMP%]{right:164px;top:13px}ion-input[_ngcontent-%COMP%]{--highlight-color-valid: var(--ion-color-primary)}"]}),s})()},{path:"instant-call",loadChildren:()=>_.e(6524).then(_.bind(_,6524)).then(n=>n.InstantCallPageModule)},{path:"void-draw",loadChildren:()=>_.e(2655).then(_.bind(_,2655)).then(n=>n.VoidDrawPageModule)},{path:"ionic-viewer",loadChildren:()=>Promise.all([_.e(4803),_.e(222)]).then(_.bind(_,4803)).then(n=>n.IonicViewerPageModule)},{path:"post-viewer",loadChildren:()=>Promise.all([_.e(222),_.e(526)]).then(_.bind(_,526)).then(n=>n.PostViewerPageModule)},{path:"register-character",loadChildren:()=>_.e(4168).then(_.bind(_,4168)).then(n=>n.RegisterCharacterPageModule)}];let Fe=(()=>{var n;class s{}return(n=s).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[S.iI.forChild(Se),S.iI]}),s})(),$e=(()=>{var n;class s{}return(n=s).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[C.MD,I.YN,h.bv,Fe]}),s})()}}]);