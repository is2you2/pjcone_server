"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9128],{9128:(z,x,c)=>{c.r(x),c.d(x,{SubscribesPageModule:()=>L});var v=c(177),y=c(4341),_=c(5374),S=c(9858),$=c(467),P=c(92),e=c(3953),C=c(4237),F=c(8065),R=c(4234),G=c(482),j=c(3656),I=c(755);const M=()=>[0,1,2];function D(n,o){1&n&&(e.j41(0,"div",13),e.EFF(1,"A"),e.k0s())}function O(n,o){if(1&n){const a=e.RV6();e.j41(0,"ion-item",9),e.bIt("click",function(){e.eBV(a);const t=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.check_notifications(t))}),e.j41(1,"ion-label"),e.EFF(2),e.k0s()()}if(2&n){const a=e.XpG().$implicit,i=e.XpG(2);e.R7$(2),e.JRh(i.nakama.notifications_rearrange[a].request)}}function T(n,o){if(1&n&&(e.j41(0,"div"),e.DNE(1,O,3,1,"ion-item",19),e.k0s()),2&n){const a=o.$implicit,i=e.XpG(2);e.R7$(),e.Y8G("ngIf",i.nakama.notifications_rearrange.length>a)}}function X(n,o){if(1&n&&(e.j41(0,"ion-accordion-group",14,0)(2,"ion-accordion",15)(3,"ion-item",16)(4,"ion-label"),e.EFF(5),e.k0s()(),e.j41(6,"div",17),e.DNE(7,T,2,1,"div",18),e.k0s()()()),2&n){const a=e.XpG();e.Y8G("value",!1),e.R7$(5),e.JRh(a.lang.text.Subscribes.has_noties),e.R7$(2),e.Y8G("ngForOf",e.lJ4(3,M))}}function E(n,o){1&n&&(e.j41(0,"div",20),e.EFF(1,"`"),e.k0s())}function A(n,o){if(1&n&&(e.j41(0,"div",20),e.EFF(1),e.k0s()),2&n){const a=e.XpG().index;e.R7$(),e.JRh((a+1)%10)}}function w(n,o){if(1&n&&e.nrm(0,"div",31),2&n){const a=e.XpG().$implicit,i=e.XpG(2);e.Aen("background-color: "+i.statusBar.colors[a.status||"offline"])}}function B(n,o){if(1&n&&e.nrm(0,"div",32),2&n){const a=e.XpG().$implicit;e.Aen("background-image: linear-gradient(to right, #0000, #"+(a.color||"abcdef")+"44)")}}function Y(n,o){if(1&n&&(e.j41(0,"span",33),e.EFF(1),e.k0s()),2&n){const a=e.XpG(3);e.R7$(),e.JRh("("+a.lang.text.AddGroup.Volatile+")")}}function N(n,o){if(1&n&&(e.j41(0,"span",33),e.EFF(1),e.k0s()),2&n){const a=e.XpG().$implicit,i=e.XpG(2);e.R7$(),e.SpI(" ","("+(a.local?i.lang.text.AddGroup.UseLocalStorage:a.server.name||a.server.target)+")"," ")}}function U(n,o){if(1&n){const a=e.RV6();e.j41(0,"div",22),e.DNE(1,A,2,1,"div",8),e.j41(2,"ion-item",23),e.bIt("click",function(){const t=e.eBV(a).$implicit,s=e.XpG(2);return e.Njj(s.go_to_chatroom(t))})("contextmenu",function(){const t=e.eBV(a).$implicit,s=e.XpG(2);return e.Njj(s.ChannelContextMenu(t))}),e.j41(3,"div",24),e.nrm(4,"img",25),e.DNE(5,w,1,2,"div",26),e.k0s(),e.DNE(6,B,1,2,"div",27),e.j41(7,"ion-label")(8,"div",28)(9,"table")(10,"tr")(11,"td")(12,"span"),e.EFF(13),e.k0s(),e.DNE(14,Y,2,1,"span",29)(15,N,2,1,"span",29),e.k0s()()()(),e.j41(16,"div",30),e.EFF(17),e.k0s()()()()}if(2&n){const a=o.$implicit,i=o.index,t=e.XpG(2);e.R7$(),e.Y8G("ngIf",t.global.ShowHint&&i<10),e.R7$(3),e.Aen("online"==a.status||a.redirect&&3==a.redirect.type&&"pending"==a.status?"filter: grayscale(0) contrast(1)":"filter: grayscale(.9) contrast(1.4)"),e.Y8G("src",a.info&&a.info.img||(a.local||a.info&&1==a.info.max_count?"assets/data/local.svg":"assets/data/channel.svg"),e.B4B),e.R7$(),e.Y8G("ngIf",!a.local),e.R7$(),e.Y8G("ngIf",a.is_new),e.R7$(7),e.SpI(" ",a.info?a.info.name||t.nakama.usernameOverride[a.info.isOfficial][a.info.target][a.info.id]||a.info.display_name||t.lang.text.ChatRoom.noname_chatroom:a.title||t.lang.text.ChatRoom.noname_chatroom," "),e.R7$(),e.Y8G("ngIf",a.volatile),e.R7$(),e.Y8G("ngIf",(t.nakama.showServer||a.local)&&!a.volatile),e.R7$(2),e.SpI(" ",a.last_comment||a.noti||t.lang.text.Subscribes.noMessageHistory," ")}}function J(n,o){if(1&n&&(e.j41(0,"div")(1,"ion-item-divider")(2,"ion-label"),e.EFF(3),e.k0s()(),e.DNE(4,U,18,10,"div",21),e.k0s()),2&n){const a=e.XpG();e.R7$(3),e.JRh(a.lang.text.Subscribes.JoinedChannels),e.R7$(),e.Y8G("ngForOf",a.nakama.channels)}}function V(n,o){if(1&n){const a=e.RV6();e.j41(0,"div")(1,"div",34),e.bIt("click",function(){e.eBV(a);const t=e.XpG();return e.Njj(t.nakama.add_new_group())}),e.nrm(2,"ion-icon",35),e.j41(3,"div")(4,"ion-label",36),e.EFF(5),e.k0s()()()()}if(2&n){const a=e.XpG();e.R7$(5),e.JRh(a.lang.text.Subscribes.NoChat)}}const H=[{path:"",component:(()=>{var n;class o{constructor(i,t,s,l,p,u,g,f){this.nakama=i,this.statusBar=t,this.lang=s,this.global=l,this.navCtrl=p,this.indexed=u,this.alertCtrl=g,this.loadingCtrl=f,this.cant_dedicated=!1,this.lock_chatroom=!1}ngOnInit(){this.indexed.loadTextFromUserPath("servers/self/profile.img",(i,t)=>{i&&t&&(this.nakama.users.self.img=t.replace(/"|=|\\/g,""))}),this.global.PortalBottonTabAct.Subscribes=()=>{this.SubscribesScrollDiv&&(this.SubscribesScrollDiv.scrollTop=0)}}try_add_shortcut(){this.global.p5KeyShortCut?this.AddShortcut():setTimeout(()=>{this.try_add_shortcut()},100)}AddShortcut(){this.global.p5KeyShortCut.Backquote=()=>{this.nakama.open_profile_page()},this.global.p5KeyShortCut.Digit=i=>{this.nakama.channels.length>i?this.go_to_chatroom(this.nakama.channels[i]):this.nakama.add_new_group()},this.global.p5KeyShortCut.AddAct||(this.global.p5KeyShortCut.AddAct=()=>{this.nakama.add_new_group()})}ChannelContextMenu(i){var t=this;let s=i.server.isOfficial,l=i.server.target,p=i.title;switch(p=2==i.redirect.type?p||this.lang.text.Profile.noname_user:p||this.lang.text.ChatRoom.noname_chatroom,i.redirect.type){case 3:if("online"==i.status||"pending"==i.status){this.nakama.open_group_detail({info:this.nakama.groups[s][l][i.group_id],server:{isOfficial:s,target:l}});break}case 2:this.alertCtrl.create({header:p,message:this.lang.text.ChatRoom.RemoveChannelLogs,buttons:[{text:this.lang.text.ChatRoom.Delete,handler:(u=(0,$.A)(function*(){let g=yield t.loadingCtrl.create({message:t.lang.text.TodoDetail.WIP});g.present(),yield t.nakama.remove_group_list(t.nakama.groups[s][l][i.group_id],s,l,!0),delete t.nakama.channels_orig[s][l][i.id],t.nakama.remove_channel_files(s,l,i.id);try{let r=localStorage.getItem("fallback_fs");if(!r)throw"\uc0ac\uc6a9\uc790 \uc9c0\uc815 \uc11c\ubc84 \uc5c6\uc74c";let d=r.split("://"),m=d.pop().split(":"),h=d.pop();h?h+=":":h=t.global.checkProtocolFromAddress(m[0])?"https:":"http:";let k=`${h}//${m[0]}:${m[1]||9002}/`,b=`${i.id}_${t.nakama.users.self.display_name}`;try{b=`${i.info.id}_${t.nakama.servers[s][l].session.user_id}`}catch{}t.global.remove_files_from_storage_with_key(k,b)}catch{}try{t.global.remove_files_from_storage_with_key(`${[i.info.server.useSSL?"https:":"http:"]}//${i.info.server.address}:9002/`,`${i.info.id}_${t.nakama.servers[s][l].session.user_id}`)}catch{}let f=yield t.indexed.GetFileListFromDB(`servers/${s}/${l}/channels/${i.id}`);for(let r=0,d=f.length;r<d;r++)g.message=`${t.lang.text.UserFsDir.DeleteFile}: ${d-r}`,yield t.indexed.removeFileFromUserPath(f[r]);g.dismiss(),t.nakama.rearrange_channels()}),function(){return u.apply(this,arguments)}),cssClass:"redfont"}]}).then(u=>u.present());break;case 0:this.alertCtrl.create({header:p,message:this.lang.text.ChatRoom.RemoveChannelLogs,buttons:[{text:this.lang.text.ChatRoom.Delete,handler:function(){var u=(0,$.A)(function*(){let g=yield t.loadingCtrl.create({message:t.lang.text.TodoDetail.WIP});g.present(),delete t.nakama.channels_orig[s][l][i.id];try{yield t.indexed.removeFileFromUserPath(`servers/${s}/${l}/groups/${i.id}.img`)}catch(r){console.log("\uadf8\ub8f9 \uc774\ubbf8\uc9c0 \uc0ad\uc81c \uc624\ub958: ",r)}t.nakama.save_groups_with_less_info();try{let r=localStorage.getItem("fallback_fs");if(!r)throw"\uc0ac\uc6a9\uc790 \uc9c0\uc815 \uc11c\ubc84 \uc5c6\uc74c";let d=r.split("://"),m=d.pop().split(":"),h=d.pop();h?h+=":":h=t.global.checkProtocolFromAddress(m[0])?"https:":"http:";let k=`${h}//${m[0]}:${m[1]||9002}/`,b=`${i.id}_${t.nakama.users.self.display_name}`;try{b=`${i.info.id}_${t.nakama.servers[s][l].session.user_id}`}catch{}t.global.remove_files_from_storage_with_key(k,b)}catch{}let f=yield t.indexed.GetFileListFromDB(`servers/${s}/${l}/channels/${i.id}`);for(let r=0,d=f.length;r<d;r++)g.message=`${t.lang.text.UserFsDir.DeleteFile}: ${d-r}`,yield t.indexed.removeFileFromUserPath(f[r]);g.dismiss(),t.nakama.rearrange_channels()});return function(){return u.apply(this,arguments)}}(),cssClass:"redfont"}]}).then(u=>u.present())}var u;return!1}ionViewDidEnter(){this.SubscribesScrollDiv||(this.SubscribesScrollDiv=document.getElementById("SubscribesScrollDiv")),this.nakama.subscribe_lock=!0,("DesktopPWA"==P.aH||"MobilePWA"==P.aH)&&(this.cant_dedicated=!0),this.try_add_shortcut()}go_to_page(i){this.global.RemoveAllModals(()=>{this.navCtrl.navigateForward(`portal/settings/${i}`)})}go_to_chatroom(i){this.lock_chatroom||(this.lock_chatroom=!0,this.nakama.go_to_chatroom_without_admob_act(i),("online"!=i.status||"pending"!=i.status)&&delete i.is_new,this.lock_chatroom=!1)}check_notifications(i){let t=this.nakama.notifications_rearrange[i].server;this.nakama.check_notifications(this.nakama.notifications_rearrange[i],t.isOfficial,t.target)}ionViewWillLeave(){this.nakama.subscribe_lock=!1,delete this.global.p5KeyShortCut.Backquote,delete this.global.p5KeyShortCut.Digit,delete this.global.p5KeyShortCut.AddAct}}return(n=o).\u0275fac=function(i){return new(i||n)(e.rXU(C.X),e.rXU(F.j),e.rXU(R.y),e.rXU(G.z3),e.rXU(j.q9),e.rXU(I.n),e.rXU(_.hG),e.rXU(_.Xi))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-subscribes"]],decls:23,vars:13,consts:[["accordionGroup",""],[1,"ion-no-border"],[1,"add_group",3,"click"],["class","shortcut_hint shortcut_top_add",4,"ngIf"],["button","","name","add-circle-outline",2,"width","24px","height","24px"],[1,"header_online_circle",3,"click"],["id","SubscribesScrollDiv",2,"height","100%","overflow-y","auto"],["value","colors","expand","inset",3,"value",4,"ngIf"],["class","shortcut_hint",4,"ngIf"],["button","",3,"click"],[1,"additional_form","bg_img_form"],[1,"profile_img",3,"src"],[4,"ngIf"],[1,"shortcut_hint","shortcut_top_add"],["value","colors","expand","inset",3,"value"],["value","colors"],["slot","header"],["slot","content"],[4,"ngFor","ngForOf"],["button","",3,"click",4,"ngIf"],[1,"shortcut_hint"],["style","position: relative;",4,"ngFor","ngForOf"],[2,"position","relative"],["button","",3,"click","contextmenu"],[1,"channel_image","channel_image_div"],["alt","ch_img",1,"channel_image",3,"src"],["class","status_circle",3,"style",4,"ngIf"],["class","additional_form new_bg_form",3,"style",4,"ngIf"],[1,"channel_text_form","header"],["class","server_target",4,"ngIf"],[1,"channel_text_form","content"],[1,"status_circle"],[1,"additional_form","new_bg_form"],[1,"server_target"],[1,"disconnect_info",3,"click"],["color","medium","name","chatbubble-ellipses-outline",2,"width","60px","height","60px"],["color","medium"]],template:function(i,t){1&i&&(e.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s(),e.j41(4,"div",2),e.bIt("click",function(){return t.nakama.add_new_group()}),e.DNE(5,D,2,0,"div",3),e.nrm(6,"ion-icon",4),e.k0s(),e.j41(7,"div",5),e.bIt("click",function(){return t.nakama.toggle_all_session()}),e.k0s()()(),e.j41(8,"ion-content")(9,"div",6),e.DNE(10,X,8,4,"ion-accordion-group",7),e.j41(11,"ion-item-divider")(12,"ion-label"),e.EFF(13),e.k0s()(),e.j41(14,"div"),e.DNE(15,E,2,0,"div",8),e.j41(16,"ion-item",9),e.bIt("click",function(){return t.nakama.open_profile_page()}),e.j41(17,"div",10),e.nrm(18,"img",11),e.k0s(),e.j41(19,"ion-label"),e.EFF(20),e.k0s()()(),e.DNE(21,J,5,2,"div",12)(22,V,6,1,"div",12),e.k0s()()),2&i&&(e.R7$(3),e.JRh(t.lang.text.Subscribes.Title),e.R7$(2),e.Y8G("ngIf",t.global.ShowHint),e.R7$(2),e.Aen("background-color: "+t.statusBar.colors[t.statusBar.settings.groupServer]+"; cursor: pointer;"),e.R7$(3),e.Y8G("ngIf",t.nakama.notifications_rearrange.length),e.R7$(3),e.JRh(t.lang.text.Subscribes.myProfile),e.R7$(2),e.Y8G("ngIf",t.global.ShowHint),e.R7$(3),e.Aen(t.nakama.users.self.online?"filter: grayscale(0) contrast(1);":"filter: grayscale(.9) contrast(1.4);"),e.Y8G("src",t.nakama.users.self.img,e.B4B),e.R7$(2),e.JRh(t.nakama.users.self.display_name||t.lang.text.Profile.noname_user),e.R7$(),e.Y8G("ngIf",t.nakama.channels.length),e.R7$(),e.Y8G("ngIf",!t.nakama.channels.length))},dependencies:[v.Sq,v.bT,_.xk,_.YH,_.W9,_.eU,_.iq,_.uz,_.Dg,_.he,_.BC,_.ai],styles:[".advertise_banner[_ngcontent-%COMP%]{width:100%;max-height:150px}.header[_ngcontent-%COMP%]{padding-bottom:4px}.content[_ngcontent-%COMP%]{color:#888;height:24px;line-height:24px;vertical-align:middle;overflow:hidden}.channel_image_div[_ngcontent-%COMP%]{position:absolute}.channel_image[_ngcontent-%COMP%]{width:52px;height:52px;border-radius:64px;object-fit:cover}.status_bar[_ngcontent-%COMP%]{width:5px;height:76%}.channel_text_form[_ngcontent-%COMP%]{margin-left:64px}.status_circle[_ngcontent-%COMP%]{position:relative;top:-56px;left:38px;width:12px;height:12px;border-radius:12px}.md[_ngcontent-%COMP%]   .add_group[_ngcontent-%COMP%]{position:absolute;right:68px;top:16px;cursor:pointer}.ios[_ngcontent-%COMP%]   .add_group[_ngcontent-%COMP%]{position:absolute;right:58px;top:10px;cursor:pointer}.md[_ngcontent-%COMP%]   .top_icon_override_1[_ngcontent-%COMP%]{right:116px}.ios[_ngcontent-%COMP%]   .top_icon_override_1[_ngcontent-%COMP%]{right:96px}.md[_ngcontent-%COMP%]   .top_icon_override_2[_ngcontent-%COMP%]{right:164px}.ios[_ngcontent-%COMP%]   .top_icon_override_2[_ngcontent-%COMP%]{right:134px}"]}),o})()}];let K=(()=>{var n;class o{}return(n=o).\u0275fac=function(i){return new(i||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[S.iI.forChild(H),S.iI]}),o})(),L=(()=>{var n;class o{}return(n=o).\u0275fac=function(i){return new(i||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[v.MD,y.YN,_.bv,K]}),o})()}}]);