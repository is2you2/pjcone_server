"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[36],{36:(re,B,c)=>{c.r(B),c.d(B,{GroupServerPageModule:()=>ne});var F=c(177),D=c(4341),u=c(5374),I=c(9858),G=c(467),N=c(4237),T=c(92),V=c(8326),e=c(3953),M=c(9900),X=c(8065),U=c(755),Y=c(4234),J=c(7100),z=c(3656);const H=["RegisterNewServer"],K=["ServerDisplayName"],Z=()=>[0,.4,.6,1];function W(r,m){1&r&&(e.j41(0,"div",16),e.EFF(1,"A"),e.k0s())}function Q(r,m){if(1&r){const s=e.RV6();e.j41(0,"div",9)(1,"div",10),e.DNE(2,W,2,0,"div",11),e.j41(3,"ion-item",12),e.bIt("click",function(){e.eBV(s);const t=e.XpG();return e.Njj(t.OpenNewServerForm())}),e.nrm(4,"ion-icon",13),e.j41(5,"ion-label"),e.EFF(6),e.k0s()()(),e.j41(7,"ion-item",14),e.bIt("click",function(){e.eBV(s);const t=e.XpG();return e.Njj(t.toggle_online())}),e.j41(8,"ion-label",15),e.EFF(9),e.k0s()()()}if(2&r){const s=e.XpG();e.R7$(2),e.Y8G("ngIf",s.global.ShowHint),e.R7$(4),e.JRh(s.lang.text.GroupServer.JoinedServerList),e.R7$(3),e.JRh(s.lang.text.Profile.LogOut)}}function q(r,m){1&r&&(e.j41(0,"div",16),e.EFF(1,"Ctrl + Enter"),e.k0s())}function ee(r,m){if(1&r&&(e.j41(0,"div",27),e.EFF(1),e.k0s()),2&r){const s=e.XpG(2);e.R7$(),e.SpI(" ",s.lang.text.GroupServer.RightClickDetail,"")}}function te(r,m){if(1&r){const s=e.RV6();e.j41(0,"ion-item",28),e.bIt("click",function(){const t=e.eBV(s).$implicit,a=e.XpG(2);return e.Njj(a.link_group(t.isOfficial,t.target))})("contextmenu",function(){const t=e.eBV(s).$implicit,a=e.XpG(2);return e.Njj(a.edit_server_info(t.isOfficial,t.target))}),e.nrm(1,"div",29),e.j41(2,"ion-label",30)(3,"h2"),e.EFF(4),e.k0s(),e.j41(5,"p"),e.EFF(6),e.k0s()(),e.j41(7,"ion-button",31),e.bIt("click",function(){const t=e.eBV(s).$implicit,a=e.XpG(2);return e.Njj(a.remove_server(t.isOfficial,t.target))}),e.EFF(8),e.k0s()()}if(2&r){const s=m.$implicit,i=e.XpG(2);e.R7$(),e.Aen("background-color: "+i.statusBar.colors[i.statusBar.groupServer[s.isOfficial][s.target]||"offline"]),e.R7$(3),e.JRh(s.name),e.R7$(2),e.JRh((s.useSSL?"https://":"http://")+s.address+":"+(s.nakama_port||7350)),e.R7$(2),e.SpI(" ","online"==i.statusBar.groupServer[s.isOfficial][s.target]?i.lang.text.GroupServer.RemoveAccount:i.lang.text.GroupServer.RemoveUnofficial," ")}}function ie(r,m){if(1&r){const s=e.RV6();e.j41(0,"ion-content")(1,"ion-item-divider")(2,"ion-label"),e.EFF(3),e.k0s()(),e.j41(4,"ion-item",17)(5,"ion-input",18,1),e.mxI("ngModelChange",function(t){e.eBV(s);const a=e.XpG();return e.DH7(a.dedicated_info.name,t)||(a.dedicated_info.name=t),e.Njj(t)}),e.k0s()(),e.j41(7,"ion-item",17)(8,"ion-input",19),e.mxI("ngModelChange",function(t){e.eBV(s);const a=e.XpG();return e.DH7(a.dedicated_info.address,t)||(a.dedicated_info.address=t),e.Njj(t)}),e.k0s(),e.j41(9,"ion-icon",20),e.bIt("click",function(){e.eBV(s);const t=e.XpG();return e.Njj(t.global.open_custom_site(t.dedicated_info.address,t.dedicated_info.cdn_port))}),e.k0s()(),e.j41(10,"div",10),e.DNE(11,q,2,0,"div",11),e.j41(12,"ion-item",21),e.bIt("click",function(){e.eBV(s);const t=e.XpG();return e.Njj(t.add_custom_dedicated())}),e.j41(13,"ion-label",22),e.EFF(14),e.k0s()()(),e.j41(15,"ion-item-divider",10),e.DNE(16,ee,2,1,"div",23),e.j41(17,"ion-label"),e.EFF(18),e.k0s()(),e.j41(19,"ion-item",24),e.bIt("ionChange",function(){e.eBV(s);const t=e.XpG();return e.Njj(t.toggleAutoConnect())}),e.j41(20,"ion-toggle",25),e.mxI("ngModelChange",function(t){e.eBV(s);const a=e.XpG();return e.DH7(a.nakama.AutoConnect,t)||(a.nakama.AutoConnect=t),e.Njj(t)}),e.EFF(21),e.k0s()(),e.DNE(22,te,9,5,"ion-item",26),e.k0s()}if(2&r){const s=e.XpG();e.R7$(3),e.JRh(s.lang.text.GroupServer.RegisterServer),e.R7$(),e.Y8G("disabled",s.add_custom_tog),e.R7$(),e.Y8G("label",s.lang.text.GroupServer.DisplayName),e.R50("ngModel",s.dedicated_info.name),e.Y8G("placeholder",s.lang.text.GroupServer.DisplayName_placeholder),e.R7$(2),e.Y8G("disabled",s.add_custom_tog),e.R7$(),e.Y8G("label",s.lang.text.GroupServer.Address),e.R50("ngModel",s.dedicated_info.address),e.R7$(3),e.Y8G("ngIf",s.global.ShowHint),e.R7$(),e.Y8G("disabled",s.add_custom_tog),e.R7$(2),e.JRh(s.lang.text.GroupServer.submit),e.R7$(2),e.Y8G("ngIf",s.global.ShowHint),e.R7$(2),e.JRh(s.lang.text.GroupServer.JoinedServerList),e.R7$(2),e.R50("ngModel",s.nakama.AutoConnect),e.R7$(),e.JRh(s.lang.text.GroupServer.AutoConnect),e.R7$(),e.Y8G("ngForOf",s.servers)}}const ae=[{path:"",component:(()=>{var r;class m{constructor(i,t,a,n,l,o,g,h,w,P){this.nakama=i,this.p5toast=t,this.statusBar=a,this.indexed=n,this.lang=l,this.global=o,this.navCtrl=g,this.alertCtrl=h,this.route=w,this.router=P,this.OnlineToggle=!1,this.ShowServerList=!1,this.EditingName=!1,this.dedicated_info={name:void 0,address:void 0,target:void 0,nakama_port:void 0,cdn_port:void 0,square_port:void 0,webrtc_port:void 0,apache_port:void 0,useSSL:void 0,isOfficial:void 0,key:void 0,webpush_port:void 0},this.add_custom_tog=!1,this.isOverrideButtonPressed=!1,this.announce_update_profile=!1,this.PageFocusOut=!1,this.file_sel_id="",this.can_auto_modified=!1}ngOnInit(){this.global.StoreShortCutAct("group-server"),this.servers=this.nakama.get_all_server_info(!0),this.file_sel_id=`self_profile_${(new Date).getTime()}`,this.nakama.users.self.img||this.indexed.loadTextFromUserPath("servers/self/profile.img",(i,t)=>{i&&t&&(this.nakama.users.self.img=t.replace(/"|\\|=/g,""))}),this.nakama.socket_reactive.profile=i=>{this.p5canvas&&this.p5ChangeImageSmooth(i)},this.route.queryParams.subscribe(i=>{const t=this.router.getCurrentNavigation().extras.state;if(t){let a=t.isOfficial,n=t.target;try{this.nakamagroup=this.nakama.servers[a][n]}catch{}}this.initialize()})}initialize(){var i=this;this.gsCanvasDiv=document.getElementById("GroupServerCanvasDiv"),this.OnlineToggle=this.nakama.users.self.online,this.p5canvas=new V(t=>{let n,l,o,g,h,P,d,v,y,w=1,R="0, 0, 0",E=0,O=!!this.nakamagroup,f=t.createDiv();t.setup=()=>{if(O){let _=t.color(`#${(this.nakamagroup.session.user_id.replace(/[^5-79a-b]/g,"")+"abcdef").substring(0,6)}`);R=`${t.red(_)}, ${t.green(_)}, ${t.blue(_)}`,P=t.createDiv(),P.style("width","100%"),P.style("height","100%"),P.style("position","fixed"),P.style("background-image",`linear-gradient(to top, rgba(${R}, 0), rgba(${R}, 0))`),P.parent(this.gsCanvasDiv)}t.noCanvas(),t.pixelDensity(1),d=t.createDiv(),d.style("width","156px"),d.style("height","156px"),d.style("position","absolute"),d.style("top","120px"),d.style("left","50%"),d.style("transform","translateX(-50%)"),d.style("border-radius","156px"),d.style("background-image","url(assets/data/avatar.svg)"),d.style("background-position","center"),d.style("background-repeat","no-repeat"),d.style("background-size","cover"),d.style("cursor","pointer"),d.parent(this.gsCanvasDiv);let $=!1;d.mouseClicked(()=>{$||this.change_img_from_file(),$=!1}),d.elt.oncontextmenu=()=>(function(){var j=(0,G.A)(function*(){let k=yield i.global.GetValueFromClipboard();switch(k.type){case"text/plain":yield i.check_if_clipboard_available(k.value);break;case"image/png":return void i.inputImageSelected({target:{files:[k.value]}})}});return function(){return j.apply(this,arguments)}}()(),!1),v=t.createDiv();const A="36px";v.style("background-color",this.OnlineToggle?this.statusBar.colors.online:this.statusBar.colors.offline),v.style("width",A),v.style("height",A),v.style("position","absolute"),v.style("top","8px"),v.style("left","118px"),v.style("border-radius",A),v.style("cursor","pointer"),v.style("z-index","1"),v.parent(d),v.mouseClicked(()=>{$=!0,this.toggle_online()}),g=t.createImg(this.nakama.users.self.img,"profile_img"),g.style("width","156px"),g.style("height","156px"),g.style("border-radius","156px"),g.style("position","absolute"),g.style("object-fit","cover"),this.nakama.users.self.img||g.hide(),g.parent(d),h=t.createImg(void 0,"before_img"),h.style("width","156px"),h.style("height","156px"),h.style("border-radius","156px"),h.style("position","absolute"),h.style("object-fit","cover"),h.hide(),h.parent(d),this.p5ChangeImageSmooth=_=>{d.style("background-image","url(assets/data/avatar.svg)"),_?(h.elt.src=void 0,h.hide()):(h.elt.src=g.elt.src,h.show()),g.elt.src=_,w=1,t.loop(),this.nakama.users.self.img=_,this.sync_to_all_server(),document.getElementById(this.file_sel_id).value="",_?g.show():g.hide()};let b=t.createDiv();b.style("width","100%"),b.style("position","absolute"),b.style("top","330px"),b.style("display","flex"),b.style("flex-direction","column"),b.parent(this.gsCanvasDiv);const L="36px";n=t.createDiv(),n.style("font-size",L),n.style("font-weight","bold"),n.style("align-self","center"),n.style("width","80%"),n.style("text-align","center"),n.parent(b),l=t.createSpan(this.nakama.users.self.display_name||this.lang.text.Profile.noname_user),l.parent(n),t.createSpan('<ion-icon name="pencil-outline" style="width: 24px; height: 24px; margin-left: 8px"></ion-icon>').parent(n),n.mouseClicked(()=>{this.EditingName=!0,o.value(this.nakama.users.self.display_name?l.html():""),o.show(),n.hide(),o.elt.focus()}),o=t.createInput(),o.style("font-size",L),o.style("font-weight","bold"),o.style("align-self","center"),o.style("width","80%"),o.style("text-align","center"),o.attribute("placeholder",this.lang.text.Profile.name_placeholder),n.style("text-align","center"),o.parent(b),o.hide(),o.elt.addEventListener("input",()=>{this.nakama.users.self.display_name=o.value()}),o.elt.addEventListener("focusout",()=>{this.EditingName=!1,this.nakama.users.self.display_name=o.value(),l.html(`${o.value()||this.lang.text.Profile.noname_user}`),o.hide(),n.show()}),this.nakamagroup&&this.nakamagroup.client.getAccount(this.nakamagroup.session).then(_=>{if(JSON.parse(_.user.metadata).is_admin){let k=t.createDiv(this.nakamagroup.session.user_id);k.style("color","var(--ion-color-medium)"),k.style("align-self","center"),k.style("margin-top","36px"),k.style("width","80%"),k.style("text-align","center"),k.style("cursor","copy"),k.parent(b),k.mouseClicked(()=>{this.copy_id()})}}),f.style("margin-top","60px"),f.style("width","80%"),f.style("align-self","center"),f.style("max-width","384px"),f.style("height","180px"),f.style("background-color","#8888"),f.style("text-align","center"),f.style("border-radius","24px"),f.style("display","flex"),f.style("flex-direction","column"),f.parent(b),this.OnlineToggle&&f.hide();let x=t.createInput(this.nakama.users.self.email);x.style("align-self","center"),x.style("margin-top","24px"),x.style("width","50%"),x.style("text-align","center"),x.attribute("placeholder","test@example.com"),x.attribute("type","email"),x.parent(f),x.elt.onchange=()=>{this.nakama.users.self.email=x.value(),this.email_modified()},x.elt.onkeypress=_=>{"Enter"==_.key&&p.elt.focus()};let p=t.createInput();p.style("margin-top","10px"),p.style("align-self","center"),p.style("width","50%"),p.style("text-align","center"),p.attribute("type","password"),p.attribute("placeholder",this.lang.text.Profile.at_least),p.parent(f),p.elt.onchange=()=>{this.nakama.users.self.password=p.value()},p.elt.onkeypress=_=>{"Enter"==_.key&&(this.nakama.users.self.password=p.value(),y.elt.disabled=!0,p.elt.blur(),this.toggle_online())},this.p5PasswordInput=p,setTimeout(()=>{this.nakama.users.self.email?this.nakama.users.self.password||p.elt.focus():x.elt.focus()},500),setTimeout(()=>{this.nakama.users.self.email?this.nakama.users.self.password||p.elt.focus():x.elt.focus()},150),y=t.createButton(this.OnlineToggle?this.lang.text.Profile.LogOut:this.lang.text.Profile.login_toggle),y.style("margin-top","17px"),y.style("align-self","center"),y.style("text-align","center"),y.style("font-size","24px"),y.style("border-radius","16px"),y.style("padding","12px 30px"),y.parent(f),y.mouseClicked(()=>{y.elt.disabled=!0,this.toggle_online()});let C=t.createA("https://is2you2.github.io/privacy/",this.lang.text.GroupServer.Privacy);C.elt.target="_system",C.style("align-self","center"),C.style("text-align","center"),C.style("margin-top","30px"),C.parent(b)},t.draw=()=>{w>0&&(w-=.025,h.style("opacity",`${w}`),g.style("opacity",""+(1-w))),this.nakama.users.self.online?this.lerpVal<1?this.lerpVal+=.025:this.lerpVal=1:this.lerpVal>0?this.lerpVal-=.025:this.lerpVal=0,O&&E<1&&(E+=.025),g.style("filter",`grayscale(${t.lerp(.9,0,this.lerpVal)}) contrast(${t.lerp(1.4,1,this.lerpVal)})`),h.style("filter",`grayscale(${t.lerp(.9,0,this.lerpVal)}) contrast(${t.lerp(1.4,1,this.lerpVal)})`),O&&P.style("background-image",`linear-gradient(to top, rgba(${R}, ${t.min(1,E)/2}), rgba(${R}, 0))`),w<=0&&(this.lerpVal>=1||this.lerpVal<=0)&&(!O||E>=1)&&(this.nakama.users.self.img&&d.style("background-image",""),this.OnlineToggle=this.lerpVal>=1,this.OnlineToggle?(f.hide(),y.html(this.lang.text.Profile.LogOut),v.style("background-color",this.statusBar.colors.online)):(f.show(),f.style("display","flex"),y.html(this.lang.text.Profile.login_toggle),v.style("background-color",this.statusBar.colors.offline)),this.nakama.users.self.display_name&&(l.html(this.nakama.users.self.display_name),o.value(this.nakama.users.self.display_name),o.hide()),this.ShowServerList=this.OnlineToggle,this.p5PasswordInput.value(""),y.elt.disabled=!1,t.noLoop())},t.keyPressed=S=>{"Enter"==S.code&&this.EditingName&&o.elt.blur()}}),this.ShowServerList=this.OnlineToggle}link_group(i,t){var a=this;return(0,G.A)(function*(){if(a.isOverrideButtonPressed)a.isOverrideButtonPressed=!1;else if("offline"==a.statusBar.groupServer[i][t])yield a.nakama.link_group(i,t);else try{a.nakama.servers[i][t].socket.disconnect(!0)}catch{a.nakama.OnSocketDisconnect(i,t)}})()}add_custom_dedicated(){if(this.add_custom_tog)return;if(!this.dedicated_info.name)return void this.p5toast.show({text:this.lang.text.GroupServer.NeedSetDIsplayName});this.add_custom_tog=!0;let i=(this.dedicated_info.address||"192.168.0.1").split("://"),t=i.pop().split(":"),a=i.pop();a?a+=":":a=this.global.checkProtocolFromAddress(t[0])?"https:":"http:",this.dedicated_info.address=t[0],this.dedicated_info.nakama_port=Number(t[1]),this.dedicated_info.useSSL="https:"==window.location.protocol&&!T.Yl,this.dedicated_info.useSSL=this.dedicated_info.useSSL||"https:"==a,this.dedicated_info.key=this.dedicated_info.key||"defaultkey",this.nakama.add_group_server(this.dedicated_info,()=>{this.servers=this.nakama.get_all_server_info(!0),this.link_group(this.dedicated_info.isOfficial,this.dedicated_info.target),this.dedicated_info.name=void 0,this.dedicated_info.address=void 0,this.dedicated_info.target=void 0,this.dedicated_info.nakama_port=void 0,this.dedicated_info.apache_port=void 0,this.dedicated_info.cdn_port=void 0,this.dedicated_info.webpush_port=void 0,this.dedicated_info.square_port=void 0,this.dedicated_info.webrtc_port=void 0,this.dedicated_info.key=void 0,this.dedicated_info.useSSL=void 0,this.dedicated_info.isOfficial=void 0}),this.RegisterNewServer.dismiss(),setTimeout(()=>{this.add_custom_tog=!1},1e3)}edit_server_info(i,t){return this.RegisterNewServer.dismiss(),this.isOverrideButtonPressed=!0,this.navCtrl.navigateForward("server-detail",{state:{data:this.nakama.servers[i][t].info}}),!1}remove_server(i,t){var a=this;return(0,G.A)(function*(){a.isOverrideButtonPressed=!0;let n=function(){var l=(0,G.A)(function*(o=!1){try{yield a.nakama.remove_server(i,t,o)}catch(g){console.log("\uc11c\ubc84 \uc0ad\uc81c \uc624\ub958: ",g)}a.servers=a.nakama.get_all_server_info(!0),a.nakama.rearrange_channels()});return function(){return l.apply(this,arguments)}}();"online"===a.statusBar.groupServer[i][t]?a.alertCtrl.create({header:a.lang.text.GroupServer.RemoveAccountReally,message:a.lang.text.ChatRoom.CannotUndone,buttons:[{text:a.lang.text.UserFsDir.OK,cssClass:"redfont",handler:n}]}).then(l=>l.present()):n(!0)})()}ionViewWillEnter(){this.PageFocusOut=!1}ionViewWillLeave(){this.PageFocusOut=!0,delete this.global.p5KeyShortCut.AddAct,delete this.global.p5KeyShortCut.EnterAct,this.nakama.on_socket_disconnected.group_unlink_by_user&&delete this.nakama.on_socket_disconnected.group_unlink_by_user,delete this.nakama.socket_reactive.profile,this.nakama.users.self.img=this.tmp_img||this.nakama.users.self.img,this.nakama.save_profile_to_server()}ngOnDestroy(){this.RegisterNewServer.dismiss(),this.global.RestoreShortCutAct("group-server"),this.route.queryParams.unsubscribe(),this.p5canvas.remove()}sync_to_all_server(){var i=this;return(0,G.A)(function*(){let t=i.nakama.get_all_online_server();i.nakama.save_self_profile(),i.indexed.saveTextFileToUserPath(JSON.stringify(i.nakama.users.self.img),"servers/self/profile.img"),i.tmp_img="";for(let a=0,n=t.length;a<n;a++){let l=i.nakama.collectLinkedUser(t[a]);if(i.nakama.users.self.img)try{yield t[a].client.writeStorageObjects(t[a].session,[{collection:"user_public",key:"profile_image",value:{img:i.nakama.users.self.img},permission_read:2,permission_write:1}]),yield i.nakama.servers[t[a].info.isOfficial][t[a].info.target].client.rpc(i.nakama.servers[t[a].info.isOfficial][t[a].info.target].session,"send_noti_fn",{receiver_id:l,title:"edit_profile",content:{type:"image"},code:N.I.EDIT_PROFILE,persistent:!1})}catch(o){console.log("inputImageSelected_err: ",o)}else try{yield t[a].client.deleteStorageObjects(t[a].session,{object_ids:[{collection:"user_public",key:"profile_image"}]}),yield i.nakama.servers[t[a].info.isOfficial][t[a].info.target].client.rpc(i.nakama.servers[t[a].info.isOfficial][t[a].info.target].session,"send_noti_fn",{receiver_id:l,title:"edit_profile",content:{type:"image"},code:N.I.EDIT_PROFILE,persistent:!1})}catch(o){console.error("inputImageSelected_err: ",o)}i.announce_update_profile=!1}})()}change_img_from_file(){var i=this;return(0,G.A)(function*(){i.announce_update_profile=!0,i.nakama.users.self.img?i.p5ChangeImageSmooth():document.getElementById(i.file_sel_id).click()})()}inputImageSelected(i){var t=this;return(0,G.A)(function*(){let a=setInterval(()=>{},110);setTimeout(()=>{clearInterval(a)},1500);let n=yield t.global.GetBase64ThroughFileReader(i.target.files[0]);t.nakama.limit_image_size(n,o=>{t.p5ChangeImageSmooth(o.canvas.toDataURL())}),document.getElementById(t.file_sel_id).value=""})()}ionViewDidEnter(){this.can_auto_modified=!0,this.global.p5KeyShortCut.AddAct=()=>{this.ShowServerList&&!this.EditingName&&!this.PageFocusOut&&this.OpenNewServerForm()}}email_modified(){this.can_auto_modified&&(this.nakama.users.self.online&&this.toggle_online(),this.nakama.users.self.online=!1,delete this.nakama.users.self.password,this.p5PasswordInput.value(""))}toggle_online(){var i=this;return(0,G.A)(function*(){if(i.OnlineToggle=!i.OnlineToggle,i.nakama.users.self.online=i.OnlineToggle,i.OnlineToggle){i.announce_update_profile=!1;try{if(!i.nakama.users.self.email)throw i.p5toast.show({text:i.lang.text.Profile.need_email}),"\uc774\uba54\uc77c \uacf5\ubc31";if(!i.nakama.users.self.password)throw i.p5toast.show({text:i.lang.text.Profile.need_password}),"\ube44\ubc00\ubc88\ud638 \uacf5\ubc31";i.nakama.save_self_profile(),yield i.nakama.init_all_sessions();const n=i.nakama.get_all_server_info(!0);"MobilePWA"==T.aH&&1==n.length&&(n[0].webpush_tog=!0,i.nakama.GetPushPubKey(n[0].isOfficial,n[0].target))}catch{i.nakama.users.self.online=!1,i.OnlineToggle=!1}}else{var t,a;yield i.nakama.RemoveNotiPubKey(),i.nakama.logout_all_server(),delete i.nakama.users.self.password,null===(t=(a=i.global).p5removeAllTodo)||void 0===t||t.call(a),i.nakama.groups.official={},i.nakama.groups.unofficial={},i.nakama.save_groups_with_less_info(),i.nakama.channels_orig.official={},i.nakama.channels_orig.unofficial={},i.nakama.rearrange_channels(),i.nakama.posts_orig.official={},i.nakama.posts_orig.unofficial={},i.nakama.rearrange_posts(),i.nakama.post_counter.official={},i.nakama.post_counter.unofficial={},i.nakama.save_post_counter(),(yield i.indexed.GetFileListFromDB("servers/official")).forEach(o=>i.indexed.removeFileFromUserPath(o)),(yield i.indexed.GetFileListFromDB("servers/unofficial")).forEach(o=>i.indexed.removeFileFromUserPath(o)),i.nakama.users.official={},i.nakama.users.unofficial={}}i.p5canvas.loop()})()}toggleAutoConnect(){this.nakama.AutoConnect?localStorage.removeItem("autoConnect"):localStorage.setItem("autoConnect","false")}check_if_clipboard_available(i){var t=this;return(0,G.A)(function*(){try{if(0!=i.indexOf("http"))throw"URL \uc8fc\uc18c\uac00 \uc544\ub2d8";yield new Promise((a,n)=>{let l=document.createElement("img");l.src=i,l.onload=()=>{t.p5ChangeImageSmooth(i),l.onload=null,l.onerror=null,l.remove(),a(void 0)},l.onerror=()=>{l.onload=null,l.onerror=null,l.remove(),n()}})}catch{try{if(0!=i.indexOf("data:image"))throw"DataURL \uc8fc\uc18c\uac00 \uc544\ub2d8";t.nakama.limit_image_size(i,n=>t.p5ChangeImageSmooth(n.canvas.toDataURL()))}catch{throw"\uc0ac\uc6a9\ubd88\uac00 \uc774\ubbf8\uc9c0"}}})()}OpenNewServerForm(){this.global.StoreShortCutAct("group-server-new-form"),this.RegisterNewServer.onDidDismiss().then(()=>{delete this.global.p5KeyShortCut.EnterAct,this.global.RestoreShortCutAct("group-server-new-form")}),this.global.p5KeyShortCut.EnterAct=i=>{i.ctrlKey&&this.add_custom_dedicated()},this.RegisterNewServer.present().then(()=>{"DesktopPWA"==T.aH&&!this.dedicated_info.name&&this.ServerDisplayName.setFocus()})}copy_id(){this.global.WriteValueToClipboard("text/plain",this.nakamagroup.session.user_id)}}return(r=m).\u0275fac=function(i){return new(i||r)(e.rXU(N.X),e.rXU(M.G),e.rXU(X.j),e.rXU(U.n),e.rXU(Y.y),e.rXU(J.z3),e.rXU(z.q9),e.rXU(u.hG),e.rXU(I.nX),e.rXU(I.Ix))},r.\u0275cmp=e.VBU({type:r,selectors:[["app-group-server"]],viewQuery:function(i,t){if(1&i&&(e.GBs(H,5),e.GBs(K,5)),2&i){let a;e.mGM(a=e.lsd())&&(t.RegisterNewServer=a.first),e.mGM(a=e.lsd())&&(t.ServerDisplayName=a.first)}},decls:13,vars:5,consts:[["RegisterNewServer",""],["ServerDisplayName",""],[1,"ion-no-border"],["slot","start"],["defaultHref",""],["id","GroupServerCanvasDiv",2,"position","absolute","width","100%","height","100%","display","flex"],["style","position: absolute; bottom: 0; width: 100%;",4,"ngIf"],["hidden","","type","file","accept","image/*",3,"change","id"],["initialBreakpoint",".6",3,"breakpoints"],[2,"position","absolute","bottom","0","width","100%"],[2,"position","relative"],["class","shortcut_hint",4,"ngIf"],["button","","slot","header",3,"click"],["name","list-outline",1,"icon_margin"],["button","",3,"click"],["color","tertiary",1,"ion-text-center"],[1,"shortcut_hint"],["button","",3,"disabled"],[1,"ion-text-right",3,"ngModelChange","label","ngModel","placeholder"],["placeholder","(https://)192.168.0.1",1,"ion-text-right",3,"ngModelChange","label","ngModel"],["slot","end","name","open-outline",3,"click"],["button","",3,"click","disabled"],[1,"ion-text-center"],["class","shortcut_hint","style","top: 0px;",4,"ngIf"],["button","",3,"ionChange"],[2,"pointer-events","none",3,"ngModelChange","ngModel"],["button","",3,"click","contextmenu",4,"ngFor","ngForOf"],[1,"shortcut_hint",2,"top","0px"],["button","",3,"click","contextmenu"],[1,"additional_form","status_bar_single"],[1,"form_margin"],[3,"click"]],template:function(i,t){if(1&i){const a=e.RV6();e.j41(0,"ion-header",2)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s(),e.j41(4,"ion-buttons",3),e.nrm(5,"ion-back-button",4),e.k0s()()(),e.j41(6,"ion-content"),e.nrm(7,"div",5),e.DNE(8,Q,10,3,"div",6),e.j41(9,"input",7),e.bIt("change",function(l){return e.eBV(a),e.Njj(t.inputImageSelected(l))}),e.k0s(),e.j41(10,"ion-modal",8,0),e.DNE(12,ie,23,16,"ng-template"),e.k0s()()}2&i&&(e.R7$(3),e.JRh(t.lang.text.Settings.groupServer),e.R7$(5),e.Y8G("ngIf",t.ShowServerList),e.R7$(),e.Y8G("id",t.file_sel_id),e.R7$(),e.Y8G("breakpoints",e.lJ4(4,Z)))},dependencies:[F.Sq,F.bT,D.BC,D.vS,u.Jm,u.QW,u.W9,u.eU,u.iq,u.$w,u.uz,u.Dg,u.he,u.BC,u.BY,u.ai,u.Sb,u.hB,u.Gw,u.el],styles:[".content_size[_ngcontent-%COMP%]{height:360px}ion-input[_ngcontent-%COMP%]{--highlight-color-valid: var(--ion-color-primary)}"]}),m})()},{path:"server-detail",loadChildren:()=>c.e(3456).then(c.bind(c,3456)).then(r=>r.ServerDetailPageModule)}];let se=(()=>{var r;class m{}return(r=m).\u0275fac=function(i){return new(i||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[I.iI.forChild(ae),I.iI]}),m})(),ne=(()=>{var r;class m{}return(r=m).\u0275fac=function(i){return new(i||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[F.MD,D.YN,u.bv,se]}),m})()}}]);