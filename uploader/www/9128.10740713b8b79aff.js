"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9128],{9128:(ve,P,d)=>{d.r(P),d.d(P,{SubscribesPageModule:()=>pe});var G=d(177),F=d(4341),m=d(5374),C=d(9858),I=d(467),g=d(9969),e=d(3953),T=d(4237),B=d(8065),O=d(4234),X=d(7100),E=d(3656),A=d(755),D=d(3307);const N=["PersonalChat"],M=()=>[0,.7,1],Y=()=>[0,1,2];function w(a,r){1&a&&(e.j41(0,"div",20),e.EFF(1,"D"),e.k0s())}function V(a,r){if(1&a){const t=e.RV6();e.j41(0,"div",18),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.nakama.clear_removed_groups())}),e.DNE(1,w,2,0,"div",6),e.nrm(2,"ion-icon",19),e.k0s()}if(2&a){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.global.ShowHint&&!t.global.BlockMainShortcut)}}function U(a,r){1&a&&(e.j41(0,"div",20),e.EFF(1,"A"),e.k0s())}function J(a,r){if(1&a){const t=e.RV6();e.j41(0,"ion-item",27),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,o=e.XpG(2);return e.Njj(o.check_notifications(i))}),e.j41(1,"ion-label"),e.EFF(2),e.k0s()()}if(2&a){const t=e.XpG().$implicit,n=e.XpG(2);e.R7$(2),e.JRh(n.nakama.notifications_rearrange[t].request)}}function L(a,r){if(1&a&&(e.j41(0,"div"),e.DNE(1,J,3,1,"ion-item",26),e.k0s()),2&a){const t=r.$implicit,n=e.XpG(2);e.R7$(),e.Y8G("ngIf",n.nakama.notifications_rearrange.length>t)}}function K(a,r){if(1&a&&(e.j41(0,"ion-accordion-group",21,1)(2,"ion-accordion",22)(3,"ion-item",23)(4,"ion-label"),e.EFF(5),e.k0s()(),e.j41(6,"div",24),e.DNE(7,L,2,1,"div",25),e.k0s()()()),2&a){const t=e.XpG();e.Y8G("value",!1),e.R7$(5),e.JRh(t.lang.text.Subscribes.has_noties),e.R7$(2),e.Y8G("ngForOf",e.lJ4(3,Y))}}function H(a,r){if(1&a&&(e.j41(0,"div",28),e.EFF(1),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.SpI("` (",t.lang.text.Subscribes.RightClickChat,")")}}function W(a,r){if(1&a&&(e.j41(0,"div",28),e.EFF(1),e.k0s()),2&a){const t=e.XpG().index;e.R7$(),e.SpI("",(t+1)%10," ")}}function Q(a,r){if(1&a&&e.nrm(0,"div",40),2&a){const t=e.XpG().$implicit;e.Aen("background-image: linear-gradient(to right, #0000, #"+(t.color||"abcdef")+"44)")}}function z(a,r){if(1&a&&(e.j41(0,"span",41),e.EFF(1),e.k0s()),2&a){const t=e.XpG(4);e.R7$(),e.JRh("("+t.lang.text.AddGroup.Volatile+")")}}function Z(a,r){if(1&a&&(e.j41(0,"span",41),e.EFF(1),e.k0s()),2&a){const t=e.XpG().$implicit,n=e.XpG(3);e.R7$(),e.SpI(" ","("+(t.local?n.lang.text.AddGroup.UseLocalStorage:t.server.name||t.server.target)+")"," ")}}function q(a,r){if(1&a){const t=e.RV6();e.j41(0,"div",11),e.DNE(1,W,2,1,"div",12),e.j41(2,"ion-item",13),e.bIt("click",function(){const i=e.eBV(t).$implicit,o=e.XpG(3);return e.Njj(o.go_to_chatroom(i))})("contextmenu",function(){const i=e.eBV(t).$implicit,o=e.XpG(3);return e.Njj(o.ChannelContextMenu(i))}),e.j41(3,"div",33),e.nrm(4,"img",34)(5,"div",35),e.k0s(),e.DNE(6,Q,1,2,"div",36),e.j41(7,"ion-label")(8,"div",37)(9,"table")(10,"tr")(11,"td")(12,"span"),e.EFF(13),e.k0s(),e.DNE(14,z,2,1,"span",38)(15,Z,2,1,"span",38),e.k0s()()()(),e.j41(16,"div",39),e.EFF(17),e.k0s()()()()}if(2&a){const t=r.$implicit,n=r.index,i=e.XpG(3);e.Y8G("@chat_channel_anim",void 0),e.R7$(),e.Y8G("ngIf",i.global.ShowHint&&!i.global.BlockMainShortcut&&n<10),e.R7$(3),e.Aen("online"==t.status||"certified"==t.status||t.redirect&&3==t.redirect.type&&"pending"==t.status?"filter: grayscale(0) contrast(1)":"filter: grayscale(.9) contrast(1.4)"),e.Y8G("src",t.info&&t.info.img||(t.local||t.info&&1==t.info.max_count?"assets/data/local.svg":"assets/data/channel.svg"),e.B4B),e.R7$(),e.Aen("background-color: "+i.statusBar.colors[t.status||"offline"]),e.R7$(),e.Y8G("ngIf",t.is_new),e.R7$(7),e.SpI(" ",t.info?t.info.name||(i.nakama.usernameOverride[t.info.isOfficial]&&i.nakama.usernameOverride[t.info.isOfficial][t.info.target]?i.nakama.usernameOverride[t.info.isOfficial][t.info.target][t.info.id]:"")||t.info.display_name||i.lang.text.ChatRoom.noname_chatroom:t.title||i.lang.text.ChatRoom.noname_chatroom," "),e.R7$(),e.Y8G("ngIf",t.volatile),e.R7$(),e.Y8G("ngIf",(i.nakama.showServer||t.local)&&!t.volatile),e.R7$(2),e.SpI(" ",t.last_comment||t.noti||i.lang.text.Subscribes.noMessageHistory," ")}}function ee(a,r){if(1&a&&(e.j41(0,"div"),e.DNE(1,q,18,12,"div",32),e.k0s()),2&a){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.nakama.channels)}}function te(a,r){if(1&a){const t=e.RV6();e.j41(0,"div")(1,"div",42),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.IndexText="")}),e.nrm(2,"ion-icon",43),e.j41(3,"div")(4,"ion-label",44),e.EFF(5),e.k0s()()()()}if(2&a){const t=e.XpG(3);e.R7$(5),e.JRh(t.lang.text.Subscribes.EmptyData)}}function ie(a,r){if(1&a&&(e.j41(0,"div",28),e.EFF(1),e.k0s()),2&a){const t=e.XpG().index;e.R7$(),e.SpI("",(t+1)%10," ")}}function ne(a,r){if(1&a&&e.nrm(0,"div",40),2&a){const t=e.XpG().$implicit;e.Aen("background-image: linear-gradient(to right, #0000, #"+(t.color||"abcdef")+"44)")}}function ae(a,r){if(1&a&&(e.j41(0,"span",41),e.EFF(1),e.k0s()),2&a){const t=e.XpG(4);e.R7$(),e.JRh("("+t.lang.text.AddGroup.Volatile+")")}}function se(a,r){if(1&a&&(e.j41(0,"span",41),e.EFF(1),e.k0s()),2&a){const t=e.XpG().$implicit,n=e.XpG(3);e.R7$(),e.SpI(" ","("+(t.local?n.lang.text.AddGroup.UseLocalStorage:t.server.name||t.server.target)+")"," ")}}function oe(a,r){if(1&a){const t=e.RV6();e.j41(0,"div",11),e.DNE(1,ie,2,1,"div",12),e.j41(2,"ion-item",13),e.bIt("click",function(){const i=e.eBV(t).$implicit,o=e.XpG(3);return e.Njj(o.go_to_chatroom(i))})("contextmenu",function(){const i=e.eBV(t).$implicit,o=e.XpG(3);return e.Njj(o.ChannelContextMenu(i))}),e.j41(3,"div",33),e.nrm(4,"img",34)(5,"div",35),e.k0s(),e.DNE(6,ne,1,2,"div",36),e.j41(7,"ion-label")(8,"div",37)(9,"table")(10,"tr")(11,"td")(12,"span"),e.EFF(13),e.k0s(),e.DNE(14,ae,2,1,"span",38)(15,se,2,1,"span",38),e.k0s()()()(),e.j41(16,"div",39),e.EFF(17),e.k0s()()()()}if(2&a){const t=r.$implicit,n=r.index,i=e.XpG(3);e.Y8G("@chat_channel_anim",void 0),e.R7$(),e.Y8G("ngIf",i.global.ShowHint&&!i.global.BlockMainShortcut&&n<10),e.R7$(3),e.Aen("online"==t.status||"certified"==t.status||t.redirect&&3==t.redirect.type&&"pending"==t.status?"filter: grayscale(0) contrast(1)":"filter: grayscale(.9) contrast(1.4)"),e.Y8G("src",t.info&&t.info.img||(t.local||t.info&&1==t.info.max_count?"assets/data/local.svg":"assets/data/channel.svg"),e.B4B),e.R7$(),e.Aen("background-color: "+i.statusBar.colors[t.status||"offline"]),e.R7$(),e.Y8G("ngIf",t.is_new),e.R7$(7),e.SpI(" ",t.info?t.info.name||(i.nakama.usernameOverride[t.info.isOfficial]&&i.nakama.usernameOverride[t.info.isOfficial][t.info.target]?i.nakama.usernameOverride[t.info.isOfficial][t.info.target][t.info.id]:"")||t.info.display_name||i.lang.text.ChatRoom.noname_chatroom:t.title||i.lang.text.ChatRoom.noname_chatroom," "),e.R7$(),e.Y8G("ngIf",t.volatile),e.R7$(),e.Y8G("ngIf",(i.nakama.showServer||t.local)&&!t.volatile),e.R7$(2),e.SpI(" ",t.last_comment||t.noti||i.lang.text.Subscribes.noMessageHistory," ")}}function re(a,r){if(1&a&&(e.j41(0,"div"),e.DNE(1,te,6,1,"div",16)(2,oe,18,12,"div",32),e.k0s()),2&a){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",!t.channels.length),e.R7$(),e.Y8G("ngForOf",t.channels)}}function le(a,r){if(1&a){const t=e.RV6();e.j41(0,"div")(1,"ion-item-divider",29)(2,"ion-label",30),e.EFF(3),e.k0s(),e.j41(4,"ion-searchbar",31),e.bIt("ionFocus",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.global.toggleBlockMainShortcut(!0))})("ionBlur",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.global.toggleBlockMainShortcut(!1))})("ionInput",function(i){e.eBV(t);const o=e.XpG();return e.Njj(o.filterChatList(i))}),e.mxI("ngModelChange",function(i){e.eBV(t);const o=e.XpG();return e.DH7(o.IndexText,i)||(o.IndexText=i),e.Njj(i)}),e.k0s()(),e.DNE(5,ee,2,1,"div",16)(6,re,3,2,"div",16),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("@channel_list_anim",void 0),e.R7$(3),e.JRh(t.lang.text.Subscribes.JoinedChannels),e.R7$(),e.Y8G("placeholder",t.lang.text.Subscribes.Search),e.R50("ngModel",t.IndexText),e.R7$(),e.Y8G("ngIf",!t.IndexText),e.R7$(),e.Y8G("ngIf",t.IndexText)}}function ce(a,r){if(1&a){const t=e.RV6();e.j41(0,"div")(1,"div",42),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.nakama.add_new_group())}),e.nrm(2,"ion-icon",45),e.j41(3,"div")(4,"ion-label",44),e.EFF(5),e.k0s()()()()}if(2&a){const t=e.XpG();e.Y8G("@channel_list_anim",void 0),e.R7$(5),e.JRh(t.lang.text.Subscribes.NoChat)}}function _e(a,r){if(1&a){const t=e.RV6();e.j41(0,"ion-item",27),e.bIt("click",function(){const i=e.eBV(t).index,o=e.XpG(2);return e.Njj(o.select_server(i))}),e.j41(1,"ion-label"),e.EFF(2),e.k0s()()}if(2&a){const t=r.$implicit;e.R7$(2),e.JRh(t.name)}}function de(a,r){if(1&a){const t=e.RV6();e.j41(0,"img",54),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.copy_info(i.TempInvitationAddress))})("contextmenu",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.copy_info(i.InvitationAddress))}),e.k0s()}if(2&a){const t=e.XpG(2);e.Y8G("src",t.QRCodeSRC,e.B4B)}}function ge(a,r){if(1&a){const t=e.RV6();e.j41(0,"ion-item",27),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.copy_info(i.user_id))}),e.j41(1,"ion-label",55),e.EFF(2),e.k0s()()}if(2&a){const t=e.XpG(2);e.R7$(2),e.JRh(t.user_id)}}function ue(a,r){if(1&a){const t=e.RV6();e.j41(0,"ion-content",11),e.nrm(1,"div",46),e.j41(2,"div",47)(3,"ion-item-divider")(4,"ion-label"),e.EFF(5),e.k0s()(),e.j41(6,"ion-accordion-group",48,2),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.isExpanded=!0)}),e.j41(8,"ion-accordion",22)(9,"ion-item",23)(10,"ion-label",49),e.EFF(11),e.k0s(),e.j41(12,"ion-label",50),e.EFF(13),e.k0s(),e.nrm(14,"ion-icon",51),e.k0s(),e.j41(15,"div",24),e.DNE(16,_e,3,1,"ion-item",52),e.k0s()()(),e.DNE(17,de,1,1,"img",53)(18,ge,3,1,"ion-item",26),e.k0s()()}if(2&a){const t=e.XpG();e.R7$(5),e.JRh(t.lang.text.Subscribes.OnebyOneChat),e.R7$(),e.Y8G("value",t.isExpanded),e.R7$(5),e.JRh(t.lang.text.AddGroup.SelectServer),e.R7$(2),e.JRh(t.servers[t.index].name),e.R7$(3),e.Y8G("ngForOf",t.servers),e.R7$(),e.Y8G("ngIf",t.QRCodeSRC),e.R7$(),e.Y8G("ngIf",t.showUserId)}}const he=[{path:"",component:(()=>{var a;class r{constructor(n,i,o,s,c,l,u,f){this.nakama=n,this.statusBar=i,this.lang=o,this.global=s,this.navCtrl=c,this.indexed=l,this.alertCtrl=u,this.p5loading=f,this.IndexText="",this.channels=[],this.servers=[],this.isExpanded=!1,this.index=0,this.showUserId=!1,this.lock_chatroom=!1}ngOnInit(){this.indexed.ionicDB?this.indexed.loadTextFromUserPath("servers/self/profile.img",(n,i)=>{n&&i&&(this.nakama.users.self.img=i.replace(/"|=|\\/g,""))}):this.indexed.PortalTabCallback.push(()=>{this.indexed.loadTextFromUserPath("servers/self/profile.img",(n,i)=>{n&&i&&(this.nakama.users.self.img=i.replace(/"|=|\\/g,""))})}),this.global.PortalBottonTabAct.Subscribes=(n=!0)=>{this.SubscribesScrollDiv&&n&&this.SubscribesScrollDiv.scrollTo({top:0,behavior:"smooth"})}}try_add_shortcut(){this.global.p5KeyShortCut?this.AddShortcut():setTimeout(()=>{this.try_add_shortcut()},100)}filterChatList(n){if(this.IndexText=n.detail.value,this.channels.length=0,this.IndexText)for(let s=0,c=this.nakama.channels.length;s<c;s++)try{var i,o;const l=this.nakama.channels[s],u=null===(i=l.title||(null===(o=l.info)||void 0===o?void 0:o.name))||void 0===i?void 0:i.toLowerCase();(null==u?void 0:u.indexOf(this.IndexText.toLowerCase()))>=0&&this.channels.push(l)}catch(l){console.log("\ucc44\ub110 \ud544\ud130\ub9c1 \uc624\ub958: ",l)}}AddShortcut(){this.global.p5KeyShortCut.Backquote=()=>{this.nakama.open_profile_page()},this.global.p5KeyShortCut.Digit=n=>{this.IndexText?this.channels.length>n?this.go_to_chatroom(this.channels[n]):this.nakama.add_new_group():this.nakama.channels.length>n?this.go_to_chatroom(this.nakama.channels[n]):this.nakama.add_new_group()},this.global.p5KeyShortCut.AddAct||(this.global.p5KeyShortCut.AddAct=n=>{n.shiftKey?this.AddUnTitledTemporaryChannel():this.nakama.add_new_group()}),this.global.p5KeyShortCut.DeleteAct||(this.global.p5KeyShortCut.DeleteAct=()=>{this.nakama.clear_removed_groups()})}AddUnTitledTemporaryChannel(){return this.nakama.SaveLocalAct({volatile:!0},!0),!1}OpenOneByOneLink(){return this.servers=this.nakama.get_all_server_info(!0,!0),this.servers.length?(this.PersonalChat.onDidDismiss().then(()=>{var n,i;null===(n=this.nakama.TempWS)||void 0===n||null===(i=n.close)||void 0===i||i.call(n,1e3,"1:1 \uc5f0\uacb0 \ubaa8\ub2ec \ub2eb\ud798")}),this.PersonalChat.present(),this.select_server(0)):this.p5loading.update({id:"OneByOne",message:this.lang.text.Subscribes.Disconnected,forceEnd:350}),!1}select_server(n){var i,o;null===(i=this.nakama.TempWS)||void 0===i||null===(o=i.close)||void 0===o||o.call(i,1e3,"\uc0ac\uc6a9\uc790\uac00 \uc11c\ubc84\ub97c \ubcc0\uacbd\ud568"),this.nakama.TempWS=null,this.user_id=this.nakama.servers[this.servers[n].isOfficial][this.servers[n].target].session.user_id,this.isExpanded=!1,this.showUserId=!1,this.nakama.servers[this.servers[n].isOfficial][this.servers[n].target].client.getAccount(this.nakama.servers[this.servers[n].isOfficial][this.servers[n].target].session).then(k=>{let p=JSON.parse(k.user.metadata);this.showUserId=p.is_admin}),this.nakama.GenerateQRCode(this.nakama.servers[this.servers[n].isOfficial][this.servers[n].target].info).then(k=>{this.InvitationAddress=k,this.InvitationAddress+=`&open_prv_channel=${this.user_id}`,this.QRCodeSRC=this.global.readasQRCodeFromString(this.InvitationAddress.replace(/ /g,"%20")),this.nakama.TempQRCodeGenerateWS(this.nakama.servers[this.servers[n].isOfficial][this.servers[n].target].info,{act:"quick_prv",keys:["server_value","user_id","address"],server_value:{...this.nakama.servers[this.servers[n].isOfficial][this.servers[n].target].info},user_id:this.user_id,address:k}).then(p=>{this.TempInvitationAddress=p,this.QRCodeSRC=this.global.readasQRCodeFromString(p.replace(/ /g,"%20"))})});let s=`${(this.user_id.replace(/[^5-79a-b]/g,"")+"abcdef").substring(0,6)}`,f=`${parseInt(s.slice(0,2),16)},${parseInt(s.slice(2,4),16)},${parseInt(s.slice(4,6),16)}`;setTimeout(()=>{document.getElementById("SelfColorBg").style.backgroundImage=`linear-gradient(to top, rgba(${f}, .5), rgba(${f}, 0))`},0)}copy_info(n){return this.global.WriteValueToClipboard("text/plain",n),!1}ChannelContextMenu(n){var i,o,s=this;let c=n.server.isOfficial;const l=n.server.target;let u=n.title;switch(u=2==(null===(i=n.redirect)||void 0===i?void 0:i.type)?u||this.lang.text.Profile.noname_user:u||this.lang.text.ChatRoom.noname_chatroom,null===(o=n.redirect)||void 0===o?void 0:o.type){case 3:if("online"==n.status||"pending"==n.status){this.global.ActLikeModal("group-detail",{info:this.nakama.groups[c][l][n.group_id],server:{isOfficial:c,target:l}});break}case 2:this.alertCtrl.create({header:u,message:this.lang.text.ChatRoom.RemoveChannelLogs,buttons:[{text:this.lang.text.ChatRoom.Delete,handler:()=>{!function(){var k=(0,I.A)(function*(){var p;const x=`subscribes_remove_1:1_${Date.now()}`;let S;s.p5loading.update({id:x});try{S=s.nakama.servers[c][l].info}catch(_){console.log("\uc0ad\uc81c\ub41c \uc11c\ubc84\uc758 \ucc44\ub110 \uc0ad\uc81c: ",_),c="deleted"}try{yield s.nakama.remove_group_list(s.nakama.groups[c][l][n.group_id],c,l,!0)}catch{}delete s.nakama.channels_orig[c][l][n.id];try{yield s.nakama.remove_channel_files(c,l,n.id,void 0,x)}catch{}let h=`${n.id}_${s.nakama.users.self.display_name}`;try{h=`${n.info.id}_${S.session.user_id}`}catch{}if(0==(null===(p=n.id)||void 0===p?void 0:p.indexOf("4.")))try{h=`${n.user_id_one!=s.nakama.servers[c][l].session.user_id?n.user_id_one:n.user_id_two}_${s.nakama.servers[c][l].session.user_id}`}catch(_){console.log("\uc0ad\uc81c\ub41c \uc11c\ubc84\uc758 1:1 \ucc44\ub110 \uc7ac\uc870\uc815 \uc2e4\ud328: ",_)}try{var v;let _=localStorage.getItem("fallback_fs");if(!_)throw"\uc0ac\uc6a9\uc790 \uc9c0\uc815 \uc11c\ubc84 \uc5c6\uc74c";let b=_.split("://"),R=b.pop().split(":"),j=b.pop();j?j+=":":j=s.global.checkProtocolFromAddress(R[0])?"https:":"http:";const y=null===(v=R[1])||void 0===v?void 0:v.split(",");let fe=`${j}//${R[0]}:${(null==y?void 0:y[1])||9002}/`;R&&(yield s.global.remove_files_from_storage_with_key(fe,h,{user_id:s.nakama.servers[c][l].session.user_id}))}catch{}try{let _=s.nakama.GetNodejsServerAddress(c,l,"apache_port");yield s.global.remove_files_from_storage_with_key(_,h,{apache_port:S.apache_port,cdn_port:S.cdn_port,user_id:s.nakama.servers[c][l].session.user_id})}catch{}let $=yield s.indexed.GetFileListFromDB(`servers/${c}/${l}/channels/${n.id}`);for(let _=0,b=$.length;_<b;_++){s.p5loading.update({id:x,message:`${s.lang.text.UserFsDir.DeleteFile}: ${u} (${$[_].split("/").pop()})`,progress:_/b});try{yield s.indexed.removeFileFromUserPath($[_])}catch{}}s.p5loading.remove(x),s.nakama.rearrange_channels()});return function(){return k.apply(this,arguments)}}()()},cssClass:"redfont"}]}).then(f=>f.present());break;case 0:this.alertCtrl.create({header:u,message:this.lang.text.ChatRoom.RemoveChannelLogs,buttons:[{text:this.lang.text.ChatRoom.Delete,handler:()=>{!function(){var k=(0,I.A)(function*(){const p=`subscribes_remove_local_${Date.now()}`;s.p5loading.update({id:p}),delete s.nakama.channels_orig[c][l][n.id];try{yield s.indexed.removeFileFromUserPath(`servers/${c}/${l}/groups/${n.id}.img`)}catch(h){console.log("\uadf8\ub8f9 \uc774\ubbf8\uc9c0 \uc0ad\uc81c \uc624\ub958: ",h)}s.nakama.save_groups_with_less_info();try{var x;const h=localStorage.getItem("fallback_fs");if(!h)throw"\uc0ac\uc6a9\uc790 \uc9c0\uc815 \uc11c\ubc84 \uc5c6\uc74c";const v=h.split("://"),$=v.pop().split(":");let _=v.pop();_?_+=":":_=s.global.checkProtocolFromAddress($[0])?"https:":"http:";const b=null===(x=$[1])||void 0===x?void 0:x.split(",");let R=`${_}//${$[0]}:${(null==b?void 0:b[1])||9002}/`,j=`${n.id}_${s.nakama.users.self.display_name}`;try{j=`${n.info.id}_${s.nakama.servers[c][l].session.user_id}`}catch{}$[0]&&(yield s.global.remove_files_from_storage_with_key(R,j,{user_id:s.nakama.servers[c][l].session.user_id}))}catch{}let S=yield s.indexed.GetFileListFromDB(`servers/${c}/${l}/channels/${n.id}`);for(let h=0,v=S.length;h<v;h++)s.p5loading.update({id:p,message:`${s.lang.text.UserFsDir.DeleteFile}: ${u} (${S[h].split("/").pop()})`,progress:h/v}),yield s.indexed.removeFileFromUserPath(S[h]);s.p5loading.remove(p),s.nakama.rearrange_channels()});return function(){return k.apply(this,arguments)}}()()},cssClass:"redfont"}]}).then(f=>f.present())}return!1}ionViewDidEnter(){this.SubscribesScrollDiv||(this.SubscribesScrollDiv=document.getElementById("SubscribesScrollDiv")),this.nakama.subscribe_lock=!0,this.try_add_shortcut()}go_to_page(n){this.global.RemoveAllModals(()=>{this.navCtrl.navigateForward(`portal/settings/${n}`)})}go_to_chatroom(n){this.lock_chatroom||(this.lock_chatroom=!0,this.nakama.go_to_chatroom(n),this.lock_chatroom=!1)}check_notifications(n){let i=this.nakama.notifications_rearrange[n].server;this.nakama.check_notifications(this.nakama.notifications_rearrange[n],i.isOfficial,i.target)}ionViewWillLeave(){this.nakama.subscribe_lock=!1,delete this.global.p5KeyShortCut.Backquote,delete this.global.p5KeyShortCut.Digit,delete this.global.p5KeyShortCut.AddAct,delete this.global.p5KeyShortCut.DeleteAct}}return(a=r).\u0275fac=function(n){return new(n||a)(e.rXU(T.X),e.rXU(B.j),e.rXU(O.y),e.rXU(X.z3),e.rXU(E.q9),e.rXU(A.n),e.rXU(m.hG),e.rXU(D.f))},a.\u0275cmp=e.VBU({type:a,selectors:[["app-subscribes"]],viewQuery:function(n,i){if(1&n&&e.GBs(N,5),2&n){let o;e.mGM(o=e.lsd())&&(i.PersonalChat=o.first)}},decls:27,vars:16,consts:[["PersonalChat",""],["accordionGroup",""],["OnebyOneServerList",""],[1,"ion-no-border"],["class","add_group top_icon_override_1",3,"click",4,"ngIf"],[1,"add_group",3,"click","contextmenu"],["class","shortcut_hint shortcut_top_add",4,"ngIf"],["button","","name","add-circle-outline",2,"width","24px","height","24px"],[1,"header_online_circle",3,"click"],["id","SubscribesScrollDiv",2,"height","100%","overflow-y","auto"],["value","colors","expand","inset",3,"value",4,"ngIf"],[2,"position","relative"],["class","shortcut_hint",4,"ngIf"],["button","",3,"click","contextmenu"],[1,"additional_form","bg_img_form"],["loading","lazy",1,"profile_img",3,"src"],[4,"ngIf"],["initialBreakpoint",".7",3,"breakpoints"],[1,"add_group","top_icon_override_1",3,"click"],["button","","name","trash-outline",2,"width","24px","height","24px"],[1,"shortcut_hint","shortcut_top_add"],["value","colors","expand","inset",3,"value"],["value","colors"],["slot","header"],["slot","content"],[4,"ngFor","ngForOf"],["button","",3,"click",4,"ngIf"],["button","",3,"click"],[1,"shortcut_hint"],[2,"display","flex","justify-content","flex-end"],[2,"flex","1 0"],[2,"width","50%","min-width","200px","padding","0",3,"ionFocus","ionBlur","ionInput","ngModelChange","placeholder","ngModel"],["style","position: relative;",4,"ngFor","ngForOf"],[1,"channel_image","channel_image_div"],["alt","ch_img","loading","lazy",1,"channel_image",3,"src"],[1,"status_circle"],["class","additional_form new_bg_form",3,"style",4,"ngIf"],[1,"channel_text_form","header"],["class","server_target",4,"ngIf"],[1,"channel_text_form","content"],[1,"additional_form","new_bg_form"],[1,"server_target"],[1,"disconnect_info",3,"click"],["color","medium","name","search-outline",2,"width","60px","height","60px"],["color","medium"],["color","medium","name","chatbubble-ellipses-outline",2,"width","60px","height","60px"],["id","SelfColorBg",2,"position","fixed","width","100%","height","100%","pointer-events","none"],[2,"padding","16px"],["value","colors","expand","inset",3,"click","value"],[2,"display","contents"],[1,"ion-text-right"],[1,"ion-accordion-toggle-icon","hide_accordion_icon"],["button","",3,"click",4,"ngFor","ngForOf"],["style","width: 100%; height: auto; cursor: copy;","alt","Loading",3,"src","click","contextmenu",4,"ngIf"],["alt","Loading",2,"width","100%","height","auto","cursor","copy",3,"click","contextmenu","src"],[1,"ion-text-center"]],template:function(n,i){if(1&n){const o=e.RV6();e.j41(0,"ion-header",3)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s(),e.DNE(4,V,3,1,"div",4),e.j41(5,"div",5),e.bIt("click",function(){return e.eBV(o),e.Njj(i.nakama.add_new_group())})("contextmenu",function(){return e.eBV(o),e.Njj(i.AddUnTitledTemporaryChannel())}),e.DNE(6,U,2,0,"div",6),e.nrm(7,"ion-icon",7),e.k0s(),e.j41(8,"div",8),e.bIt("click",function(){return e.eBV(o),e.Njj(i.nakama.toggle_all_session())}),e.k0s()()(),e.j41(9,"ion-content")(10,"div",9),e.DNE(11,K,8,4,"ion-accordion-group",10),e.j41(12,"ion-item-divider")(13,"ion-label"),e.EFF(14),e.k0s()(),e.j41(15,"div",11),e.DNE(16,H,2,1,"div",12),e.j41(17,"ion-item",13),e.bIt("click",function(){return e.eBV(o),e.Njj(i.nakama.open_profile_page())})("contextmenu",function(){return e.eBV(o),e.Njj(i.OpenOneByOneLink())}),e.j41(18,"div",14),e.nrm(19,"img",15),e.k0s(),e.j41(20,"ion-label"),e.EFF(21),e.k0s()()(),e.DNE(22,le,7,6,"div",16)(23,ce,6,2,"div",16),e.k0s(),e.j41(24,"ion-modal",17,0),e.DNE(26,ue,19,7,"ng-template"),e.k0s()()}2&n&&(e.R7$(3),e.JRh(i.lang.text.Subscribes.Title),e.R7$(),e.Y8G("ngIf",i.nakama.HasRemovedChannel),e.R7$(2),e.Y8G("ngIf",i.global.ShowHint&&!i.global.BlockMainShortcut),e.R7$(2),e.Aen("background-color: "+i.statusBar.colors[i.statusBar.settings.groupServer]+"; cursor: pointer;"),e.R7$(3),e.Y8G("ngIf",i.nakama.notifications_rearrange.length),e.R7$(3),e.JRh(i.lang.text.Subscribes.myProfile),e.R7$(2),e.Y8G("ngIf",i.global.ShowHint&&!i.global.BlockMainShortcut),e.R7$(3),e.Aen(i.nakama.users.self.online?"filter: grayscale(0) contrast(1);":"filter: grayscale(.9) contrast(1.4);"),e.Y8G("src",i.nakama.users.self.img,e.B4B),e.R7$(2),e.JRh(i.nakama.users.self.display_name||i.lang.text.Profile.noname_user),e.R7$(),e.Y8G("ngIf",i.nakama.channels.length),e.R7$(),e.Y8G("ngIf",!i.nakama.channels.length),e.R7$(),e.Y8G("breakpoints",e.lJ4(15,M)))},dependencies:[G.Sq,G.bT,F.BC,F.vS,m.xk,m.YH,m.W9,m.eU,m.iq,m.uz,m.Dg,m.he,m.S1,m.BC,m.ai,m.Sb,m.Gw],styles:[".advertise_banner[_ngcontent-%COMP%]{width:100%;max-height:150px}.header[_ngcontent-%COMP%]{padding-bottom:4px}.content[_ngcontent-%COMP%]{color:#888;height:24px;line-height:24px;vertical-align:middle;overflow:hidden}.channel_image_div[_ngcontent-%COMP%]{position:absolute}.channel_image[_ngcontent-%COMP%]{width:52px;height:52px;border-radius:64px;object-fit:cover}.status_bar[_ngcontent-%COMP%]{width:5px;height:76%}.channel_text_form[_ngcontent-%COMP%]{margin-left:64px}.status_circle[_ngcontent-%COMP%]{position:relative;top:-56px;left:38px;width:12px;height:12px;border-radius:12px}.add_group[_ngcontent-%COMP%]{position:absolute;right:68px;top:16px;cursor:pointer}.top_icon_override_1[_ngcontent-%COMP%]{right:116px}.top_icon_override_2[_ngcontent-%COMP%]{right:164px}ion-searchbar[_ngcontent-%COMP%]{--box-shadow: none;--searchbar-box-shadow: none}"],data:{animation:[(0,g.hZ)("channel_list_anim",[(0,g.kY)(":enter",[(0,g.iF)({opacity:0}),(0,g.i0)(".3s ease-out",(0,g.iF)({opacity:1}))]),(0,g.kY)(":leave",[(0,g.i0)(".3s ease-in",(0,g.iF)({opacity:0}))])]),(0,g.hZ)("chat_channel_anim",[(0,g.kY)(":enter",[(0,g.iF)({opacity:0,transform:"translateX(-20px)",height:0}),(0,g.i0)(".5s ease-out",(0,g.iF)({opacity:1,transform:"translateX(0)",height:70}))]),(0,g.kY)(":leave",[(0,g.i0)(".5s ease-in",(0,g.iF)({opacity:0,transform:"translateX(20px)",height:0}))])])]}}),r})()},{path:"chat-room",loadChildren:()=>Promise.all([d.e(2076),d.e(6991)]).then(d.bind(d,6991)).then(a=>a.ChatRoomPageModule)}];let me=(()=>{var a;class r{}return(a=r).\u0275fac=function(n){return new(n||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[C.iI.forChild(he),C.iI]}),r})(),pe=(()=>{var a;class r{}return(a=r).\u0275fac=function(n){return new(n||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[G.MD,F.YN,m.bv,me]}),r})()}}]);