"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6524],{6524:(q,v,r)=>{r.r(v),r.d(v,{InstantCallPageModule:()=>z});var p=r(177),_=r(4341),h=r(5374),I=r(9858),b=r(467),w=r(617),S=r(5402),P=r(8326),t=r(3953),R=r(482),y=r(4234),x=r(4020),A=r(345),M=r(4237),T=r(9900),W=r(3307),E=r(3656),k=r(7476);const j=["InstantCallServer"];function G(a,o){1&a&&t.nrm(0,"div",7)}function N(a,o){if(1&a&&(t.j41(0,"ion-select-option",16),t.EFF(1),t.k0s()),2&a){const i=o.$implicit;t.Y8G("value",i),t.R7$(),t.JRh(i.info.name)}}function V(a,o){if(1&a){const i=t.RV6();t.j41(0,"ion-item")(1,"ion-select",13,0),t.bIt("ionChange",function(e){t.eBV(i);const l=t.XpG(2);return t.Njj(l.SelectAddressTarget(e))}),t.j41(3,"ion-select-option",14),t.EFF(4),t.k0s(),t.DNE(5,N,2,2,"ion-select-option",15),t.k0s()()}if(2&a){const i=t.XpG(2);t.R7$(),t.Y8G("label",i.lang.text.AddGroup.SelectServer),t.R7$(3),t.JRh(i.lang.text.voidDraw.InternalConn),t.R7$(),t.Y8G("ngForOf",i.ServerList)}}function D(a,o){if(1&a){const i=t.RV6();t.j41(0,"ion-item")(1,"ion-input",17),t.mxI("ngModelChange",function(e){t.eBV(i);const l=t.XpG(2);return t.DH7(l.UserInputCustomAddress,e)||(l.UserInputCustomAddress=e),t.Njj(e)}),t.k0s(),t.j41(2,"ion-icon",18),t.bIt("click",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.global.open_custom_site(e.UserInputCustomAddress))}),t.k0s()()}if(2&a){const i=t.XpG(2);t.R7$(),t.Y8G("label",i.lang.text.voidDraw.InputAddress),t.R50("ngModel",i.UserInputCustomAddress)}}function B(a,o){if(1&a){const i=t.RV6();t.j41(0,"ion-item")(1,"ion-input",19),t.mxI("ngModelChange",function(e){t.eBV(i);const l=t.XpG(2);return t.DH7(l.Port,e)||(l.Port=e),t.Njj(e)}),t.k0s()()}if(2&a){const i=t.XpG(2);t.R7$(),t.Y8G("label",i.lang.text.GroupServer.WebRTCPort),t.R50("ngModel",i.Port),t.Y8G("placeholder",i.lang.text.Settings.joinDedi_placeholder+" (3478)")}}function F(a,o){if(1&a){const i=t.RV6();t.j41(0,"ion-item")(1,"ion-input",19),t.mxI("ngModelChange",function(e){t.eBV(i);const l=t.XpG(2);return t.DH7(l.signalPort,e)||(l.signalPort=e),t.Njj(e)}),t.k0s()()}if(2&a){const i=t.XpG(2);t.R7$(),t.Y8G("label",i.lang.text.GroupServer.SquarePort),t.R50("ngModel",i.signalPort),t.Y8G("placeholder",i.lang.text.Settings.joinDedi_placeholder+" (12013)")}}function O(a,o){if(1&a){const i=t.RV6();t.j41(0,"ion-item")(1,"ion-input",19),t.mxI("ngModelChange",function(e){t.eBV(i);const l=t.XpG(2);return t.DH7(l.Username,e)||(l.Username=e),t.Njj(e)}),t.k0s()()}if(2&a){const i=t.XpG(2);t.R7$(),t.Y8G("label",i.lang.text.WebRTCDevManager.Username),t.R50("ngModel",i.Username),t.Y8G("placeholder",i.lang.text.Settings.joinDedi_placeholder+" (username)")}}function U(a,o){if(1&a){const i=t.RV6();t.j41(0,"ion-item")(1,"ion-input",19),t.mxI("ngModelChange",function(e){t.eBV(i);const l=t.XpG(2);return t.DH7(l.Password,e)||(l.Password=e),t.Njj(e)}),t.k0s()()}if(2&a){const i=t.XpG(2);t.R7$(),t.Y8G("label",i.lang.text.WebRTCDevManager.Credential),t.R50("ngModel",i.Password),t.Y8G("placeholder",i.lang.text.Settings.joinDedi_placeholder+" (password)")}}function X(a,o){if(1&a){const i=t.RV6();t.j41(0,"div",8),t.DNE(1,V,6,3,"ion-item",6)(2,D,3,2,"ion-item",6)(3,B,2,3,"ion-item",6)(4,F,2,3,"ion-item",6)(5,O,2,3,"ion-item",6)(6,U,2,3,"ion-item",6),t.j41(7,"ion-item",9)(8,"ion-toggle",10),t.mxI("ngModelChange",function(e){t.eBV(i);const l=t.XpG();return t.DH7(l.global.useVideo,e)||(l.global.useVideo=e),t.Njj(e)}),t.EFF(9),t.k0s()(),t.j41(10,"ion-item",11),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.LinkToServer())}),t.j41(11,"ion-label",12),t.EFF(12),t.k0s()()()}if(2&a){const i=t.XpG();t.R7$(),t.Y8G("ngIf",i.ServerList.length),t.R7$(),t.Y8G("ngIf",i.NeedInputCustomAddress),t.R7$(),t.Y8G("ngIf",i.NeedInputCustomAddress),t.R7$(),t.Y8G("ngIf",i.NeedInputCustomAddress),t.R7$(),t.Y8G("ngIf",i.NeedInputCustomAddress),t.R7$(),t.Y8G("ngIf",i.NeedInputCustomAddress),t.R7$(2),t.R50("ngModel",i.global.useVideo),t.R7$(),t.JRh(i.lang.text.InstantCall.useVideo),t.R7$(3),t.JRh(i.lang.text.voidDraw.ConnectToAddress)}}function $(a,o){if(1&a){const i=t.RV6();t.j41(0,"img",22),t.bIt("click",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.copy_qr_address())}),t.k0s()}if(2&a){const i=t.XpG(2);t.Y8G("src",i.QRCodeSRC,t.B4B)}}function Y(a,o){if(1&a){const i=t.RV6();t.j41(0,"div"),t.DNE(1,$,1,1,"img",20),t.j41(2,"ion-item",11),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.copy_qr_address())}),t.j41(3,"ion-label",12),t.EFF(4),t.k0s()(),t.j41(5,"ion-item",11),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.OpenDevManager())}),t.j41(6,"ion-label",21),t.EFF(7),t.k0s()()()}if(2&a){const i=t.XpG();t.R7$(),t.Y8G("ngIf",i.QRCodeSRC),t.R7$(3),t.JRh(i.QRCodeAsString),t.R7$(3),t.JRh(i.lang.text.WebRTCDevManager.ManageInput)}}function Q(a,o){if(1&a&&(t.j41(0,"div")(1,"div")(2,"div",23),t.nrm(3,"ion-icon",24),t.j41(4,"div")(5,"ion-label",25),t.EFF(6),t.k0s()()()(),t.nrm(7,"div",26),t.k0s()),2&a){const i=t.XpG();t.R7$(3),t.Y8G("name",i.global.useVideo?"videocam-outline":"call-outline"),t.R7$(3),t.JRh(i.webrtc.StatusText||i.lang.text.InstantCall.Waiting)}}const J=[{path:"",component:(()=>{var a;class o{constructor(n,e,l,c,g,u,s,d,m,C,f){this.global=n,this.lang=e,this.webrtc=l,this.title=c,this.nakama=g,this.router=u,this.route=s,this.p5toast=d,this.p5loading=m,this.navCtrl=C,this.floatbutton=f,this.webrtcActId="instcall",this.UserInputCustomAddress="",this.NeedInputCustomAddress=!1,this.isQuickJoin=!1,this.AlreadyExistServer=!1,this.isCustomServer=!1,this.PageOut=!1,this.CallClosed=!1}ngOnInit(){var n=this;this.ServerList=this.nakama.get_all_online_server(),setTimeout(()=>{this.InstantCallServer?(this.InstantCallServer.value=this.ServerList[0]||"local",this.SelectAddressTarget({detail:{value:this.InstantCallServer.value}})):this.NeedInputCustomAddress=!0},0),this.route.queryParams.subscribe(e=>{const l=this.router.getCurrentNavigation().extras.state;l&&(this.UserInputCustomAddress=l.address,this.ChannelId=l.channel,this.Port=l.port,this.signalPort=l.square_port,this.Username=l.username,this.Password=l.password,this.isQuickJoin=l.quick,this.global.useVideo=l.useVideo,this.LinkToServer(!0))}),this.webrtc.StatusText||(this.webrtc.StatusText=this.lang.text.InstantCall.Waiting),this.global.windowOnFocusAct["instant-call"]=()=>{!function(){var l=(0,b.A)(function*(){if(n.global.videoPIP&&n.webrtc.localMedia)try{if(n.PageOut)throw"\ud398\uc774\uc9c0\ub97c \ubc97\uc5b4\ub0a8";yield n.webrtc.localMedia.requestPictureInPicture(),n.webrtc.remoteMedia&&(n.webrtc.remoteMedia.style.width="100%",n.webrtc.remoteMedia.style.height="100%",n.webrtc.remoteMedia.style.objectFit="cover",document.getElementById("instc_remote").appendChild(n.webrtc.remoteMedia))}catch{}});return function(){return l.apply(this,arguments)}}()()},this.global.WindowOnBlurAct["instant-call"]=()=>{!function(){var l=(0,b.A)(function*(){if(n.global.videoPIP&&n.webrtc.remoteMedia)try{yield n.webrtc.remoteMedia.requestPictureInPicture(),n.webrtc.remoteMedia.style.width="0px",n.webrtc.remoteMedia.style.height="0px",n.webrtc.remoteMedia.style.objectFit="none",document.body.appendChild(n.webrtc.remoteMedia)}catch{}});return function(){return l.apply(this,arguments)}}()()}}SelectAddressTarget(n){if("local"===(this.title.setTitle(`Project: ${this.lang.text.InstantCall.Title}`),this.Port=void 0,this.signalPort=void 0,n.detail.value))this.UserInputCustomAddress="",this.NeedInputCustomAddress=!0;else{let e=n.detail.value.info;this.UserInputCustomAddress=`${e.useSSL?"wss":"ws"}://${e.address}`,this.Port=e.webrtc_port,12013!=e.square_port&&(this.signalPort=e.square_port),this.NeedInputCustomAddress=!1}}LinkToServer(n=!1){var e=this;if(this.webrtc.StatusText=this.lang.text.InstantCall.Waiting,S.R.requestAudioRecordingPermission(),n&&!this.ChannelId)return this.p5toast.show({text:this.lang.text.InstantCall.MissingInfo}),void this.navCtrl.pop();let u,l=this.UserInputCustomAddress.split("://"),c=l.pop(),g=l.pop();g||(g=this.global.checkProtocolFromAddress(c)?"wss":"ws"),this.isCustomServer=n||!this.InstantCallServer||"local"==this.InstantCallServer.value,this.isCustomServer&&this.nakama.SaveWebRTCServer({urls:[`stun:${c}:${this.Port||3478}`,`turn:${c}:${this.Port||3478}`],username:this.Username||"username",credential:this.Password||"password"}).then(s=>this.AlreadyExistServer=s),this.global.InstantCallWSClient=new WebSocket(`${g}://${c}:${this.signalPort||12013}`),this.global.InstantCallWSClient.onopen=(0,b.A)(function*(){if(e.global.WaitingConnect=!0,e.p5loading.toast(e.lang.text.InstantCall.Waiting,e.webrtcActId),e.global.useVideo)try{document.pictureInPictureElement&&document.pictureInPictureElement!=e.webrtc.localMedia&&document.exitPictureInPicture(),localStorage.removeItem("VideoInputDev"),localStorage.removeItem("AudioInputDev"),localStorage.removeItem("AudioOutputDev"),e.webrtc.localMedia=document.createElement("video"),e.webrtc.localMedia.id="webrtc_video",e.webrtc.localMedia.style.width="0px",e.webrtc.localMedia.style.height="0px",e.webrtc.localMedia.autoplay=!0,e.webrtc.localMedia.playsInline=!0,e.webrtc.localMedia.muted=!0,e.webrtc.localMedia.style.borderRadius="16px",document.body.appendChild(e.webrtc.localMedia);const s=yield e.webrtc.getMediaConst("video");try{e.webrtc.localStream=yield navigator.mediaDevices.getUserMedia(s)}catch{e.webrtc.localStream=yield navigator.mediaDevices.getDisplayMedia()}e.webrtc.localMedia.srcObject=e.webrtc.localStream,setTimeout(()=>{e.global.videoPIP=!0;const d=function(){var f=(0,b.A)(function*(){try{yield e.webrtc.localMedia.requestPictureInPicture()}catch{e.PageOut||setTimeout(()=>{d()},500)}});return function(){return f.apply(this,arguments)}}();d();let m=!1;const C=()=>{e.webrtc.remoteMedia?(e.webrtc.remoteMedia.style.width="100%",e.webrtc.remoteMedia.style.height="100%",e.webrtc.remoteMedia.style.objectFit="cover",document.getElementById("instc_remote").appendChild(e.webrtc.remoteMedia),m=!0):setTimeout(()=>{!e.PageOut&&!m&&C()},500)};C()},1e3)}catch(s){return console.log("navigator.getUserMedia error: ",s),yield e.webrtc.close_webrtc(e.webrtcActId),e.p5toast.show({text:`${e.lang.text.WebRTCDevManager.InitErr}: ${s}`}),void(e.global.WaitingConnect=!1)}e.ChannelId?(e.global.InstantCallSend(JSON.stringify({type:"join",channel:e.ChannelId,quick:e.isQuickJoin})),yield new Promise(s=>setTimeout(s,e.global.WebsocketRetryTerm)),e.webrtc.StatusText=e.lang.text.InstantCall.Connecting,e.global.PeerConnected=!0,e.webrtc.initialize(e.global.useVideo?"video":"audio",e.webrtcActId).then(()=>{e.webrtc.Peers[e.webrtcActId].HangUpCallBack=()=>{e.global.InstantCallWSClient&&e.global.InstantCallWSClient.close(1e3,"hangup_webrtc")},e.ShowWaiting(),e.webrtc.CreateOffer(e.webrtcActId),e.webrtc.StatusText=e.lang.text.InstantCall.Connecting,e.global.PeerConnected=!0,e.global.InstantCallSend(JSON.stringify({type:"init_req"})),e.global.windowOnFocusAct["instant-call"]()})):e.global.InstantCallSend(JSON.stringify({type:"initInfo",act:"instc",max:2}))}),this.global.InstantCallWSClient.onmessage=s=>{let d=JSON.parse(s.data);if(void 0===u)u=d.uid;else if(u==d.uid)return;switch(d.type){case"leave":this.global.InstantCallWSClient.close(1e3,"leave_pair");break;case"init_id":const m=d.socketId;this.global.InstantCallSend(JSON.stringify({type:"join",channel:d.id,customInput:this.NeedInputCustomAddress})),this.ChannelId=d.id,this.global.GetHeaderAddress().then(C=>{this.QRCodeAsString=`${C}?token=${this.UserInputCustomAddress},${12013==this.Port?"":this.Port||""},${d.socketId}`,this.QRCodeSRC=this.global.readasQRCodeFromString(this.QRCodeAsString),this.global.InstantCallSend(JSON.stringify({type:"update_reqInfo",socketId:m,keys:["channel_id","port","username","password","useVideo"],channel_id:this.ChannelId,port:this.Port,username:this.Username,password:this.Password,useVideo:this.global.useVideo}))});break;case"expired":setTimeout(()=>{this.global.InstantCallWSClient.close(1e3,"expired")},500);break;case"block":console.warn("\uc774\ubbf8 \uc5f0\uacb0\ub41c \ud1b5\ud654\uac00 \uc788\uc74c"),this.global.InstantCallWSClient.close(1e3,"block");break;case"init_req":this.webrtc.StatusText=this.lang.text.InstantCall.Connecting,this.global.PeerConnected=!0,this.webrtc.initialize(this.global.useVideo?"video":"audio",this.webrtcActId).then((0,b.A)(function*(){e.webrtc.Peers[e.webrtcActId].HangUpCallBack=()=>{e.global.InstantCallWSClient&&e.global.InstantCallWSClient.close(1e3,"hangup_callback")},e.ShowWaiting(),e.webrtc.CreateOffer(e.webrtcActId),yield new Promise(C=>setTimeout(C,e.global.WebsocketRetryTerm)),e.global.InstantCallSend(JSON.stringify({type:"socket_react",channel:e.ChannelId,act:"WEBRTC_INIT_REQ_SIGNAL"})),e.global.windowOnFocusAct["instant-call"]()}));break;case"socket_react":switch(d.act){case"WEBRTC_REPLY_INIT_SIGNAL":this.webrtc.WEBRTC_REPLY_INIT_SIGNAL(d.data_str,{client:this.global.InstantCallWSClient,channel:this.ChannelId},this.webrtcActId),"EOL"==d.data_str&&this.webrtc.CreateAnswer({client:this.global.InstantCallWSClient,channel:this.ChannelId},this.webrtcActId);break;case"WEBRTC_REPLY_INIT_SIGNAL_PART":this.webrtc.WEBRTC_REPLY_INIT_SIGNAL_PART({client:this.global.InstantCallWSClient,channel:this.ChannelId},this.webrtcActId);break;case"WEBRTC_ICE_CANDIDATES":this.webrtc.WEBRTC_ICE_CANDIDATES(d.data_str,{client:this.global.InstantCallWSClient,channel:this.ChannelId},this.webrtcActId),this.global.InstantCallSend(JSON.stringify({type:"init_end",channel:this.ChannelId})),this.global.InitEnd=!0,this.webrtc.StatusText=this.lang.text.InstantCall.Connected;break;case"WEBRTC_INIT_REQ_SIGNAL":this.webrtc.WEBRTC_INIT_REQ_SIGNAL({client:this.global.InstantCallWSClient,channel:this.ChannelId},this.webrtcActId);break;case"WEBRTC_RECEIVE_ANSWER":this.webrtc.WEBRTC_RECEIVE_ANSWER(d.data_str,{client:this.global.InstantCallWSClient,channel:this.ChannelId},this.webrtcActId)}break;case"init_end":this.global.InitEnd=!0,this.webrtc.StatusText=this.lang.text.InstantCall.Connected}},this.global.InstantCallWSClient.onerror=s=>{console.error("\uc989\uc11d \ud1b5\ud654 \uc6f9\uc18c\ucf13 \uc624\ub958: ",s),this.global.InstantCallWSClient.close(1e3,"error")},this.global.InstantCallWSClient.onclose=s=>{this.p5toast.show("expired"==s.reason?{text:this.lang.text.InstantCall.ExpiredChannel}:{text:this.lang.text.InstantCall.CallEnd}),this.global.videoPIP&&document.pictureInPictureElement&&document.exitPictureInPicture(),this.global.videoPIP=!1,this.floatbutton.RemoveFloatButton("instant-call"),this.global.WaitingConnect=!1,this.global.InitEnd=!1,this.global.PeerConnected=!1,this.global.InstantCallWSClient.onopen=null,this.global.InstantCallWSClient.onclose=null,this.global.InstantCallWSClient.onmessage=null,this.global.InstantCallWSClient.onerror=null,this.global.InstantCallWSClient=null,this.webrtc.close_webrtc(this.webrtcActId),this.CallClosed=!0,this.PageOut||this.navCtrl.pop()}}OpenDevManager(){var n=this;return(0,b.A)(function*(){let e=yield n.webrtc.getDeviceList();n.global.PageDismissAct["webrtc-manage"]=function(){var l=(0,b.A)(function*(c){try{var g;let u={};n.global.useVideo&&c.data.videoinput&&(u.video={deviceId:{exact:c.data.videoinput.deviceId}}),c.data.audioinput&&(u.audio={deviceId:{exact:c.data.audioinput.deviceId}}),n.webrtc.localStream.getTracks().forEach(s=>s.stop()),n.webrtc.localStream=n.global.useVideo&&null!==(g=c.data.videoinput)&&void 0!==g&&g.useScr?yield navigator.mediaDevices.getDisplayMedia():yield navigator.mediaDevices.getUserMedia(u),n.webrtc.localMedia.srcObject=n.webrtc.localStream,n.webrtc.Peers[n.webrtcActId].PeerConnection.getSenders().forEach(s=>{s.track&&s.replaceTrack(n.webrtc.localStream.getTracks()[0])}),n.webrtc.CreateOffer(n.webrtcActId)}catch(u){console.log("\ubbf8\ub514\uc5b4 \uc2a4\ud2b8\ub9bc \ubcc0\uacbd \uc624\ub958: ",u)}n.global.RestoreShortCutAct("webrtc-manage"),delete n.global.PageDismissAct["webrtc-manage"]});return function(c){return l.apply(this,arguments)}}(),n.global.StoreShortCutAct("webrtc-manage"),n.global.ActLikeModal("webrtc-manage-io-dev",{list:JSON.parse(JSON.stringify(e)),typein:n.global.useVideo?"video":"audio",dismiss:"webrtc-manage"})})()}copy_qr_address(n=this.QRCodeAsString){this.global.WriteValueToClipboard("text/plain",n)}ShowWaiting(){this.QRCodeSRC=void 0,this.QRCodeAsString="",!this.p5canvas&&(this.p5canvas=new P(n=>{let e=document.getElementById("InstantCallCanvasDiv"),l=1;n.setup=()=>{n.pixelDensity(1),n.createCanvas(e.clientWidth,e.clientHeight).parent(e),n.noStroke()};class c{constructor(){this.color={r:0,g:0,b:0},this.size=1,this.targetSize=100,this.opacity=200,this.pos=n.createVector(0,0),this.dir=n.createVector(n.random(-1.4,1.4),n.random(-2,-4)),this.color.r=n.random(0,255),this.color.g=n.random(0,255),this.color.b=n.random(0,255),this.targetSize=n.random(80,150)}display(){this.size<this.targetSize&&(this.size+=6),this.size>this.targetSize&&(this.size=this.targetSize),n.push(),n.fill(this.color.r,this.color.g,this.color.b,this.opacity),n.circle(this.pos.x,this.pos.y,this.size*l),n.pop(),this.pos.add(this.dir),this.dir.y+=.04,this.opacity-=1}}let g=[],u=!0;n.draw=()=>{u&&(g.push(new c),u=!1,setTimeout(()=>{u=!0},500)),n.clear(),n.push(),n.translate(n.width/2,n.height/2);for(let s=g.length-1;s>=0;s--)g[s].display(),g[s].opacity<=0&&g.splice(s,1);n.pop(),this.global.InitEnd&&(l-=.02),l<=0&&n.remove()},n.windowResized=()=>{n.resizeCanvas(e.clientWidth,e.clientHeight)}}))}ionViewWillEnter(){this.floatbutton.RemoveFloatButton("instant-call"),this.PageOut=!1,this.p5canvas&&this.p5canvas.windowResized(),this.global.StoreShortCutAct("instant-call"),this.global.p5KeyShortCut.Escape=()=>{this.navCtrl.pop()},this.CallClosed&&this.navCtrl.pop(),this.global.videoPIP&&this.webrtc.localMedia&&this.webrtc.localMedia.requestPictureInPicture(),this.webrtc.remoteMedia&&(this.webrtc.remoteMedia.style.width="100%",this.webrtc.remoteMedia.style.height="100%",this.webrtc.remoteMedia.style.objectFit="cover",document.getElementById("instc_remote").appendChild(this.webrtc.remoteMedia))}ionViewWillLeave(){if(this.title.setTitle("Project: Cone"),this.PageOut=!0,this.global.WaitingConnect||this.global.InitEnd){let n=this.floatbutton.AddFloatButton("instant-call","call-outline");null==n||n.mouseClicked(()=>{this.global.SelectArcadeTab(),this.navCtrl.navigateForward("portal/arcade/instant-call",{animation:w.NC})})}this.webrtc.remoteMedia&&(this.global.videoPIP&&this.webrtc.remoteMedia.requestPictureInPicture(),this.webrtc.remoteMedia.style.width="0px",this.webrtc.remoteMedia.style.height="0px",this.webrtc.remoteMedia.style.objectFit="none",document.body.appendChild(this.webrtc.remoteMedia)),delete this.global.p5KeyShortCut.Escape,this.global.RestoreShortCutAct("instant-call")}ngOnDestroy(){this.p5canvas&&this.p5canvas.remove(),this.isCustomServer&&!this.AlreadyExistServer&&this.nakama.RemoveWebRTCServer(this.UserInputCustomAddress.split("://").pop()),!this.global.InitEnd&&!this.global.PeerConnected&&this.global.InstantCallWSClient&&this.global.InstantCallWSClient.close(1e3),this.route.queryParams.unsubscribe(),delete this.global.windowOnFocusAct["instant-call"],delete this.global.WindowOnBlurAct["instant-call"]}}return(a=o).\u0275fac=function(n){return new(n||a)(t.rXU(R.z3),t.rXU(y.y),t.rXU(x.j),t.rXU(A.hE),t.rXU(M.X),t.rXU(I.Ix),t.rXU(I.nX),t.rXU(T.G),t.rXU(W.f),t.rXU(E.q9),t.rXU(k.u))},a.\u0275cmp=t.VBU({type:a,selectors:[["app-instant-call"]],viewQuery:function(n,e){if(1&n&&t.GBs(j,5),2&n){let l;t.mGM(l=t.lsd())&&(e.InstantCallServer=l.first)}},decls:11,vars:5,consts:[["InstantCallServer",""],[1,"ion-no-border"],["slot","start"],["defaultHref","portal/arcade"],["id","InstantCallCanvasDiv","style","position: absolute; width: 100%; height: 100%; overflow: hidden; pointer-events: none;",4,"ngIf"],["style","flex: 0 1 auto;",4,"ngIf"],[4,"ngIf"],["id","InstantCallCanvasDiv",2,"position","absolute","width","100%","height","100%","overflow","hidden","pointer-events","none"],[2,"flex","0 1 auto"],["button",""],[2,"pointer-events","none",3,"ngModelChange","ngModel"],["button","",3,"click"],[1,"ion-text-center"],["value","local",2,"pointer-events","none",3,"ionChange","label"],["value","local"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","(wss://)0.0.0.0",1,"ion-text-right",3,"ngModelChange","label","ngModel"],["slot","end","name","open-outline",3,"click"],[1,"ion-text-right",3,"ngModelChange","label","ngModel","placeholder"],["style","width: 100%; height: auto; cursor: copy;","alt","QRCode",3,"src","click",4,"ngIf"],["color","secondary",1,"ion-text-center"],["alt","QRCode",2,"width","100%","height","auto","cursor","copy",3,"click","src"],[1,"disconnect_info"],["color","medium",2,"width","60px","height","60px",3,"name"],["color","medium"],["id","instc_remote",2,"position","absolute","display","flex","width","100%","height","100%"]],template:function(n,e){1&n&&(t.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.k0s(),t.j41(4,"ion-buttons",2),t.nrm(5,"ion-back-button",3),t.k0s()()(),t.j41(6,"ion-content"),t.DNE(7,G,1,0,"div",4)(8,X,13,9,"div",5)(9,Y,8,3,"div",6)(10,Q,8,2,"div",6),t.k0s()),2&n&&(t.R7$(3),t.JRh(e.lang.text.InstantCall.Title),t.R7$(4),t.Y8G("ngIf",e.global.WaitingConnect),t.R7$(),t.Y8G("ngIf",!e.global.WaitingConnect),t.R7$(),t.Y8G("ngIf",e.QRCodeAsString&&e.global.WaitingConnect),t.R7$(),t.Y8G("ngIf",!e.QRCodeAsString&&(e.global.WaitingConnect||e.global.InitEnd)))},dependencies:[p.Sq,p.bT,_.BC,_.vS,h.QW,h.W9,h.eU,h.iq,h.$w,h.uz,h.he,h.Nm,h.Ip,h.BC,h.BY,h.ai,h.hB,h.Je,h.Gw,h.el],styles:["ion-input[_ngcontent-%COMP%]{--highlight-color-valid: var(--ion-color-primary)}"]}),o})()}];let L=(()=>{var a;class o{}return(a=o).\u0275fac=function(n){return new(n||a)},a.\u0275mod=t.$C({type:a}),a.\u0275inj=t.G2t({imports:[I.iI.forChild(J),I.iI]}),o})(),z=(()=>{var a;class o{}return(a=o).\u0275fac=function(n){return new(n||a)},a.\u0275mod=t.$C({type:a}),a.\u0275inj=t.G2t({imports:[p.MD,_.YN,h.bv,L]}),o})()}}]);