"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[887],{887:(Me,te,y)=>{y.r(te),y.d(te,{MainPageModule:()=>Ae});var K=y(177),fe=y(4341),E=y(5374),ie=y(9858),M=y(467),$=y(482),pe=y(92),oe=y(8326),be=y(617),t=y(3953),ye=y(4234),Ce=y(4237),ve=y(8065),_e=y(755);function Te(d,b){1&d&&t.nrm(0,"ion-icon",12)}function Pe(d,b){1&d&&t.nrm(0,"ion-icon",13)}function Se(d,b){1&d&&(t.j41(0,"div",14),t.EFF(1,"A"),t.k0s())}function je(d,b){if(1&d){const u=t.RV6();t.j41(0,"div")(1,"div",15),t.bIt("click",function(){t.eBV(u);const g=t.XpG();return t.Njj(g.nakama.open_add_todo_page())}),t.nrm(2,"ion-icon",16),t.j41(3,"div")(4,"ion-label",17),t.EFF(5),t.k0s()()()()}if(2&d){const u=t.XpG();t.R7$(5),t.JRh(u.lang.text.Main.NoTodo)}}function xe(d,b){1&d&&(t.j41(0,"div",22),t.EFF(1,"`"),t.k0s())}function ke(d,b){if(1&d&&(t.j41(0,"div",22),t.EFF(1),t.k0s()),2&d){const u=t.XpG().index;t.R7$(),t.JRh(u+1)}}function Fe(d,b){if(1&d){const u=t.RV6();t.j41(0,"button",19),t.bIt("click",function(){const g=t.eBV(u).$implicit,e=t.XpG(2);return t.Njj(e.ChangeFilterValue(g.value))}),t.DNE(1,ke,2,1,"div",20),t.EFF(2),t.k0s()}if(2&d){const u=b.$implicit,c=t.XpG(2);t.Aen("background-color: "+(u.color||"#8888")),t.R7$(),t.Y8G("ngIf",c.global.ShowHint),t.R7$(),t.SpI(" ",c.lang.text.TodoDetail[u.name]," ")}}function Ie(d,b){if(1&d){const u=t.RV6();t.j41(0,"div",18)(1,"button",19),t.bIt("click",function(){t.eBV(u);const g=t.XpG();return t.Njj(g.SwitchTargetFilter())}),t.DNE(2,xe,2,0,"div",20),t.EFF(3),t.k0s(),t.DNE(4,Fe,3,4,"button",21),t.k0s()}if(2&d){const u=t.XpG();t.R7$(2),t.Y8G("ngIf",u.global.ShowHint),t.R7$(),t.SpI(" ",u.lang.text.TodoDetail[u.TargetFilterDisplayName]," "),t.R7$(),t.Y8G("ngForOf",u.AllCategories[u.TargetFilterName])}}var C=function(d){return d[d.None=0]="None",d[d.Importance=1]="Importance",d[d.Color=2]="Color",d[d.Creator=3]="Creator",d}(C||{});const Ee=[{path:"",component:(()=>{var d;class b{constructor(c,g,e,H,a,l){this.global=c,this.lang=g,this.nakama=e,this.statusBar=H,this.indexed=a,this.alertCtrl=l,this.isPlayingCanvas={loop:!0},this.TargetFilterDisplayName="FilterCat_0",this.TargetFilterName=0,this.AllCategories={},this.CurrentFilterValue=null,this.isEmptyTodo=!1}ngOnInit(){this.global.PortalBottonTabAct.Todo=()=>{this.ViewInitFunc&&this.ViewInitFunc()}}toggle_session(){this.nakama.toggle_all_session(),this.global.p5todo.redraw()}toggleCanvasPlaying(){this.isPlayingCanvas.loop=!this.isPlayingCanvas.loop,this.isPlayingCanvas.loop?this.global.p5todo.loop():this.global.p5todo.noLoop()}SwitchTargetFilter(c){switch(this.TargetFilterName=null!=c?c:(this.TargetFilterName+1)%4,this.TargetFilterName){case C.None:this.TargetFilterDisplayName="FilterCat_0";break;case C.Importance:this.TargetFilterDisplayName="Importance";break;case C.Color:this.TargetFilterDisplayName="CustomColor";break;case C.Creator:this.TargetFilterDisplayName="FilterByCreator"}this.CurrentFilterValue=null,this.global.p5FilteringTodos&&this.global.p5FilteringTodos(C.None,this.TargetFilterDisplayName)}ChangeFilterValue(c){this.CurrentFilterValue=this.CurrentFilterValue==c?null:c,this.global.p5FilteringTodos()}CreateTodoManager(){var c=this;setTimeout(()=>{"DesktopPWA"!=pe.aH&&this.toggleCanvasPlaying()},8e3);let g=document.getElementById("todo");this.global.p5todo&&this.global.p5todo.remove(),this.global.p5todo=new oe(e=>{let v,J,Y,ae,H=this.statusBar,a={},l=[],V=[],B=[],w=e.createVector(0,0),Z=e.createVector(0,0),m=e.createVector(0,0),f=1,j=e.createVector(0,0),X=this.nakama,se=this.indexed,k=[],S=!1,U=this.isPlayingCanvas;e.setup=(0,M.A)(function*(){let r=e.createCanvas(g.clientWidth,g.clientHeight);r.parent(g),r.id("p5todo"),r.elt.oncontextmenu=function(){var s=(0,M.A)(function*(o){for(let n=0,h=l.length;n<h;n++)if("AddButton"!=a[l[n]].json.id&&a[l[n]].position.dist(I(o.offsetX,o.offsetY))<a[l[n]].EllipseSize/2){let A="";try{let P;try{P=`todo/${a[l[n]].json.id}_${a[l[n]].json.remote.isOfficial}_${a[l[n]].json.remote.target}/thumbnail.png`}catch{P=`todo/${a[l[n]].json.id}/thumbnail.png`}let G=yield se.loadBlobFromUserPath(P,"image/png"),me=URL.createObjectURL(G);A=`<div style="text-align: center"><img src="${me}" alt="todo_image" style="border-radius: 2px"></div>`,setTimeout(()=>{URL.revokeObjectURL(me)},100)}catch{}c.alertCtrl.create({header:a[l[n]].json.title,message:new be.Vk(A+`<div>${a[l[n]].json.description||""}</div>`),buttons:[{text:c.lang.text.TodoDetail.TodoComplete,handler:function(){var P=(0,M.A)(function*(){try{yield X.doneTodo(a[l[n]].json)}catch{}});return function(){return P.apply(this,arguments)}}()},{text:c.lang.text.TodoDetail.remove,cssClass:"redfont",handler:function(){var P=(0,M.A)(function*(){try{yield X.deleteTodoFromStorage(!0,a[l[n]].json)}catch{}});return function(){return P.apply(this,arguments)}}()}]}).then(P=>{ue(),P.onDidDismiss().then(()=>{S=!1}),S=!0,P.present()});break}});return function(o){return s.apply(this,arguments)}}(),e.smooth(),e.noStroke(),e.pixelDensity(1),e.ellipseMode(e.CENTER),e.rectMode(e.CENTER),e.textAlign(e.CENTER,e.CENTER),e.textSize(20),e.textLeading(28),e.textWrap(e.CHAR),e.imageMode(e.CENTER);let i=Number(localStorage.getItem("p5todoScale")||1);Re(),c.ViewInitFunc=q,f=i,localStorage.setItem("p5todoScale",`${f}`),c.global.p5todoStopCanvas=()=>{S=!0,c.isPlayingCanvas.loop||e.noLoop()},c.global.p5todoPlayCanvas=()=>{S=!1,e.windowResized(),c.isPlayingCanvas.loop&&e.loop()},c.global.p5todoAddtodo=s=>{let o=JSON.parse(s),n=o.id;if(o.remote&&(n+=`_${o.remote.isOfficial}_${o.remote.target}`),!o.removed){if(o.done){for(let h=0,T=l.length;h<T;h++)if(l[h]==n)return void a[l[h]].makeDone()}else a[n]?(a[n].json=o,a[n].initialize()):a[n]=new re(o);c.isPlayingCanvas.loop||(J=a[n],e.loop()),Y()}},Y=()=>{l=Object.keys(a),c.isEmptyTodo=!l.length,c.isEmptyTodo||(a.AddButton?1==l.length&&a.AddButton.makeDone():(a.AddButton=new re("",!0),l=Object.keys(a)))},c.global.p5removeTodo=s=>{let o=JSON.parse(s),n=o.id;o.remote&&(n+=`_${o.remote.isOfficial}_${o.remote.target}`);for(let h=0,T=l.length;h<T;h++)if(l[h]==n){a[l[h]].RemoveTodo();break}c.isEmptyTodo=!Object.keys(l).length,Y(),e.redraw()},ae=function(){var s=(0,M.A)(function*(){a={},l.length=0;let o=yield c.indexed.GetFileListFromDB("todo/");for(let n=0,h=o.length;n<h;n++)if(o[n].indexOf("/info.todo")>=0){let T=yield c.indexed.loadTextFromUserPath(o[n]);c.global.p5todoAddtodo(T)}c.isEmptyTodo=!Object.keys(l).length});return function(){return s.apply(this,arguments)}}(),ae(),c.SwitchTargetFilter(c.TargetFilterName),c.AllCategories[C.None]=[],c.AllCategories[C.Importance]=[{name:"Importance_0",color:"#58a19288",value:"0"},{name:"Importance_1",color:"#ddbb4188",value:"1"},{name:"Importance_2",color:"#b9543788",value:"2"}],c.AllCategories[C.Color]=[{name:"ColorFilterRed",color:"#ff000088",value:[-30,30]},{name:"ColorFilterYellow",color:"#ffff0088",value:[30,90]},{name:"ColorFilterGreen",color:"#00ff0088",value:[90,150]},{name:"ColorFilterCyan",color:"#00ffff88",value:[150,210]},{name:"ColorFilterBlue",color:"#0000ff88",value:[210,270]},{name:"ColorFilterMagenta",color:"#ff00ff88",value:[270,330]}],c.AllCategories[C.Creator]=[{name:"CreatorLocal",color:"#bbbbbb88",value:"local"},{name:"CreatorMe",color:"#00ff0088",value:"server"},{name:"Requested",color:"#6789ab88",value:"worker"},{name:"CreatorOther",color:"#ba987688",value:"other"}],c.global.p5FilteringTodos=Q});let ne,Q=(r,i)=>{switch(i&&(ne=i),null!=r?r:this.TargetFilterName){case C.None:for(let o=0,n=l.length;o<n;o++)a[l[o]].isHidden=!1;break;case C.Importance:if(this.CurrentFilterValue)for(let o=0,n=l.length;o<n;o++)a[l[o]].isHidden="AddButton"!=a[l[o]].json.id&&a[l[o]].json.importance!=this.CurrentFilterValue;else Q(C.None);break;case C.Color:for(let o=0,n=l.length;o<n;o++){let h;e.push(),e.colorMode(e.HSB);try{h=e.color(a[l[o]].json.custom_color)}catch{}if(!h)switch(a[l[o]].json.importance){case"0":h=e.color("#58a192");break;case"1":h=e.color("#ddbb41");break;case"2":h=e.color("#b95437")}if(e.pop(),this.CurrentFilterValue){if(h){let T=(360+this.CurrentFilterValue[0])%360,A=(360+this.CurrentFilterValue[1])%360,R=e.hue(h);a[l[o]].isHidden=T<A?!(T<R&&R<A):A<R&&R<T}}else a[l[o]].isHidden=!1}break;case C.Creator:if(this.CurrentFilterValue)for(let o=0,n=l.length;o<n;o++)if("AddButton"==a[l[o]].json.id)a[l[o]].isHidden=!1;else switch(this.CurrentFilterValue){case"local":a[l[o]].isHidden=a[l[o]].json.storeAt!=this.CurrentFilterValue;break;case"server":a[l[o]].isHidden=void 0===a[l[o]].json.remote;break;case"worker":a[l[o]].isHidden=!(void 0!==a[l[o]].json.workers&&a[l[o]].json.is_me);break;case"other":a[l[o]].isHidden=a[l[o]].json.is_me||"local"==a[l[o]].json.storeAt}else Q(C.None)}e.redraw()},Re=()=>{j.x=e.width/2,j.y=e.height/2,m.x=0,m.y=0,f=1,localStorage.setItem("p5todoScale",`${f}`),this.isPlayingCanvas.loop||e.redraw()},p={Act:!1,lerp:0,Scale:e.createVector(),CamPos:e.createVector(),CamScale:0},q=()=>{p.Act=!0,p.Scale.x=j.x,p.Scale.y=j.y,p.CamPos.x=m.x,p.CamPos.y=m.y,p.CamScale=f,this.isPlayingCanvas.loop||e.loop()};e.draw=()=>{e.clear(255,255,255,255),e.push(),e.translate(j),e.scale(f),e.translate(m);for(let r=0,i=l.length;r<i;r++)a[l[r]].display();for(let r=B.length-1;r>=0;r--)B[r].display(),B[r].lifeTime<0&&B.splice(r,1);for(let r=V.length-1;r>=0;r--)V[r].DoneAnim();e.pop(),this.isPlayingCanvas.loop&&(Z.x=40*-e.accelerationX,Z.y=40*e.accelerationY),p.Act&&(p.lerp+=.07,j.x=e.lerp(p.Scale.x,e.width/2,D(p.lerp)),j.y=e.lerp(p.Scale.y,e.height/2,D(p.lerp)),m.x=e.lerp(p.CamPos.x,0,D(p.lerp)),m.y=e.lerp(p.CamPos.y,0,D(p.lerp)),f=e.lerp(p.CamScale,1,D(p.lerp)),localStorage.setItem("p5todoScale",`${f}`),p.lerp>=1&&(p.Act=!1,p.lerp=0,j.x=e.width/2,j.y=e.height/2,m.x=0,m.y=0,f=1,localStorage.setItem("p5todoScale",`${f}`),this.isPlayingCanvas.loop||e.noLoop()))};let D=r=>e.sin(r*e.PI/2);e.windowResized=()=>{S||setTimeout(()=>{let r=m.x/e.width,i=m.y/e.height;e.resizeCanvas(g.clientWidth,g.clientHeight),j.x=e.width/2,j.y=e.height/2,m.x=r*e.width,m.y=i*e.height},50)};let N=!0;class re{constructor(i,s=!1){this.isAddButton=!1,this.EllipseSize=96,this.Velocity=e.createVector(0,0),this.Accel=e.createVector(0,0),this.isGrabbed=!1,this.TextColor=e.color($.ud?255:0),this.ProgressWeight=8,this.LerpProgress=0,this.isHidden=!1,this.LifeTime=1,this.json=i;let o=e.max(e.width,e.height)||1,n=e.createVector(o/e.min(1,f),0).setHeading(e.random(-e.PI,e.PI));if(s)return this.isAddButton=s,this.position=w.copy(),this.defaultColor=e.color($.ud?"#bbb":"#888"),void(this.json={id:"AddButton",written:0,limit:1,longSide:53,shortSide:11});this.position=n,this.initialize()}initialize(){if(!this.json.custom_color)switch(this.json.importance){case"0":this.defaultColor=e.color("#58a192");break;case"1":this.defaultColor=e.color("#ddbb41");break;case"2":this.defaultColor=e.color("#b95437")}let s,i=Number(this.json.importance);switch(i){case 0:this.EllipseSize=96;break;case 1:this.EllipseSize=104;break;case 2:this.EllipseSize=112}if(!k[i]){k[i]=e.createImage(this.EllipseSize,this.EllipseSize),k[i].loadPixels();let o=e.createVector(k[i].width/2,k[i].height/2);for(let n=0,h=k[i].height;n<h;n++)for(let T=0,A=k[i].width;T<A;T++){let R=e.createVector(T,n);o.dist(R)<this.EllipseSize/2-1&&k[i].set(T,n,e.color(255,80))}k[i].updatePixels()}try{s=`todo/${this.json.id}_${this.json.remote.isOfficial}_${this.json.remote.target}/thumbnail.png`}catch{s=`todo/${this.json.id}/thumbnail.png`}se.loadBlobFromUserPath(s,"").then(o=>{let n=URL.createObjectURL(o);e.loadImage(n,h=>{this.ThumbnailImage=h,this.ThumbnailImage.mask(k[i]),URL.revokeObjectURL(n)})}).catch(o=>{this.ThumbnailImage=null})}display(){if(e.push(),this.isGrabbed||(this.CalcPosition(),this.OnCollider(),this.position=this.position.add(this.Velocity)),e.translate(this.position),this.LerpProgress=e.map(Date.now(),this.json.startFrom||this.json.written,this.json.limit,0,1,!0),(this.isAddButton||this.json.written>this.json.limit)&&(this.LerpProgress=1),this.isHidden?e.fill(128,40):e.fill("FilterByCreator"==ne&&this.json.remote?H.colors[H.groupServer[this.json.remote.isOfficial][this.json.remote.target]||"offline"]+e.hex(e.floor(e.lerp(34,96,this.LerpProgress)),2):(this.json.custom_color||this.defaultColor.toString("#rrggbb"))+e.hex(e.floor(e.lerp(34,96,this.LerpProgress)),2)),e.ellipse(0,0,this.EllipseSize,this.EllipseSize),!this.isHidden&&this.ThumbnailImage&&e.image(this.ThumbnailImage,0,0,this.EllipseSize,this.EllipseSize),e.push(),!this.isHidden){e.noFill(),this.isAddButton?(e.push(),e.noStroke(),e.fill(255),e.rect(0,0,this.json.shortSide,this.json.longSide),e.rect(0,0,this.json.longSide,this.json.shortSide),e.pop()):(e.stroke(this.json.custom_color||this.defaultColor),e.strokeWeight(this.ProgressWeight)),e.rotate(-e.PI/2);let i=this.EllipseSize-this.ProgressWeight;this.LerpProgress<1?e.arc(0,0,i,i,0,this.LerpProgress*e.TWO_PI):e.circle(0,0,i)}if(e.pop(),!this.isHidden){let i=.9*this.EllipseSize;this.TextColor=e.color($.ud?255:0,0==this.LerpProgress?128:255),e.fill(this.TextColor),e.text(this.json.title,0,0,i,i)}e.pop()}CalcPosition(){let i=this.position.dist(w),s=e.map(i,0,this.EllipseSize/8,0,1,!0),o=e.map(s,this.EllipseSize/4,0,1,.95,!0);this.Accel.x=s,this.Accel.y=0;let n=this.position.copy().sub(Z).heading()-e.PI;this.Accel=this.Accel.setHeading(n),this.Velocity.add(this.Accel).mult(o)}OnCollider(){for(let i=0,s=l.length;i<s;i++)if(a[l[i]]!=this){let o=a[l[i]],n=this.position.dist(o.position),h=this.EllipseSize/2+o.EllipseSize/2;n<h&&(U.loop||J==this&&(J=null,e.noLoop()),this.ReflectBounce(o,n/h),o.ReflectBounce(this,n/h))}}ReflectBounce(i,s){let o=oe.Vector.sub(this.position,i.position);this.Velocity.add(o.mult(1-s)).mult(.85)}makeDone(){var i=this;return(0,M.A)(function*(){i.LifeTime=1,yield new Promise(s=>setTimeout(s,500)),i.Velocity=w.copy(),i.Accel=w.copy(),i.OriginalEllipseSize=i.EllipseSize,i.OriginalProgWeight=i.ProgressWeight,i.json.done=!0,V.push(i),U.loop||e.loop()})()}DoneAnim(){var i=this;return(0,M.A)(function*(){if(U.loop||e.loop(),i.LifeTime-=.04,i.EllipseSize=i.OriginalEllipseSize*i.LifeTime,i.ProgressWeight=i.OriginalProgWeight*i.LifeTime,i.LifeTime<.5&&B.push(new ce(i.position,i.json.custom_color||i.defaultColor)),i.TextColor=e.color($.ud?255:0,(0==i.LerpProgress?128:255)*i.LifeTime),i.isAddButton&&(i.json.longSide*=i.LifeTime,i.json.shortSide*=i.LifeTime),i.LifeTime<0){U.loop||setTimeout(()=>e.noLoop(),1e3),i.RemoveTodo(),Y();for(let s=0;s<20;s++)B.push(new ce(i.position,i.json.custom_color||i.defaultColor))}})()}Clicked(){N&&!S&&!this.json.done&&(this.isAddButton?X.open_add_todo_page():X.open_add_todo_page(JSON.stringify(this.json)))}RemoveTodo(){let i=this.json.id;this.json.remote&&(i+=`_${this.json.remote.isOfficial}_${this.json.remote.target}`);for(let s=0,o=l.length;s<o;s++)if(l[s]==i){l.splice(s,1);break}for(let s=0,o=V.length;s<o;s++)if(V[s]=this){V.splice(s,1);break}delete a[i]}}class ce{constructor(i,s){this.RectSize=4,this.rotate=0,this.pos=i.copy(),e.randomSeed(e.random(-255,255)),this.lifeTime=e.random(180,255),this.vel=e.createVector(e.random(-75,75),e.random(-40,-80)),this.acc=e.createVector(0,e.random(-1,-3)),e.push(),e.colorMode(e.HSB);let o=e.hue(s),n=e.saturation(s),h=e.brightness(s);this.color=e.color(e.random(o-20,o+20),e.random(n-20,n+20),e.random(h-20,h+20),this.lifeTime/255),e.pop(),this.RectSize=e.random(3,4),this.rotate=e.random(-e.PI,e.PI)}display(){this.color.setAlpha(this.lifeTime/255),e.fill(this.color),this.CalcPhysics(),e.push(),e.translate(this.pos),e.rotate(this.rotate),e.rect(0,0,this.RectSize,this.RectSize),e.pop(),this.lifeTime--}CalcPhysics(){this.acc.y+=.07,this.vel.add(this.acc),this.pos.add(this.vel.copy().div(100))}}let W,x,de,F,ee=0;e.mousePressed=r=>{let i=r.target==document.getElementById("p5todo");if(!S&&i)switch(N=!0,r.which){case 1:x=e.createVector(e.mouseX,e.mouseY),F=m.copy(),W=e.createVector(e.mouseX,e.mouseY);for(let s=0,o=l.length;s<o;s++)if(a[l[s]].position.dist(I())<a[l[s]].EllipseSize/2){a[l[s]].isGrabbed=!0,v=a[l[s]],x=I();break}break;case 2:q()}},e.mouseDragged=r=>{let i=r.target==document.getElementById("p5todo");if(!S&&i&&1===(this.isPlayingCanvas.loop||e.redraw(),r.which))try{W=e.createVector(e.mouseX,e.mouseY);let s=0;v?(v.position=I(),s=x.dist(I())):(m=F.copy().add(W.sub(x).div(f)),s=F.dist(m)),s>15&&(N=!1)}catch{}},e.mouseReleased=r=>{let i=r.target==document.getElementById("p5todo");!S&&i&&1===r.which&&(W=null,ge())};let I=(r,i)=>{let s=e.createVector(r||e.mouseX,i||e.mouseY);return s.sub(j),s.div(f),s.sub(m),s};e.mouseWheel=r=>{let i=r.target==document.getElementById("p5todo");!S&&i&&(this.isPlayingCanvas.loop||e.redraw(),f*=r.deltaY<0?1.1:.9,localStorage.setItem("p5todoScale",`${f}`))};let _=[],O=!1;const L=56;e.touchStarted=r=>{let i=r.target==document.getElementById("p5todo");if(!S&&i)switch(N=!0,_=r.touches,O=!0,_.length){case 1:he();break;case 2:let s=e.createVector(_[0].clientX,_[0].clientY-L),o=e.createVector(_[1].clientX,_[1].clientY-L);N=!1,ee=s.dist(o),x=s.copy().add(o).div(2),F=m.copy(),de=f,v&&(v.isGrabbed=!1,v.Velocity=w.copy(),v.Accel=w.copy(),v=null);break;default:O=!1,q()}},e.touchMoved=r=>{let i=r.target==document.getElementById("p5todo");if(!S&&i){switch(this.isPlayingCanvas.loop||e.redraw(),_=r.touches,_.length){case 1:{if(!O)return;let s=r.changedTouches[0],o=e.createVector(s.clientX,s.clientY-L),n=0;v?(v.position=I(),n=x.dist(I(o.x,o.y))):(m=F.copy().add(o.sub(x).div(f)),n=F.dist(m)),n>15&&(N=!1)}break;case 2:{if(!O)return;let s=e.createVector(_[0].clientX,_[0].clientY-L),o=e.createVector(_[1].clientX,_[1].clientY-L),n=s.copy().add(o).div(2);f=s.dist(o)/ee*de,localStorage.setItem("p5todoScale",`${f}`),m=F.copy().add(n.sub(x).div(f))}}return!1}},e.touchEnded=r=>{let i=r.target==document.getElementById("p5todo");if(!S&&i)switch(_=r.touches,_.length){case 0:ge(),O=!1;break;case 1:if(!O)return;he(),ee=0}};let he=()=>{x=e.createVector(_[0].clientX,_[0].clientY-L),F=m.copy();for(let r=0,i=l.length;r<i;r++)if(a[l[r]].position.dist(I(x.x,x.y))<a[l[r]].EllipseSize/2){a[l[r]].isGrabbed=!0,v=a[l[r]];break}},ue=()=>{v&&(v.isGrabbed=!1,v.Velocity=w.copy(),v.Accel=w.copy(),v=null)},ge=()=>{ue(),x=null;try{if(F.dist(m)<15)for(let i=0,s=l.length;i<s;i++)if(a[l[i]].position.dist(I())<a[l[i]].EllipseSize/2){a[l[i]].Clicked();break}}catch{}}})}ionViewDidEnter(){document.getElementById("p5todo")?this.global.p5todoPlayCanvas():this.CreateTodoManager(),this.try_add_shortcut()}try_add_shortcut(){this.global.p5KeyShortCut?(this.global.p5KeyShortCut.AddAct=()=>{this.nakama.open_add_todo_page()},this.global.p5KeyShortCut.Backquote=()=>{this.SwitchTargetFilter()},this.global.p5KeyShortCut.Digit=c=>{this.AllCategories[this.TargetFilterName].length>c&&this.ChangeFilterValue(this.AllCategories[this.TargetFilterName][c].value)}):setTimeout(()=>{this.try_add_shortcut()},100)}ionViewWillLeave(){this.global.p5todoStopCanvas&&this.global.p5todoStopCanvas(),this.global.p5KeyShortCut&&(delete this.global.p5KeyShortCut.AddAct,delete this.global.p5KeyShortCut.Backquote,delete this.global.p5KeyShortCut.Digit)}}return(d=b).\u0275fac=function(c){return new(c||d)(t.rXU($.z3),t.rXU(ye.y),t.rXU(Ce.X),t.rXU(ve.j),t.rXU(_e.n),t.rXU(E.hG))},d.\u0275cmp=t.VBU({type:d,selectors:[["app-main"]],decls:15,vars:8,consts:[[1,"ion-no-border"],[1,"play_button",3,"click"],["button","","style","width: 24px; height: 24px;","name","play-circle",4,"ngIf"],["button","","style","width: 24px; height: 24px;","name","pause-circle",4,"ngIf"],[1,"add_button",3,"click"],["class","shortcut_hint shortcut_top_add",4,"ngIf"],["button","","name","add-circle-outline",2,"width","24px","height","24px"],[1,"header_online_circle",3,"click"],["oncontextmenu","return false;"],[4,"ngIf"],["id","todo",1,"full_screen",2,"overflow","hidden"],["style","position: absolute; top: 16px; left: 16px;",4,"ngIf"],["button","","name","play-circle",2,"width","24px","height","24px"],["button","","name","pause-circle",2,"width","24px","height","24px"],[1,"shortcut_hint","shortcut_top_add"],[1,"disconnect_info",3,"click"],["color","medium","name","create-outline",2,"width","60px","height","60px"],["color","medium"],[2,"position","absolute","top","16px","left","16px"],[1,"FilterSwitchButton",3,"click"],["class","shortcut_hint shortcut_todo_categories",4,"ngIf"],["class","FilterSwitchButton",3,"style","click",4,"ngFor","ngForOf"],[1,"shortcut_hint","shortcut_todo_categories"]],template:function(c,g){1&c&&(t.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.k0s(),t.j41(4,"div",1),t.bIt("click",function(){return g.toggleCanvasPlaying()}),t.DNE(5,Te,1,0,"ion-icon",2)(6,Pe,1,0,"ion-icon",3),t.k0s(),t.j41(7,"div",4),t.bIt("click",function(){return g.nakama.open_add_todo_page()}),t.DNE(8,Se,2,0,"div",5),t.nrm(9,"ion-icon",6),t.k0s(),t.j41(10,"div",7),t.bIt("click",function(){return g.toggle_session()}),t.k0s()()(),t.j41(11,"ion-content",8),t.DNE(12,je,6,1,"div",9),t.j41(13,"div",10),t.DNE(14,Ie,5,3,"div",11),t.k0s()()),2&c&&(t.R7$(3),t.JRh(g.lang.text.Main.Title),t.R7$(2),t.Y8G("ngIf",!g.isPlayingCanvas.loop),t.R7$(),t.Y8G("ngIf",g.isPlayingCanvas.loop),t.R7$(2),t.Y8G("ngIf",g.global.ShowHint),t.R7$(2),t.Aen("background-color: "+g.statusBar.colors[g.statusBar.settings.groupServer]+"; cursor: pointer;"),t.R7$(2),t.Y8G("ngIf",g.isEmptyTodo),t.R7$(2),t.Y8G("ngIf",!g.isEmptyTodo))},dependencies:[K.Sq,K.bT,E.W9,E.eU,E.iq,E.he,E.BC,E.ai],styles:[".md[_ngcontent-%COMP%]   .play_button[_ngcontent-%COMP%]{position:absolute;right:116px;top:16px;cursor:pointer}.ios[_ngcontent-%COMP%]   .play_button[_ngcontent-%COMP%]{position:absolute;right:96px;top:10px;cursor:pointer}.md[_ngcontent-%COMP%]   .add_button[_ngcontent-%COMP%]{position:absolute;right:68px;top:16px;cursor:pointer}.ios[_ngcontent-%COMP%]   .add_button[_ngcontent-%COMP%]{position:absolute;right:58px;top:10px;cursor:pointer}.FilterSwitchButton[_ngcontent-%COMP%]{padding:8px;border-radius:8px;font-size:16px;background-color:#8888;margin-right:8px;margin-bottom:8px;color:var(--default-text-color-direction)}"]}),b})()}];let we=(()=>{var d;class b{}return(d=b).\u0275fac=function(c){return new(c||d)},d.\u0275mod=t.$C({type:d}),d.\u0275inj=t.G2t({imports:[ie.iI.forChild(Ee),ie.iI]}),b})(),Ae=(()=>{var d;class b{}return(d=b).\u0275fac=function(c){return new(c||d)},d.\u0275mod=t.$C({type:d}),d.\u0275inj=t.G2t({imports:[K.MD,fe.YN,E.bv,we]}),b})()}}]);