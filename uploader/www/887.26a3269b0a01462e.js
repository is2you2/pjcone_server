"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[887],{887:(ct,ve,C)=>{C.r(ve),C.d(ve,{MainPageModule:()=>at});var he=C(177),Be=C(4341),L=C(5374),Te=C(9858),X=C(467),q=C(7100),Se=C(4237),xe=C(92),ue=C(8326),Oe=C(617),t=C(3953),Ve=C(4234),Me=C(8065),De=C(755),Ne=C(3307),Le=C(5547),He=C(9900);const Ge=["LocalToRemoteSel"];function ze(u,j){1&u&&t.nrm(0,"ion-icon",14)}function Ue(u,j){1&u&&t.nrm(0,"ion-icon",15)}function Xe(u,j){1&u&&(t.j41(0,"div",16),t.EFF(1,"A"),t.k0s())}function Ye(u,j){if(1&u){const _=t.RV6();t.j41(0,"div")(1,"div",17),t.bIt("click",function(){t.eBV(_);const o=t.XpG();return t.Njj(o.nakama.open_add_todo_page())}),t.nrm(2,"ion-icon",18),t.j41(3,"div")(4,"ion-label",19),t.EFF(5),t.k0s()()()()}if(2&u){const _=t.XpG();t.R7$(5),t.JRh(_.lang.text.Main.NoTodo)}}function We(u,j){if(1&u){const _=t.RV6();t.j41(0,"div")(1,"ion-item",21),t.bIt("click",function(){const o=t.eBV(_).$implicit,T=t.XpG(2);return t.Njj(T.TodoServerSelected(o))}),t.j41(2,"ion-label"),t.EFF(3),t.k0s()()()}if(2&u){const _=j.$implicit;t.R7$(3),t.JRh(_.name)}}function Je(u,j){if(1&u&&(t.j41(0,"ion-content")(1,"ion-item-divider")(2,"ion-label"),t.EFF(3),t.k0s()(),t.DNE(4,We,4,1,"div",20),t.k0s()),2&u){const _=t.XpG();t.R7$(3),t.JRh(_.lang.text.Main.MigrateRemote),t.R7$(),t.Y8G("ngForOf",_.SelectableTodoServer)}}function Ke(u,j){1&u&&(t.j41(0,"div",25),t.EFF(1,"`"),t.k0s())}function Qe(u,j){if(1&u&&(t.j41(0,"div",25),t.EFF(1),t.k0s()),2&u){const _=t.XpG(2).index;t.R7$(),t.SpI("",_+1," ")}}function Ze(u,j){if(1&u){const _=t.RV6();t.j41(0,"span")(1,"button",26),t.bIt("click",function(){t.eBV(_);const o=t.XpG().$implicit,T=t.XpG(2);return t.Njj(T.ChangeFilterValue(o.value))})("contextmenu",function(){t.eBV(_);const o=t.XpG().$implicit,T=t.XpG(2);return t.Njj(T.FilterContextAct(o))}),t.DNE(2,Qe,2,1,"div",24),t.EFF(3),t.k0s()()}if(2&u){const _=t.XpG(),g=_.$implicit,o=_.index,T=t.XpG(2);t.R7$(),t.Aen("background-color: "+(g.color||"#8888")+"; "+(T.CurrentFilterValue===g.value?"border: 4px solid var(--ion-color-secondary); margin: -4px 4px 4px -4px;":"")),t.Y8G("id","filterSel_"+o),t.R7$(),t.Y8G("ngIf",T.global.ShowHint&&T.global.portalHint),t.R7$(),t.SpI(" ",g.force_name||T.lang.text.TodoDetail[g.name]," ")}}function qe(u,j){if(1&u){const _=t.RV6();t.j41(0,"span")(1,"input",27),t.bIt("input",function(o){t.eBV(_);const T=t.XpG().$implicit,e=t.XpG(2);return t.Njj(e.GetFilterInput(o,T.name))})("blur",function(){t.eBV(_);const o=t.XpG(3);return t.Njj(o.global.toggleBlockMainShortcut(!1))})("focus",function(){t.eBV(_);const o=t.XpG(3);return t.Njj(o.global.toggleBlockMainShortcut(!0))}),t.k0s()()}if(2&u){const _=t.XpG().$implicit,g=t.XpG(2);t.R7$(),t.Y8G("placeholder",g.lang.text.TodoDetail[_.name])}}function et(u,j){if(1&u&&(t.j41(0,"span"),t.DNE(1,Ze,4,5,"span",10)(2,qe,2,1,"span",10),t.k0s()),2&u){const _=j.$implicit;t.R7$(),t.Y8G("ngIf",!_.type),t.R7$(),t.Y8G("ngIf","input"==_.type)}}function tt(u,j){if(1&u){const _=t.RV6();t.j41(0,"div",22)(1,"button",23),t.bIt("click",function(){t.eBV(_);const o=t.XpG();return t.Njj(o.SwitchTargetFilter())}),t.DNE(2,Ke,2,0,"div",24),t.EFF(3),t.k0s(),t.DNE(4,et,3,2,"span",20),t.k0s()}if(2&u){const _=t.XpG();t.R7$(2),t.Y8G("ngIf",_.global.ShowHint&&_.global.portalHint),t.R7$(),t.SpI(" ",_.lang.text.TodoDetail[_.TargetFilterDisplayName]," "),t.R7$(),t.Y8G("ngForOf",_.AllCategories[_.TargetFilterName])}}var P=function(u){return u[u.None=0]="None",u[u.Status=1]="Status",u[u.Importance=2]="Importance",u[u.Color=3]="Color",u[u.Creator=4]="Creator",u[u.InputText=5]="InputText",u}(P||{});const it=[{path:"",component:(()=>{var u;class j{constructor(g,o,T,e,ne,c,s,Y,W){this.global=g,this.lang=o,this.nakama=T,this.statusBar=e,this.indexed=ne,this.alertCtrl=c,this.p5loading=s,this.noti=Y,this.p5toast=W,this.isPlayingCanvas={loop:!0},this.TargetFilterDisplayName="FilterCat_0",this.TargetFilterName=0,this.AllCategories={},this.CurrentFilterValue=null,this.SelectableTodoServer=[],this.isEmptyTodo=!1}ngOnInit(){let g=document.getElementById("p5todo");if(this.indexed.ionicDB?!g&&!this.global.p5todo&&this.CreateTodoManager():this.indexed.PortalTabCallback.push(()=>{!g&&!this.global.p5todo&&this.CreateTodoManager()}),"MobilePWA"==xe.aH){let o;this.global.WindowOnBlurAct.todobackground=()=>{var T;o=setInterval(()=>{var e;null===(e=this.global.p5todo)||void 0===e||e.redraw()},(null===(T=this.global.p5todo)||void 0===T?void 0:T.frameRate())||50)},this.global.windowOnFocusAct.todobackground=()=>{o&&clearInterval(o)}}this.global.PortalBottonTabAct.Todo=()=>{var o;null===(o=this.ViewInitFunc)||void 0===o||o.call(this)}}toggle_session(){this.nakama.toggle_all_session(),this.global.p5todo.redraw()}toggleCanvasPlaying(){var g,o;this.isPlayingCanvas.loop=!this.isPlayingCanvas.loop,this.isPlayingCanvas.loop?null===(g=this.global.p5todo)||void 0===g||g.loop():null===(o=this.global.p5todo)||void 0===o||o.noLoop()}SwitchTargetFilter(g){var o,T;switch(this.TargetFilterName=null!=g?g:(this.TargetFilterName+1)%6,this.TargetFilterName){case P.None:this.TargetFilterDisplayName="FilterCat_0";break;case P.Importance:this.TargetFilterDisplayName="Importance";break;case P.Color:this.TargetFilterDisplayName="CustomColor";break;case P.Status:this.TargetFilterDisplayName="Status";break;case P.Creator:this.TargetFilterDisplayName="FilterByCreator";break;case P.InputText:this.TargetFilterDisplayName="AsString"}this.CurrentFilterValue=null,null===(o=(T=this.global).p5FilteringTodos)||void 0===o||o.call(T,P.None,this.TargetFilterDisplayName)}ChangeFilterValue(g){this.CurrentFilterValue=this.CurrentFilterValue===g?null:g,this.global.p5FilteringTodos()}FilterContextAct(g){return this.global.p5FilterContextMenu(g),!1}CreateTodoManager(){var g,o=this;setTimeout(()=>{"DesktopPWA"!=xe.aH&&this.toggleCanvasPlaying()},8e3);let T=document.getElementById("todo");null===(g=this.global.p5todo)||void 0===g||g.remove(),this.global.p5todo=new ue(e=>{let $,me,re,je,ge,ne=this.statusBar,c={},s=[],Y=[],W=[],J=e.createVector(0,0),x=e.createVector(0,0),k=1,M=e.createVector(0,0),ee=this.nakama,ke=this.indexed,H=[],O=!1,te=this.isPlayingCanvas;this.GetFilterInput=(f,l)=>{if("InputPlaceHolder"===l){const a=f.target.value;for(let h=0,d=s.length;h<d;h++){var n;let y=!1;const S=c[s[h]].json;if(S.title){if(S.title.indexOf(a)>=0&&(y=!0),y){c[s[h]].isHidden=!y;continue}(null===(n=S.description)||void 0===n?void 0:n.indexOf(a))>=0&&(y=!0),c[s[h]].isHidden=!y}}}this.isPlayingCanvas.loop||e.redraw()},e.setup=(0,X.A)(function*(){let f=e.createCanvas(T.clientWidth,T.clientHeight);f.parent(T),f.id("p5todo"),f.elt.oncontextmenu=function(){var n=(0,X.A)(function*(a){for(let h=s.length-1;h>=0;h--){const d=c[s[h]];if("AddButton"!=d.json.id&&d.position.dist(U(a.offsetX,a.offsetY))<d.EllipseSize/2){let S="";try{let B;try{B=`todo/${d.json.id}_${d.json.remote.isOfficial}_${d.json.remote.target}/thumbnail.png`}catch{B=`todo/${d.json.id}/thumbnail.png`}let R=yield ke.loadBlobFromUserPath(B,"image/png");const E=URL.createObjectURL(R);S=`<div style="text-align: center"><img src="${E}" alt="todo_image" style="border-radius: 2px"></div>`,setTimeout(()=>{URL.revokeObjectURL(E)},100)}catch{}o.alertCtrl.create({header:d.json.title,message:new Oe.Vk(S+`<div>${d.json.description||""}</div>`),buttons:[{text:o.lang.text.TodoDetail.TodoComplete,handler:()=>{!function(){var R=(0,X.A)(function*(){try{yield ee.doneTodo(d.json)}catch(E){console.log("\ud560 \uc77c \uc644\ub8cc \uc624\ub958: ",E)}});return function(){return R.apply(this,arguments)}}()()}},{text:o.lang.text.TodoDetail.remove,cssClass:"redfont",handler:()=>{!function(){var R=(0,X.A)(function*(){try{yield ee.deleteTodoFromStorage(!0,d.json)}catch(E){console.log("\ud560 \uc77c \uc0ad\uc81c \uc624\ub958: ",E)}});return function(){return R.apply(this,arguments)}}()()}}]}).then(B=>{$e(),B.onDidDismiss().then(()=>{O=!1}),O=!0,B.present()});break}}});return function(a){return n.apply(this,arguments)}}(),e.smooth(),e.noStroke(),e.pixelDensity(1),e.ellipseMode(e.CENTER),e.rectMode(e.CENTER),e.textAlign(e.CENTER,e.CENTER),e.textSize(20),e.textLeading(28),e.textWrap(e.CHAR),e.imageMode(e.CENTER);let l=Number(localStorage.getItem("p5todoScale")||1);nt(),o.ViewInitFunc=fe,k=l,localStorage.setItem("p5todoScale",`${k}`),o.global.p5todoStopCanvas=()=>{O=!0,e.noLoop()},o.global.p5todoPlayCanvas=()=>{O=!1,e.windowResized(),o.isPlayingCanvas.loop&&e.loop()},o.global.p5todoAddtodo=n=>{let a=JSON.parse(n),h=a.id;if(a.remote&&(h+=`_${a.remote.isOfficial}_${a.remote.target}`),!a.removed){if(o.global.AddTodoTags(a),a.done){for(let d=s.length-1;d>=0;d--)if(s[d]==h)return void c[s[d]].makeDone()}else c[h]?(c[h].json=a,c[h].initialize()):c[h]=new Fe(a);o.isPlayingCanvas.loop||(me=c[h],e.loop()),re()}},re=()=>{s=Object.keys(c),o.isEmptyTodo=!s.length,o.isEmptyTodo||(c.AddButton?1==s.length&&c.AddButton.makeDone():(c.AddButton=new Fe("",!0),s=Object.keys(c)))},o.global.p5removeTodo=n=>{let a=JSON.parse(n),h=a.id;a.remote&&(h+=`_${a.remote.isOfficial}_${a.remote.target}`);for(let d=s.length-1;d>=0;d--)if(s[d]==h){c[s[d]].RemoveTodo();break}o.global.RemoveTodoTags(a),o.isEmptyTodo=!Object.keys(s).length,re(),e.redraw()},je=function(){var n=(0,X.A)(function*(){c={},s.length=0;let a=yield o.indexed.GetFileListFromDB("todo/");for(let h=0,d=a.length;h<d;h++)if(a[h].indexOf("/info.todo")>=0){let y=yield o.indexed.loadTextFromUserPath(a[h]);o.global.p5todoAddtodo(y)}o.isEmptyTodo=!Object.keys(s).length});return function(){return n.apply(this,arguments)}}(),je(),o.SwitchTargetFilter(o.TargetFilterName),o.AllCategories[P.None]=o.global.TodoTagsKey,o.AllCategories[P.Importance]=[{name:"Importance_0",color:"#58a19288",value:"0"},{name:"Importance_1",color:"#ddbb4188",value:"1"},{name:"Importance_2",color:"#b9543788",value:"2"}],o.AllCategories[P.Color]=[{name:"ColorFilterRed",color:"#ff000088",value:[-30,30]},{name:"ColorFilterYellow",color:"#ffff0088",value:[30,90]},{name:"ColorFilterGreen",color:"#00ff0088",value:[90,150]},{name:"ColorFilterCyan",color:"#00ffff88",value:[150,210]},{name:"ColorFilterBlue",color:"#0000ff88",value:[210,270]},{name:"ColorFilterMagenta",color:"#ff00ff88",value:[270,330]},{name:"ColorFilterNone",color:"#bbbbbbbb"}],o.AllCategories[P.Status]=[{name:"TimeBefore",color:"#bbbbbb88",value:"before"},{name:"TimeIn",color:"#00ff0088",value:"ontime"},{name:"TimeOut",color:"#b9543788",value:"after"},{name:"Yesterday",color:"#45678988",value:"yesterday"},{name:"Today",color:"#789abc88",value:"today"},{name:"Tomorrow",color:"#abcdef88",value:"tomorrow"}],o.AllCategories[P.Creator]=[{name:"CreatorLocal",color:"#bbbbbb88",value:"local"},{name:"CreatorMe",color:"#00ff0088",value:"server"},{name:"Requested",color:"#6789ab88",value:"worker"},{name:"CreatorOther",color:"#ba987688",value:"other"}],o.AllCategories[P.InputText]=[{name:"InputPlaceHolder",color:"#bbbbbb88",type:"input",value:"text"}],o.global.p5FilteringTodos=lt,o.global.p5FilterContextMenu=st});const ce=()=>{te.loop||(e.loop(),ge&&clearTimeout(ge),ge=setTimeout(()=>{te.loop||e.noLoop()},4e3))};let Pe;const lt=(f,l)=>{switch(l&&(Pe=l),null!=f?f:this.TargetFilterName){case P.None:if(null!=this.CurrentFilterValue)for(let a=0,h=s.length;a<h;a++)if("AddButton"==c[s[a]].json.id)c[s[a]].isHidden=!1;else{const d=!c[s[a]].json.tags.includes(this.global.TodoTagsKey[this.CurrentFilterValue].force_name);c[s[a]].isHidden=d,d&&c[s[a]].Repositioning()}else s.forEach(a=>c[a].isHidden=!1);break;case P.Importance:if(this.CurrentFilterValue){for(let a=0,h=s.length;a<h;a++)if("AddButton"==c[s[a]].json.id)c[s[a]].isHidden=!1;else{const d=c[s[a]].json.importance!=this.CurrentFilterValue;c[s[a]].isHidden=d,d&&c[s[a]].Repositioning()}ce()}else s.forEach(a=>c[a].isHidden=!1);break;case P.Color:for(let a=0,h=s.length;a<h;a++){let d;switch(e.push(),e.colorMode(e.HSB),c[s[a]].json.importance){case"0":d=e.color("#58a192");break;case"1":d=e.color("#ddbb41");break;case"2":d=e.color("#b95437")}try{d=e.color(c[s[a]].json.custom_color)}catch{}if(e.pop(),this.CurrentFilterValue){if(d){const y=(360+this.CurrentFilterValue[0])%360,S=(360+this.CurrentFilterValue[1])%360,N=e.hue(d);let V=!1;V=y<S?!(y<N&&N<S):S<N&&N<y;const B=e.saturation(d);V=V||!B,c[s[a]].isHidden=V,V&&c[s[a]].Repositioning()}}else if(void 0===this.CurrentFilterValue){if(d){const y=e.saturation(d);c[s[a]].isHidden=!!y,y&&c[s[a]].Repositioning()}}else c[s[a]].isHidden=!1}ce();break;case P.Status:if(this.CurrentFilterValue){for(let a=0,h=s.length;a<h;a++)if("AddButton"==c[s[a]].json.id)c[s[a]].isHidden=!1;else{let d=!1;switch(this.CurrentFilterValue){case"before":d=!(c[s[a]].json.startFrom&&c[s[a]].json.startFrom>Date.now());break;case"ontime":d=!((c[s[a]].json.startFrom||0)<Date.now()&&(c[s[a]].json.limit||c[s[a]].json.written)>Date.now());break;case"after":d=!(c[s[a]].json.limit<=Date.now());break;case"yesterday":{const y=new Date;y.setDate(y.getDate()-1),y.setHours(0,0,0,0);const S=new Date;S.setDate(S.getDate()-1),S.setHours(23,59,59,999),d=!((c[s[a]].json.startFrom||c[s[a]].json.written)<=S&&c[s[a]].json.limit>y)}break;case"today":{const y=new Date;y.setHours(0,0,0,0);const S=new Date;S.setHours(23,59,59,999),d=!((c[s[a]].json.startFrom||c[s[a]].json.written)<=S&&c[s[a]].json.limit>y)}break;case"tomorrow":{const y=new Date;y.setDate(y.getDate()+1),y.setHours(0,0,0,0);const S=new Date;S.setDate(S.getDate()+1),S.setHours(23,59,59,999),d=!((c[s[a]].json.startFrom||c[s[a]].json.written)<=S&&c[s[a]].json.limit>y)}}c[s[a]].isHidden=d,d&&c[s[a]].Repositioning()}ce()}else s.forEach(a=>c[a].isHidden=!1);break;case P.Creator:if(this.CurrentFilterValue){for(let a=0,h=s.length;a<h;a++)if("AddButton"==c[s[a]].json.id)c[s[a]].isHidden=!1;else{let d=!1;switch(this.CurrentFilterValue){case"local":d=c[s[a]].json.storeAt!=this.CurrentFilterValue;break;case"server":d=void 0===c[s[a]].json.remote;break;case"worker":d=!(void 0!==c[s[a]].json.workers&&c[s[a]].json.is_me);break;case"other":d=c[s[a]].json.is_me||"local"==c[s[a]].json.storeAt}c[s[a]].isHidden=d,d&&c[s[a]].Repositioning()}ce()}else s.forEach(a=>c[a].isHidden=!1)}e.redraw()},st=f=>{"FilterByCreator"===this.TargetFilterDisplayName&&"local"===f.value&&(this.SelectableTodoServer=ee.get_all_server_info(!0,!0,!0),this.SelectableTodoServer.length&&(this.global.toggleBlockMainShortcut(!0),this.LocalToRemoteSel.onDidDismiss().then(()=>{this.global.toggleBlockMainShortcut(!1)}),this.LocalToRemoteSel.present()))};this.TodoServerSelected=function(){var f=(0,X.A)(function*(l){const n=l.isOfficial,a=l.target,h="migrateTodo";let d=[];for(let R=s.length-1;R>=0;R--)"AddButton"!=c[s[R]].json.id&&"local"==c[s[R]].json.storeAt&&d.push(c[s[R]]);for(;d.length;){const R=d.shift(),E=JSON.stringify(R.json),_e=JSON.parse(E),v=JSON.parse(E),i=JSON.parse(E);i.storeAt=`${n}/${a}`,i.remote=l;try{var y,S;yield o.p5loading.update({id:h,message:`${o.lang.text.TodoDetail.ApplyingTodo}: ${i.title}`});const Q=!!i.attach.length;delete i.display_store,delete i.display_creator;let G={};try{G.apache_port=l.apache_port,G.cdn_port=l.cdn_port,G.user_id=ee.servers[n][a].session.user_id}catch{G={}}for(let r=0,m=v.attach.length;r<m;r++){try{const p=v.attach[r].filename,b=yield o.indexed.loadBlobFromUserPath(v.attach[r].path,v.attach[r].type),w=`tmp_files/todo/${p}`;yield o.indexed.saveBlobToUserPath(b,w),i.attach[r].path=w,i.attach[r].blob=b}catch{if(v.attach[r].url){const b=v.attach[r].filename,I=yield(yield fetch(v.attach[r].url)).blob(),K=`tmp_files/todo/${b}`;yield o.indexed.saveBlobToUserPath(I,K),i.attach[r].path=K,i.attach[r].blob=I,yield o.global.remove_file_from_storage(i.attach[r].url,G)}}delete i.attach[r].thumbnail,delete i.attach[r].alt_path,delete i.attach[r].url,delete i.attach[r].exist}if(yield o.nakama.deleteTodoFromStorage(!0,_e,void 0,h),i.remote)try{const r=yield o.nakama.getRemoteTodoCounter(i.remote.isOfficial,i.remote.target);i.id=`RemoteTodo_${r}`}catch{}else i.id=new Date(i.create_at).toISOString().replace(/[:|.|\/]/g,"_");i.noti_id&&(o.nakama.RemoveLocalPushSchedule(i),o.nakama.removeRegisteredId(i.noti_id),o.noti.ClearNoti(i.noti_id)),i.noti_id=o.nakama.get_noti_id();let se=!1;try{v.attach.forEach(p=>{delete p.exist,delete p.thumbnail,delete p.base64,delete p.blob});const r=JSON.stringify(v.attach);let m=JSON.parse(JSON.stringify(i.attach));m.forEach(p=>{delete p.exist,delete p.thumbnail,delete p.base64,delete p.blob}),m=JSON.stringify(m),se=r!=m}catch{se=!0}if(Q&&se){if(v)try{for(let m=0,p=v.attach.length;m<p;m++){for(let b=0,w=i.attach.length;b<w;b++)if(i.attach[b].path==v.attach[m].path){v.attach[m].exist=!0,v.attach[m].index=b;break}(!v.attach[m].exist||v.attach[m].exist&&!i.attach[v.attach[m].index])&&(v.attach[m].url?""!==v.attach[m].type&&(yield o.global.remove_file_from_storage(v.attach[m].url,G)):yield o.indexed.removeFileFromUserPath(v.attach[m].path))}}catch{}let r;for(let m=0,p=i.attach.length;m<p;m++){let b,w=!1;try{if(r)throw"already exist";b=yield o.indexed.loadBlobFromUserPath(`${i.attach[m].path}_thumbnail.png`,"image/png"),w=!0}catch{}if(!i.attach[m].exist||!r&&"image"==i.attach[m].viewer){try{w||(b=yield o.indexed.loadBlobFromUserPath(i.attach[m].path,i.attach[m].type))}catch{}try{if(1!=i.CDN)throw"FFS \uc0ac\uc6a9 \uc21c\uc704\uc5d0 \uc5c6\uc74c";let I;if(I=yield o.global.try_upload_to_user_custom_fs(i.attach[m],o.nakama.users.self.display_name,h,i.title),!I)throw"\uc5c5\ub85c\ub4dc \uc2e4\ud328";delete i.attach[m].partsize,delete i.attach[m].size,i.attach[m].url=I}catch{try{i.attach[m].path=`todo/${i.id}_${i.remote.isOfficial}_${i.remote.target}/${i.attach[m].filename}`}catch{i.attach[m].path=`todo/${i.id}/${i.attach[m].filename}`}try{b||(b=yield o.indexed.loadBlobFromUserPath(i.attach[m].path,i.attach[m].type)),yield o.indexed.saveBlobToUserPath(b,i.attach[m].path)}catch{}}}else delete i.attach[m].exist;if(!r&&("image"==i.attach[m].viewer||w))try{r=URL.createObjectURL(b)}catch{}}o.p5loading.update({id:h,image:r||null}),r&&(yield new Promise(m=>{new ue(p=>{p.setup=()=>{p.noCanvas(),p.loadImage(r,b=>{b.width>b.height?b.resize(b.width/b.height*128,128):b.resize(128,b.height/b.width*128);let I=p.createCanvas(128,128);I.hide(),p.smooth(),p.pixelDensity(1),p.image(b,-(b.width-128)/2,-(b.height-128)/2);const K=I.elt.toDataURL("image/png").replace("image/png","image/octet-stream");let Z;try{Z=`todo/${i.id}_${i.remote.isOfficial}_${i.remote.target}/thumbnail.png`}catch{Z=`todo/${i.id}/thumbnail.png`}URL.revokeObjectURL(r),p.remove(),o.indexed.saveBase64ToUserPath(K,Z).then(rt=>{m()})},b=>{console.error("Todo-\ub4f1\ub85d\ub41c \uc774\ubbf8\uc9c0 \ubd88\ub7ec\uc624\uae30 \uc2e4\ud328: ",b),URL.revokeObjectURL(r),p.remove(),m()})}})}))}if(!Q&&se&&v){let r;try{r=`todo/${i.id}_${i.remote.isOfficial}_${i.remote.target}/thumbnail.png`}catch{r=`todo/${i.id}/thumbnail.png`}if(yield o.indexed.removeFileFromUserPath(r),v.attach)for(let m=0,p=v.attach.length;m<p;m++)v.attach[m].url?""!==v.attach[m].type&&(yield o.global.remove_file_from_storage(v.attach[m].url,G)):yield o.indexed.removeFileFromUserPath(v.attach[m].path)}if(i.attach.forEach(r=>{URL.revokeObjectURL(r.thumbnail),delete r.thumbnail,delete r.exist,delete r.base64}),i.written=(new Date).getTime(),i.startFrom){const r=new Date(i.startFrom).getTime();(new Date).getTime()>r?delete i.startFrom:i.startFrom=r}if(i.limit=new Date(i.limit).getTime(),o.nakama.set_todo_notification(i),i.remote&&!i.remote.creator_id&&(i.remote.creator_id=o.nakama.servers[i.remote.isOfficial][i.remote.target].session.user_id),i.attach.forEach(r=>{URL.revokeObjectURL(r.thumbnail),delete r.thumbnail,delete r.exist,delete r.base64}),Q&&se&&v)for(let r=0,m=v.attach.length;r<m;r++){for(let p=0,b=i.attach.length;p<b;p++)if(i.attach[p].path==v.attach[r].path){v.attach[r].exist=!0,v.attach[r].index=p;break}if(!v.attach[r].exist||v.attach[r].exist&&!i.attach[v.attach[r].index])if(v.attach[r].url)""!==v.attach[r].type&&(yield o.global.remove_file_from_storage(v.attach[r].url,G));else try{yield o.nakama.sync_remove_file(v.attach[r].path,i.remote.isOfficial,i.remote.target,"todo_attach")}catch{}}for(let r=0,m=i.attach.length;r<m;r++)if(i.attach[r].url)delete i.attach[r].path,delete i.attach[r].size,delete i.attach[r].partsize;else try{if(2==i.CDN)throw"ForceSQL";!i.attach[r].blob.size&&i.attach[r].url&&(i.attach[r].blob=yield(yield fetch(i.attach[r].url)).blob());const p=o.nakama.servers[i.remote.isOfficial][i.remote.target].info.address,b=o.nakama.servers[i.remote.isOfficial][i.remote.target].info.useSSL?"https:":"http:";let w=`${o.nakama.users.self.display_name}/${i.id}`;try{w=`${i.remote.creator_id}/${i.id}`}catch{}const I=yield o.global.upload_file_to_storage(i.attach[r],{user_id:w,apache_port:G.apache_port,cdn_port:G.cdn_port},b,p,1==i.CDN,h,i.title);if(!I)throw"\ub9c1\ud06c \ub9cc\ub4e4\uae30 \uc2e4\ud328";delete i.attach[r].size,delete i.attach[r].partsize,i.attach[r].url=I}catch(p){console.log("cdn \uc5c5\ub85c\ub4dc \ucc98\ub9ac \uc2e4\ud328: ",p),"ForceSQL"==p&&i.attach[r].url&&(i.attach[r].blob=yield(yield fetch(i.attach[r].url)).blob());try{yield o.nakama.sync_save_file(i.attach[r],i.remote.isOfficial,i.remote.target,"todo_attach")}catch{}}const Ee=yield o.nakama.servers[i.remote.isOfficial][i.remote.target].client.writeStorageObjects(o.nakama.servers[i.remote.isOfficial][i.remote.target].session,[{collection:"server_todo",key:i.id,permission_read:2,permission_write:1,value:i}]);let be,ye;yield o.nakama.updateRemoteCounter(i.remote.isOfficial,i.remote.target),yield o.nakama.servers[i.remote.isOfficial][i.remote.target].client.rpc(o.nakama.servers[i.remote.isOfficial][i.remote.target].session,"send_noti_fn",{receiver_id:o.nakama.servers[i.remote.isOfficial][i.remote.target].session.user_id,title:"Manage_todo_add",content:{type:"add",collection:Ee.acks[0].collection,key:Ee.acks[0].key},code:Se.I.MANAGE_TODO,persistent:!1}),i.is_me=!0,null===(y=(S=o.global).p5todoAddtodo)||void 0===y||y.call(S,JSON.stringify(i));try{be=`todo/${i.id}_${i.remote.isOfficial}_${i.remote.target}/info.todo`}catch{be=`todo/${i.id}/info.todo`}yield o.indexed.saveTextFileToUserPath(JSON.stringify(i),be);for(let r=0,m=i.attach.length;r<m;r++)if("image"==i.attach[r].viewer&&i.attach[r].url){ye=i.attach[r].url;break}try{var N;let r=localStorage.getItem("fallback_fs");if(!r)throw"\uc0ac\uc6a9\uc790 \uc9c0\uc815 \uc11c\ubc84 \uc5c6\uc74c";let m=r.split("://"),p=m.pop().split(":"),b=m.pop();b?b+=":":b=o.global.checkProtocolFromAddress(p[0])?"https:":"http:";const w=null===(N=p[1])||void 0===N?void 0:N.split(","),I=`${b}//${p[0]}:${(null==w?void 0:w[2])||5e3}`;let Z=[localStorage.getItem("fallback_fs_push_tog")];yield o.nakama.remove_schedule_webpush(I,{todo_id:i.id},Z),yield o.nakama.schedule_webpush(I,{id:i.noti_id,title:i.title,body:i.description,icon:"todo",image:ye,todo_id:i.id,time:i.startFrom||i.limit},Z)}catch(r){console.log("FFS \ud560 \uc77c \uc54c\ub9bc \ub4f1\ub85d \uc808\ucc28 \uc624\ub958: ",r)}if(i.remote)try{const b=`${o.nakama.servers[i.remote.isOfficial][i.remote.target].info.useSSL?"https":"http"}://${o.nakama.servers[i.remote.isOfficial][i.remote.target].info.address}:${o.nakama.servers[i.remote.isOfficial][i.remote.target].info.webpush_port||5e3}`;let w=[o.nakama.servers[i.remote.isOfficial][i.remote.target].session.user_id];yield o.nakama.schedule_webpush(b,{id:i.noti_id,title:i.title,body:i.description,icon:"todo",image:ye,todo_id:i.id,time:i.startFrom||i.limit},w)}catch(r){console.log("\uc6d0\uaca9 \ud560 \uc77c \uc54c\ub9bc \uc608\uc57d \uad6c\uc131 \uc2e4\ud328: ",r)}o.p5loading.update({id:h,message:`${o.lang.text.TodoDetail.ApplyingTodo}: ${i.title}`,progress:1})}catch(Q){var V,B;console.error("\ud574\uc57c\ud560 \uc77c\uc774 \uc11c\ubc84\uc5d0 \uc804\uc1a1\ub418\uc9c0 \uc54a\uc74c: ",Q),null===(V=(B=o.global).p5todoAddtodo)||void 0===V||V.call(B,JSON.stringify(_e)),o.p5toast.show({text:o.lang.text.TodoDetail.CanAddToServer}),o.p5loading.update({id:h,message:`${o.lang.text.TodoDetail.ApplyingTodo}: ${i.title}`})}yield new Promise(Q=>setTimeout(Q,0))}o.p5loading.remove(h)});return function(l){return f.apply(this,arguments)}}();const nt=()=>{M.x=e.width/2,M.y=e.height/2,x.x=0,x.y=0,k=1,localStorage.setItem("p5todoScale",`${k}`),this.isPlayingCanvas.loop||e.redraw()};let F={Act:!1,lerp:0,Scale:e.createVector(),CamPos:e.createVector(),CamScale:0};const fe=()=>{F.Act=!0,F.Scale.x=M.x,F.Scale.y=M.y,F.CamPos.x=x.x,F.CamPos.y=x.y,F.CamScale=k,this.isPlayingCanvas.loop||e.loop()};e.draw=()=>{if(this.global.stream?e.background(q.ud?"#121212":"#fff"):e.clear(255,255,255,255),e.push(),e.translate(M),e.scale(k),e.translate(x),this.TargetFilterName==P.None&&"Hidden"==this.CurrentFilterValue){for(let n=0,a=s.length;n<a;n++)if(c[s[n]].isAddButton){c[s[n]].display();break}}else for(let n=0,a=s.length;n<a;n++)c[s[n]].display();for(let n=W.length-1;n>=0;n--)W[n].display(),W[n].lifeTime<0&&W.splice(n,1);for(let n=Y.length-1;n>=0;n--)Y[n].DoneAnim();e.pop(),F.Act&&(F.lerp+=.07,M.x=e.lerp(F.Scale.x,e.width/2,le(F.lerp)),M.y=e.lerp(F.Scale.y,e.height/2,le(F.lerp)),x.x=e.lerp(F.CamPos.x,0,le(F.lerp)),x.y=e.lerp(F.CamPos.y,0,le(F.lerp)),k=e.lerp(F.CamScale,1,le(F.lerp)),localStorage.setItem("p5todoScale",`${k}`),F.lerp>=1&&(F.Act=!1,F.lerp=0,M.x=e.width/2,M.y=e.height/2,x.x=0,x.y=0,k=1,localStorage.setItem("p5todoScale",`${k}`),this.isPlayingCanvas.loop||e.noLoop()))};let le=f=>e.sin(f*e.PI/2);e.windowResized=()=>{O||setTimeout(()=>{let f=x.x/e.width,l=x.y/e.height;e.resizeCanvas(T.clientWidth,T.clientHeight),M.x=e.width/2,M.y=e.height/2,x.x=f*e.width,x.y=l*e.height},50)};let ie=!0;class Fe{constructor(l,n=!1){if(this.isAddButton=!1,this.EllipseSize=96,this.Velocity=e.createVector(0,0),this.Accel=e.createVector(0,0),this.isGrabbed=!1,this.TextColor=e.color(q.ud?255:0),this.ProgressWeight=8,this.LerpProgress=0,this.isHidden=!1,this.InView=!1,this.LifeTime=1,this.json=l,n)return this.isAddButton=n,this.position=J.copy(),this.defaultColor=e.color(q.ud?"#bbb":"#888"),void(this.json={id:"AddButton",written:0,limit:1,longSide:53,shortSide:11});this.Repositioning(),this.initialize()}Repositioning(){const l=e.max(e.width,e.height)||1,n=e.createVector(l/e.min(1,k),0).setHeading(e.random(-e.PI,e.PI));this.position=n}initialize(){if(!this.json.custom_color)switch(this.json.importance){case"0":this.defaultColor=e.color("#58a192");break;case"1":this.defaultColor=e.color("#ddbb41");break;case"2":this.defaultColor=e.color("#b95437")}let n,l=Number(this.json.importance);switch(l){case 0:this.EllipseSize=96;break;case 1:this.EllipseSize=104;break;case 2:this.EllipseSize=112}if(this.ProgressCircleSize=this.EllipseSize-this.ProgressWeight,!H[l]){H[l]=e.createImage(this.EllipseSize,this.EllipseSize),H[l].loadPixels();let a=e.createVector(H[l].width/2,H[l].height/2);for(let h=0,d=H[l].height;h<d;h++)for(let y=0,S=H[l].width;y<S;y++){let N=e.createVector(y,h);a.dist(N)<this.EllipseSize/2-1&&H[l].set(y,h,e.color(255,80))}H[l].updatePixels()}try{n=`todo/${this.json.id}_${this.json.remote.isOfficial}_${this.json.remote.target}/thumbnail.png`}catch{n=`todo/${this.json.id}/thumbnail.png`}ke.loadBlobFromUserPath(n,"").then(a=>{const h=URL.createObjectURL(a);e.loadImage(h,d=>{this.ThumbnailImage=d,this.ThumbnailImage.mask(H[l]),URL.revokeObjectURL(h)})}).catch(a=>{this.ThumbnailImage=null})}display(){e.push(),this.isGrabbed||(this.CalcPosition(),this.OnCollider(),this.position=this.position.add(this.Velocity)),e.translate(this.position),this.LerpProgress=e.map(Date.now(),this.json.startFrom||this.json.written,this.json.limit,0,1,!0),(this.isAddButton||this.json.written>this.json.limit)&&(this.LerpProgress=1);const l=e.width/2/k,n=e.height/2/k,a=this.EllipseSize/2;if(this.InView=this.position.x<l-x.x+a&&this.position.x>-l-x.x-a&&this.position.y<n-x.y+a&&this.position.y>-n-x.y-a,this.InView&&(this.isHidden?e.fill(128,40):e.fill("FilterByCreator"==Pe&&this.json.remote?ne.colors[ne.groupServer[this.json.remote.isOfficial][this.json.remote.target]||"offline"]+e.hex(e.floor(e.lerp(34,96,this.LerpProgress)),2):(this.json.custom_color||this.defaultColor.toString("#rrggbb"))+e.hex(e.floor(e.lerp(34,96,this.LerpProgress)),2)),e.circle(0,0,this.EllipseSize),!this.isHidden&&this.ThumbnailImage&&e.image(this.ThumbnailImage,0,0,this.EllipseSize,this.EllipseSize),e.push(),this.isHidden||(e.noFill(),this.isAddButton?(e.push(),e.noStroke(),e.fill(255),e.rect(0,0,this.json.shortSide,this.json.longSide),e.rect(0,0,this.json.longSide,this.json.shortSide),e.pop()):(e.stroke(this.json.custom_color||this.defaultColor),e.strokeWeight(this.ProgressWeight)),e.rotate(-e.PI/2),this.LerpProgress<1?e.arc(0,0,this.ProgressCircleSize,this.ProgressCircleSize,0,this.LerpProgress*e.TWO_PI):e.circle(0,0,this.ProgressCircleSize)),e.pop(),!this.isHidden)){let y=.9*this.EllipseSize;this.TextColor=e.color(q.ud?255:0,0==this.LerpProgress?128:255),e.fill(this.TextColor),e.text(this.json.title,0,0,y,y)}e.pop()}CalcPosition(){let l=this.position.dist(J),n=e.map(l,0,this.EllipseSize/8,0,1,!0),a=e.map(n,this.EllipseSize/4,0,1,.95,!0);this.Accel.x=n,this.Accel.y=0;let h=this.position.copy().heading()-e.PI;this.Accel=this.Accel.setHeading(h),this.Velocity.add(this.Accel).mult(a)}OnCollider(){for(let l=0,n=s.length;l<n;l++)if(c[s[l]]!=this){let a=c[s[l]],h=this.position.dist(a.position),d=this.EllipseSize/2+a.EllipseSize/2;h<d&&(te.loop||me==this&&(me=null,e.noLoop()),this.ReflectBounce(a,h/d),a.ReflectBounce(this,h/d))}}ReflectBounce(l,n){let a=ue.Vector.sub(this.position,l.position);this.Velocity.add(a.mult(1-n)).mult(.85)}makeDone(){var l=this;return(0,X.A)(function*(){l.LifeTime=1,yield new Promise(n=>setTimeout(n,500)),l.Velocity=J.copy(),l.Accel=J.copy(),l.OriginalEllipseSize=l.EllipseSize,l.OriginalProgWeight=l.ProgressWeight,l.json.done=!0,Y.push(l),te.loop||e.loop()})()}DoneAnim(){var l=this;return(0,X.A)(function*(){if(te.loop||e.loop(),l.LifeTime-=.04,l.EllipseSize=l.OriginalEllipseSize*l.LifeTime,l.ProgressWeight=l.OriginalProgWeight*l.LifeTime,l.ProgressCircleSize=l.EllipseSize-l.ProgressWeight,l.LifeTime<.5&&W.push(new we(l.position,l.json.custom_color||l.defaultColor)),l.TextColor=e.color(q.ud?255:0,(0==l.LerpProgress?128:255)*l.LifeTime),l.isAddButton&&(l.json.longSide*=l.LifeTime,l.json.shortSide*=l.LifeTime),l.LifeTime<0){te.loop||setTimeout(()=>e.noLoop(),1e3),l.RemoveTodo(),re();for(let n=0;n<20;n++)W.push(new we(l.position,l.json.custom_color||l.defaultColor))}})()}Clicked(){ie&&!O&&!this.json.done&&(this.isAddButton?ee.open_add_todo_page():ee.open_add_todo_page(JSON.stringify(this.json)))}RemoveTodo(){let l=this.json.id;this.json.remote&&(l+=`_${this.json.remote.isOfficial}_${this.json.remote.target}`);for(let n=s.length-1;n>=0;n--)if(s[n]==l){s.splice(n,1);break}for(let n=Y.length-1;n>=0;n--)if(Y[n]=this){Y.splice(n,1);break}delete c[l]}}class we{constructor(l,n){this.RectSize=4,this.rotate=0,this.pos=l.copy(),e.randomSeed(e.random(-255,255)),this.lifeTime=e.random(180,255),this.vel=e.createVector(e.random(-75,75),e.random(-40,-80)),this.acc=e.createVector(0,e.random(-1,-3)),e.push(),e.colorMode(e.HSB);let a=e.hue(n),h=e.saturation(n),d=e.brightness(n);this.color=e.color(e.random(a-20,a+20),e.random(h-20,h+20),e.random(d-20,d+20),this.lifeTime/255),e.pop(),this.RectSize=e.random(3,4),this.rotate=e.random(-e.PI,e.PI)}display(){this.color.setAlpha(this.lifeTime/255),e.fill(this.color),this.CalcPhysics(),e.push(),e.translate(this.pos),e.rotate(this.rotate),e.rect(0,0,this.RectSize,this.RectSize),e.pop(),this.lifeTime--}CalcPhysics(){this.acc.y+=.07,this.vel.add(this.acc),this.pos.add(this.vel.copy().div(100))}}let de,D,Ie,z,pe=0;e.mousePressed=f=>{let l=f.target==document.getElementById("p5todo");if(!O&&l)switch(ie=!0,f.which){case 1:D=e.createVector(e.mouseX,e.mouseY),z=x.copy(),de=e.createVector(e.mouseX,e.mouseY);for(let n=s.length-1;n>=0;n--)if(c[s[n]].position.dist(U())<c[s[n]].EllipseSize/2){c[s[n]].isGrabbed=!0,$=c[s[n]],D=U();break}break;case 2:fe()}},e.mouseDragged=f=>{let l=f.target==document.getElementById("p5todo");if(!O&&l&&1===(this.isPlayingCanvas.loop||e.redraw(),f.which))try{de=e.createVector(e.mouseX,e.mouseY);let n=0;$?($.position=U(),n=D.dist(U())):(x=z.copy().add(de.sub(D).div(k)),n=z.dist(x)),n>15&&(ie=!1)}catch{}},e.mouseReleased=f=>{let l=f.target==document.getElementById("p5todo");!O&&l&&1===f.which&&(de=null,Ae())};let U=(f,l)=>{let n=e.createVector(f||e.mouseX,l||e.mouseY);return n.sub(M),n.div(k),n.sub(x),n};e.mouseWheel=f=>{let l=f.target==document.getElementById("p5todo");!O&&l&&(this.isPlayingCanvas.loop||e.redraw(),k*=f.deltaY<0?1.1:.9,localStorage.setItem("p5todoScale",`${k}`))};let A=[],oe=!1;e.touchStarted=f=>{let l=f.target==document.getElementById("p5todo");if(!O&&l)switch(ie=!0,A=f.touches,oe=!0,A.length){case 1:Re();break;case 2:let n=e.createVector(A[0].clientX,A[0].clientY-56),a=e.createVector(A[1].clientX,A[1].clientY-56);ie=!1,pe=n.dist(a),D=n.copy().add(a).div(2),z=x.copy(),Ie=k,$&&($.isGrabbed=!1,$.Velocity=J.copy(),$.Accel=J.copy(),$=null);break;default:oe=!1,fe()}},e.touchMoved=f=>{let l=f.target==document.getElementById("p5todo");if(!O&&l){switch(this.isPlayingCanvas.loop||e.redraw(),A=f.touches,A.length){case 1:{if(!oe)return;let n=f.changedTouches[0],a=e.createVector(n.clientX,n.clientY-56),h=0;$?($.position=U(),h=D.dist(U(a.x,a.y))):(x=z.copy().add(a.sub(D).div(k)),h=z.dist(x)),h>15&&(ie=!1)}break;case 2:{if(!oe)return;let n=e.createVector(A[0].clientX,A[0].clientY-56),a=e.createVector(A[1].clientX,A[1].clientY-56),h=n.copy().add(a).div(2);k=n.dist(a)/pe*Ie,localStorage.setItem("p5todoScale",`${k}`),x=z.copy().add(h.sub(D).div(k))}}return!1}},e.touchEnded=f=>{let l=f.target==document.getElementById("p5todo");if(!O&&l)switch(A=f.touches,A.length){case 0:Ae(),oe=!1;break;case 1:if(!oe)return;Re(),pe=0}};let Re=()=>{D=e.createVector(A[0].clientX,A[0].clientY-56),z=x.copy();for(let f=s.length-1;f>=0;f--)if(c[s[f]].position.dist(U(D.x,D.y))<c[s[f]].EllipseSize/2){c[s[f]].isGrabbed=!0,$=c[s[f]];break}},$e=()=>{$&&($.isGrabbed=!1,$.Velocity=J.copy(),$.Accel=J.copy(),$=null)},Ae=()=>{$e(),D=null;try{if(z.dist(x)<15)for(let l=s.length-1;l>=0;l--)if(c[s[l]].position.dist(U())<c[s[l]].EllipseSize/2){c[s[l]].Clicked();break}}catch{}}})}ionViewDidEnter(){var g,o;null===(g=(o=this.global).p5todoPlayCanvas)||void 0===g||g.call(o);const T=localStorage.getItem("StartPage")||"0";(!this.nakama.OnInit||"0"==T)&&this.try_add_shortcut()}try_add_shortcut(){this.global.p5KeyShortCut?(this.global.p5KeyShortCut.AddAct=()=>{this.nakama.open_add_todo_page()},this.global.p5KeyShortCut.Backquote=()=>{this.SwitchTargetFilter()},this.global.p5KeyShortCut.Digit=g=>{this.AllCategories[this.TargetFilterName].length>g&&this.ChangeFilterValue(this.AllCategories[this.TargetFilterName][g].value)}):setTimeout(()=>{this.try_add_shortcut()},100)}ionViewWillLeave(){this.global.p5todoStopCanvas&&this.global.p5todoStopCanvas(),this.global.p5KeyShortCut&&(delete this.global.p5KeyShortCut.AddAct,delete this.global.p5KeyShortCut.Backquote,delete this.global.p5KeyShortCut.Digit)}}return(u=j).\u0275fac=function(g){return new(g||u)(t.rXU(q.z3),t.rXU(Ve.y),t.rXU(Se.X),t.rXU(Me.j),t.rXU(De.n),t.rXU(L.hG),t.rXU(Ne.f),t.rXU(Le.r),t.rXU(He.G))},u.\u0275cmp=t.VBU({type:u,selectors:[["app-main"]],viewQuery:function(g,o){if(1&g&&t.GBs(Ge,5),2&g){let T;t.mGM(T=t.lsd())&&(o.LocalToRemoteSel=T.first)}},decls:18,vars:8,consts:[["LocalToRemoteSel",""],[1,"ion-no-border"],[1,"play_button",3,"click"],["button","","style","width: 24px; height: 24px;","name","play-circle",4,"ngIf"],["button","","style","width: 24px; height: 24px;","name","pause-circle",4,"ngIf"],[1,"add_button",3,"click"],["class","shortcut_hint shortcut_top_add",4,"ngIf"],["button","","name","add-circle-outline",2,"width","24px","height","24px"],[1,"header_online_circle",3,"click"],["oncontextmenu","return false;"],[4,"ngIf"],["dismissOnSelect",""],["id","todo",1,"full_screen",2,"overflow","hidden"],["style","position: absolute; top: 16px; left: 16px;",4,"ngIf"],["button","","name","play-circle",2,"width","24px","height","24px"],["button","","name","pause-circle",2,"width","24px","height","24px"],[1,"shortcut_hint","shortcut_top_add"],[1,"disconnect_info",3,"click"],["color","medium","name","create-outline",2,"width","60px","height","60px"],["color","medium"],[4,"ngFor","ngForOf"],["button","",3,"click"],[2,"position","absolute","top","16px","left","16px"],[1,"FilterSwitchButton",3,"click"],["class","shortcut_hint shortcut_todo_categories",4,"ngIf"],[1,"shortcut_hint","shortcut_todo_categories"],[1,"FilterSwitchButton",3,"click","contextmenu","id"],["type","text",3,"input","blur","focus","placeholder"]],template:function(g,o){if(1&g){const T=t.RV6();t.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.k0s(),t.j41(4,"div",2),t.bIt("click",function(){return t.eBV(T),t.Njj(o.toggleCanvasPlaying())}),t.DNE(5,ze,1,0,"ion-icon",3)(6,Ue,1,0,"ion-icon",4),t.k0s(),t.j41(7,"div",5),t.bIt("click",function(){return t.eBV(T),t.Njj(o.nakama.open_add_todo_page())}),t.DNE(8,Xe,2,0,"div",6),t.nrm(9,"ion-icon",7),t.k0s(),t.j41(10,"div",8),t.bIt("click",function(){return t.eBV(T),t.Njj(o.toggle_session())}),t.k0s()()(),t.j41(11,"ion-content",9),t.DNE(12,Ye,6,1,"div",10),t.j41(13,"ion-popover",11,0),t.DNE(15,Je,5,2,"ng-template"),t.k0s(),t.j41(16,"div",12),t.DNE(17,tt,5,3,"div",13),t.k0s()()}2&g&&(t.R7$(3),t.JRh(o.lang.text.Main.Title),t.R7$(2),t.Y8G("ngIf",!o.isPlayingCanvas.loop),t.R7$(),t.Y8G("ngIf",o.isPlayingCanvas.loop),t.R7$(2),t.Y8G("ngIf",o.global.ShowHint),t.R7$(2),t.Aen("background-color: "+o.statusBar.colors[o.statusBar.settings.groupServer]+"; cursor: pointer;"),t.R7$(2),t.Y8G("ngIf",o.isEmptyTodo),t.R7$(5),t.Y8G("ngIf",!o.isEmptyTodo))},dependencies:[he.Sq,he.bT,L.W9,L.eU,L.iq,L.uz,L.Dg,L.he,L.BC,L.ai,L.CF],styles:[".play_button[_ngcontent-%COMP%]{position:absolute;right:116px;top:16px;cursor:pointer}.add_button[_ngcontent-%COMP%]{position:absolute;right:68px;top:16px;cursor:pointer}.FilterSwitchButton[_ngcontent-%COMP%]{padding:8px;border-radius:8px;font-size:16px;background-color:#8888;margin-right:8px;margin-bottom:8px;color:var(--default-text-color-direction)}"]}),j})()},{path:"add-todo-menu",loadChildren:()=>Promise.all([C.e(2076),C.e(8163)]).then(C.bind(C,8163)).then(u=>u.AddTodoMenuPageModule)}];let ot=(()=>{var u;class j{}return(u=j).\u0275fac=function(g){return new(g||u)},u.\u0275mod=t.$C({type:u}),u.\u0275inj=t.G2t({imports:[Te.iI.forChild(it),Te.iI]}),j})(),at=(()=>{var u;class j{}return(u=j).\u0275fac=function(g){return new(g||u)},u.\u0275mod=t.$C({type:u}),u.\u0275inj=t.G2t({imports:[he.MD,Be.YN,L.bv,ot]}),j})()}}]);