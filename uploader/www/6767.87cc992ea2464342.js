"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6767],{6767:(_e,I,l)=>{l.r(I),l.d(I,{ArcadePageModule:()=>ue});var A=l(177),G=l(4341),p=l(5374),C=l(9858),u=l(467),L=l(617),T=l(8326),e=l(3953),S=l(4234),w=l(8065),B=l(4237),$=l(3656),D=l(9347),E=l(482),O=l(755),U=l(9900),V=l(3307);const X=["ArcadeDetail"],N=["ArcadeQRShare"],M=["InAppQRScanner"];function Q(n,g){if(1&n){const i=e.RV6();e.j41(0,"ion-header",9)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s(),e.j41(4,"img",10),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.QuickLinkAct())})("contextmenu",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.QuickLinkContextmenu())}),e.k0s(),e.j41(5,"input",11),e.bIt("change",function(a){e.eBV(i);const r=e.XpG();return e.Njj(r.SelectVoidDrawBackgroundImage(a))}),e.k0s(),e.j41(6,"div",12),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.JoinInstantCall())}),e.nrm(7,"ion-icon",13),e.k0s(),e.j41(8,"div",14),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.JoinSmallTalk())}),e.nrm(9,"ion-icon",15),e.k0s(),e.j41(10,"div",16),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.nakama.toggle_all_session())}),e.k0s()()()}if(2&n){const i=e.XpG();e.R7$(3),e.JRh(i.lang.text.Arcade.Title),e.R7$(7),e.Aen("background-color: "+i.statusBar.colors[i.statusBar.settings.groupServer]+"; cursor: pointer;")}}function Y(n,g){if(1&n&&e.nrm(0,"div"),2&n){const i=e.XpG(2);e.Aen("width: 100%; height: 100%; background-image: url("+i.global.AvatarThumbnailURL+"); background-size: cover; background-position: center; opacity: 0.5;")}}function z(n,g){1&n&&e.nrm(0,"ion-icon",27)}function J(n,g){if(1&n&&e.nrm(0,"div",34),2&n){const i=e.XpG().$implicit;e.Aen("background-image: url("+i.cover+");")}}function W(n,g){if(1&n){const i=e.RV6();e.j41(0,"div",32),e.bIt("click",function(){const a=e.eBV(i).$implicit,r=e.XpG(3);return e.Njj(r.ShowGameInfo(a))}),e.DNE(1,J,1,2,"div",33),e.j41(2,"div",20),e.EFF(3),e.k0s()()}if(2&n){const i=g.$implicit;e.Y8G("hidden",i.hide),e.R7$(),e.Y8G("ngIf",i.cover),e.R7$(2),e.SpI(" ",i.name," ")}}function H(n,g){if(1&n){const i=e.RV6();e.j41(0,"div")(1,"ion-item-divider")(2,"ion-label"),e.EFF(3),e.k0s(),e.j41(4,"div",28),e.nrm(5,"ion-icon",29),e.j41(6,"input",30),e.bIt("input",function(a){e.eBV(i);const r=e.XpG(2);return e.Njj(r.SearchTextInput("official",a))}),e.k0s()()(),e.j41(7,"div",17),e.DNE(8,W,4,3,"div",31),e.k0s()()}if(2&n){const i=e.XpG(2);e.R7$(3),e.JRh(i.lang.text.Arcade.OfficialList),e.R7$(3),e.Y8G("placeholder",i.lang.text.Arcade.Search),e.R7$(2),e.Y8G("ngForOf",i.nakama.ArcadeListOfficial)}}function K(n,g){if(1&n&&e.nrm(0,"div",34),2&n){const i=e.XpG().$implicit;e.Aen("background-image: url("+i.cover+");")}}function Z(n,g){if(1&n){const i=e.RV6();e.j41(0,"div",38),e.bIt("click",function(){const a=e.eBV(i).$implicit,r=e.XpG(3);return e.Njj(r.ShowGameInfo(a))}),e.DNE(1,K,1,2,"div",33),e.j41(2,"div",20),e.EFF(3),e.k0s()()}if(2&n){const i=g.$implicit;e.Y8G("hidden",i.hide),e.R7$(),e.Y8G("ngIf",i.cover),e.R7$(2),e.SpI(" ",i.name," ")}}function q(n,g){if(1&n){const i=e.RV6();e.j41(0,"div")(1,"ion-item-divider")(2,"ion-label"),e.EFF(3),e.k0s(),e.j41(4,"div",28),e.nrm(5,"ion-icon",29),e.j41(6,"input",35),e.bIt("input",function(a){e.eBV(i);const r=e.XpG(2);return e.Njj(r.SearchTextInput("dedicated",a))}),e.k0s()()(),e.j41(7,"div",36),e.DNE(8,Z,4,3,"div",37),e.k0s()()}if(2&n){const i=e.XpG(2);e.R7$(3),e.JRh(i.lang.text.Arcade.DediList),e.R7$(3),e.Y8G("placeholder",i.lang.text.Arcade.Search),e.R7$(2),e.Y8G("ngForOf",i.nakama.ArcadeList)}}function ee(n,g){if(1&n){const i=e.RV6();e.j41(0,"div")(1,"ion-item-divider")(2,"ion-label"),e.EFF(3),e.k0s()(),e.j41(4,"div",17)(5,"div",18),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.LoadCharacter())})("contextmenu",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.LoadCharacterFromLink())}),e.DNE(6,Y,1,2,"div",19),e.j41(7,"div",20),e.DNE(8,z,1,0,"ion-icon",21),e.j41(9,"div")(10,"ion-label",22),e.EFF(11),e.k0s()()()(),e.j41(12,"input",23),e.bIt("change",function(a){e.eBV(i);const r=e.XpG();return e.Njj(r.LoadUserCharacter(a))}),e.k0s(),e.j41(13,"div",18),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.OpenScanner())})("contextmenu",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.OpenQuickLink())}),e.j41(14,"div",20),e.nrm(15,"ion-icon",24),e.j41(16,"div")(17,"ion-label",22),e.EFF(18,"QRCode"),e.k0s()()()(),e.j41(19,"input",25),e.bIt("change",function(a){e.eBV(i);const r=e.XpG();return e.Njj(r.LoadFileFromLocalAct(a))}),e.k0s(),e.j41(20,"div",18),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.LoadFileFromLocal())})("contextmenu",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.LoadFileFromClipboard())}),e.j41(21,"div",20),e.nrm(22,"ion-icon",26),e.j41(23,"div")(24,"ion-label",22),e.EFF(25),e.k0s()()()()(),e.DNE(26,H,9,3,"div",6)(27,q,9,3,"div",6),e.k0s()}if(2&n){const i=e.XpG();e.R7$(3),e.JRh(i.lang.text.Arcade.AddCustom),e.R7$(3),e.Y8G("ngIf",i.global.AvatarThumbnailURL),e.R7$(2),e.Y8G("ngIf",!i.global.AvatarThumbnailURL),e.R7$(3),e.JRh(i.lang.text.Arcade.RegAvatar),e.R7$(14),e.JRh(i.lang.text.Arcade.FromFile),e.R7$(),e.Y8G("ngIf",i.nakama.ArcadeListOfficial.length),e.R7$(),e.Y8G("ngIf",i.nakama.ArcadeList.length)}}function te(n,g){1&n&&(e.j41(0,"div"),e.nrm(1,"div",39),e.k0s())}function ae(n,g){if(1&n){const i=e.RV6();e.j41(0,"ion-item",57),e.bIt("click",function(){const a=e.eBV(i).index,r=e.XpG(3);return e.Njj(r.select_server(a))}),e.j41(1,"ion-label"),e.EFF(2),e.k0s()()}if(2&n){const i=g.$implicit;e.R7$(2),e.JRh(i.name)}}function ie(n,g){if(1&n){const i=e.RV6();e.j41(0,"ion-accordion-group",49,3),e.bIt("click",function(){e.eBV(i);const a=e.XpG(2);return e.Njj(a.isExpanded=!0)}),e.j41(2,"ion-accordion",50)(3,"ion-item",51)(4,"ion-label",52),e.EFF(5),e.k0s(),e.j41(6,"ion-label",53),e.EFF(7),e.k0s(),e.nrm(8,"ion-icon",54),e.k0s(),e.j41(9,"div",55),e.DNE(10,ae,3,1,"ion-item",56),e.k0s()()()}if(2&n){const i=e.XpG(2);e.Y8G("value",i.isExpanded),e.R7$(5),e.JRh(i.lang.text.AddGroup.SelectServer),e.R7$(2),e.JRh(i.servers[i.index].name),e.R7$(3),e.Y8G("ngForOf",i.servers)}}function ne(n,g){1&n&&(e.j41(0,"ion-item",58),e.nrm(1,"ion-input",59),e.k0s())}function re(n,g){if(1&n){const i=e.RV6();e.j41(0,"div",40),e.bIt("click",function(a){e.eBV(i);const r=e.XpG();return e.Njj(r.CheckIfDismissAct(a))}),e.j41(1,"div",41)(2,"div",42)(3,"div",43)(4,"h1"),e.EFF(5),e.k0s(),e.j41(6,"div",44),e.EFF(7),e.k0s(),e.j41(8,"div",45),e.EFF(9),e.k0s(),e.DNE(10,ie,11,4,"ion-accordion-group",46),e.j41(11,"div"),e.DNE(12,ne,2,0,"ion-item",47),e.j41(13,"ion-button",48),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.StartGame())}),e.EFF(14),e.k0s()()()()()()}if(2&n){const i=e.XpG();e.R7$(2),e.Aen(i.TargetArcadeInfo.cover?"background-image: url("+i.TargetArcadeInfo.cover+"); background-size: cover; background-position: center;":""),e.R7$(3),e.JRh(i.TargetArcadeInfo.name),e.R7$(2),e.SpI(" ",i.lang.text.Arcade.GameLang+": "+i.TargetArcadeInfo.lang," "),e.R7$(2),e.SpI(" ",i.TargetArcadeInfo.desc," "),e.R7$(),e.Y8G("ngIf",i.servers.length),e.R7$(2),e.Y8G("ngIf",0==i.index),e.R7$(),e.Y8G("disabled",!i.servers.length),e.R7$(),e.SpI(" ",i.lang.text.Arcade.StartGame," ")}}function oe(n,g){if(1&n){const i=e.RV6();e.j41(0,"img",65),e.bIt("click",function(){e.eBV(i);const a=e.XpG(2);return e.Njj(a.copy_address(a.global.ArcadeQRAddress))}),e.k0s()}if(2&n){const i=e.XpG(2);e.Y8G("src",i.global.ArcadeQRCodeSRC,e.B4B)}}function ce(n,g){if(1&n){const i=e.RV6();e.j41(0,"div",60),e.bIt("click",function(a){e.eBV(i);const r=e.XpG();return e.Njj(r.CheckIfDismissAct(a))}),e.j41(1,"div",61)(2,"div",62),e.DNE(3,oe,1,1,"img",63),e.j41(4,"ion-item",57),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.copy_address(a.global.ArcadeQRAddress))}),e.j41(5,"ion-label",64),e.EFF(6),e.k0s()()()()()}if(2&n){const i=e.XpG();e.R7$(3),e.Y8G("ngIf",i.global.ArcadeQRCodeSRC),e.R7$(3),e.JRh(i.global.ArcadeQRAddress)}}function le(n,g){if(1&n&&(e.j41(0,"ion-label",73),e.EFF(1),e.k0s()),2&n){const i=e.XpG(2);e.R7$(),e.JRh(i.lang.text.Subscribes.QRScanPlaceholder)}}function se(n,g){if(1&n&&(e.j41(0,"ion-label",64),e.EFF(1),e.k0s()),2&n){const i=e.XpG(2);e.R7$(),e.JRh(i.QRScanResult)}}function de(n,g){if(1&n){const i=e.RV6();e.j41(0,"div",66),e.bIt("click",function(a){e.eBV(i);const r=e.XpG();return e.Njj(r.CheckIfDismissAct(a))}),e.j41(1,"div",61)(2,"div",67)(3,"div",68),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.ChangeScanDevice())}),e.nrm(4,"ion-icon",69),e.k0s(),e.nrm(5,"iframe",70),e.j41(6,"ion-item",57),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.copy_address(a.QRScanResult))}),e.DNE(7,le,2,1,"ion-label",71)(8,se,2,1,"ion-label",72),e.k0s()()()()}if(2&n){const i=e.XpG();e.R7$(7),e.Y8G("ngIf",!i.QRScanResult),e.R7$(),e.Y8G("ngIf",i.QRScanResult)}}const ge=[{path:"",component:(()=>{var n;class g{constructor(t,a,r,c,o,s,d,_,f,m,x){this.lang=t,this.statusBar=a,this.nakama=r,this.navCtrl=c,this.client=o,this.global=s,this.indexed=d,this.animationCtrl=_,this.p5toast=f,this.p5loading=m,this.alertCtrl=x,this.WillLeave=!1,this.TargetArcadeInfo={},this.servers=[],this.index=0,this.isExpanded=!1,this.enterAnimation=v=>{const h=v.shadowRoot,k=this.animationCtrl.create().addElement(h.querySelector("ion-backdrop")).fromTo("opacity","0.01","var(--backdrop-opacity)"),b=this.animationCtrl.create().addElement(h.querySelector(".modal-wrapper")).keyframes([{offset:0,opacity:"0",transform:"scale(0)"},{offset:1,opacity:"1",transform:"scale(1)"}]);return this.animationCtrl.create().addElement(v).easing("ease-out").duration(250).addAnimation([k,b])},this.leaveAnimation=v=>this.enterAnimation(v).direction("reverse")}ngOnInit(){this.loadAvatarImage()}loadAvatarImage(){var t=this;return(0,u.A)(function*(){try{const a=yield t.indexed.loadBlobFromUserPath("servers/self/avatar.pck_thumbnail.png","image/png");t.global.AvatarThumbnailURL=URL.createObjectURL(a),setTimeout(()=>{URL.revokeObjectURL(t.global.AvatarThumbnailURL)},1e3)}catch{try{(yield t.indexed.checkIfFileExist("servers/self/avatar.pck"))&&(t.global.AvatarThumbnailURL="about:blank")}catch(r){console.log("\uc544\ubc14\ud0c0 \uc5c6\uc74c: ",r)}}})()}ionViewWillEnter(){var t=this;return(0,u.A)(function*(){if(t.WillLeave=!1,!t.nakama.ArcadeListOfficial.length)try{let a=yield fetch("https://is2you2.github.io/pjcone_arcade.json");if(!a.ok)throw a;{let r=yield a.json();t.nakama.ArcadeListOfficial=r}}catch(a){console.log("\uacf5\uc2dd \uc544\ucf00\uc774\ub4dc \ub9ac\uc2a4\ud2b8 \ubd88\ub7ec\uc624\uae30 \uc2e4\ud328: ",a)}})()}ionViewDidEnter(){this.global.ArcadeObject.QRCode||(this.global.ArcadeObject.QRCode=this.ArcadeQRShare);try{const t=document.getElementById("official_filter");t.onfocus||(t.onfocus=()=>{this.global.BlockMainShortcut=!0}),t.onblur||(t.onblur=()=>{this.global.BlockMainShortcut=!0})}catch{}try{const t=document.getElementById("dedicated_filter");t.onfocus||(t.onfocus=()=>{this.global.BlockMainShortcut=!0}),t.onblur||(t.onblur=()=>{this.global.BlockMainShortcut=!0})}catch{}}WaitingCurrent(){var t=this;return(0,u.A)(function*(){for(;t.WillLeave;)yield new Promise(a=>setTimeout(a,0))})()}ionViewWillLeave(){this.global.RestoreShortCutAct("arcade-fileviewer"),this.global.ToggleFullScreen(!1),this.WillLeave=!0}QuickLinkAct(){this.global.PageDismissAct["voiddraw-remote"]=t=>{delete this.global.PageDismissAct["voiddraw-remote"]},this.global.ActLikeModal("portal/arcade/void-draw",{dismiss:"voiddraw-remote"})}CheckIfDismissAct(t){switch(t.target.id){case"arcade_detail":this.ArcadeDetail.dismiss();break;case"inapp_qrscanner":this.InAppQRScanner.dismiss();break;case"arcade_qrmodal":this.ArcadeQRShare.dismiss()}}SearchTextInput(t,a){let r=[];switch(t){case"official":r=this.nakama.ArcadeListOfficial;break;case"dedicated":r=this.nakama.ArcadeList}for(let c of r){let o=c.name;for(let d of c.searchKey||[])o+=d;const s=o.toLowerCase().indexOf(a.target.value.toLowerCase())<0;c.hide=s}}LoadFileFromLocal(){document.getElementById("arcade_file_load").click()}LoadFileFromLocalAct(t){var a=this;return(0,u.A)(function*(){let r,c=[];try{for(let o=0,s=t.target.files.length;o<s;o++){let d={};d.filename=t.target.files[o].name,d.file_ext=t.target.files[o].name.split(".").pop()||t.target.files[o].type||a.lang.text.ChatRoom.unknown_ext,d.size=t.target.files[o].size,d.type=t.target.files[o].type||t.target.files[o].type_override,d.blob=t.target.files[o],a.global.set_viewer_category_from_ext(d),d.path=`tmp_files/arcade/[${o}] ${t.target.files[o].name}`,yield a.indexed.saveBlobToUserPath(t.target.files[o],d.path),r||(r=d),c.push({content:d})}}catch(o){a.p5toast.show({text:`${a.lang.text.Arcade.InputError}: ${o}`}),console.log("\uc544\ucf00\uc774\ub4dc \ud30c\uc77c \uc785\ub825 \uc2e4\ud328: ",o)}a.global.PageDismissAct["arcade-fileviewer"]=o=>{a.global.RestoreShortCutAct("arcade-fileviewer"),a.indexed.GetFileListFromDB("tmp_files/arcade/").then(s=>{s.forEach(d=>a.indexed.removeFileFromUserPath(d))}),delete a.global.PageDismissAct["arcade-fileviewer"]},a.global.StoreShortCutAct("arcade-fileviewer"),a.global.ActLikeModal("portal/arcade/ionic-viewer",{info:{content:r},relevance:c,noEdit:!0,noTextEdit:!0,quick:!0,dismiss:"arcade-fileviewer"}),document.getElementById("arcade_file_load").value=null})()}LoadFileFromClipboard(){var t=this;return function(){var r=(0,u.A)(function*(){let c=yield t.global.GetValueFromClipboard();switch(c.type){case"text/plain":{t.global.PageDismissAct["arcade-clipboard"]=s=>{t.global.RestoreShortCutAct("arcade-fileviewer"),delete t.global.PageDismissAct["arcade-clipboard"]};let o={};o.filename=c.value.split("/").pop(),o.file_ext=o.filename.split(".").pop(),o.url=c.value,o.path=`tmp_files/arcade/${o.filename}`,o.type="html"==o.file_ext?"text/html":o.type,t.global.set_viewer_category_from_ext(o),t.global.StoreShortCutAct("arcade-fileviewer"),t.global.ActLikeModal("portal/arcade/ionic-viewer",{info:{content:o},relevance:[{content:o}],noEdit:!0,noTextEdit:!0,quick:!0,dismiss:"arcade-clipboard"})}break;case"image/png":t.LoadFileFromLocalAct({target:{files:[c.value]}});break;default:console.log("\uc544\ucf00\uc774\ub4dc-\ud074\ub9bd\ubcf4\ub4dc\ub85c\ubd80\ud130 \ud30c\uc77c \uc77d\uae30 \uc624\ub958: ",c.value),t.LoadFileFromLocal()}});return function(){return r.apply(this,arguments)}}()(),!1}ShowGameInfo(t){this.TargetArcadeInfo=t,this.ArcadeDetail.onDidDismiss().then(()=>{this.TargetArcadeInfo={},this.global.RestoreShortCutAct("arcade_detail")}),this.servers=this.nakama.get_all_server_info(!0,!0),this.servers.unshift({name:this.lang.text.voidDraw.LocalAddrInput,isOfficial:"local",target:"target",local:!0}),this.index=Math.max(0,Math.min(this.servers.length-1,1)),this.global.StoreShortCutAct("arcade_detail"),this.ArcadeDetail.present()}select_server(t){this.index=t,this.isExpanded=!1}StartGame(){var t=this;return(0,u.A)(function*(){const a=JSON.parse(JSON.stringify(t.TargetArcadeInfo));if(!t.nakama.users.self.display_name)try{if(yield new Promise(function(){var c=(0,u.A)(function*(o){let s="";const d=yield t.alertCtrl.create({header:"\uc0ac\uc6a9\uc790 \uc774\ub984 \uc791\uc131",inputs:[{placeholder:"\ub2c9\ub124\uc784 \uc785\ub825",type:"text"}],buttons:[{text:"\ud655\uc778",handler:_=>{s=_[0]}}]});d.onDidDismiss().then(()=>{t.nakama.users.self.display_name=s,t.nakama.save_self_profile(),o(void 0)}),d.present()});return function(o){return c.apply(this,arguments)}}()),!t.nakama.users.self.display_name)throw"\ub2c9\ub124\uc784 \uc9c0\uc815\ub418\uc9c0 \uc54a\uc74c"}catch(c){return void t.p5toast.show({text:`\uac8c\uc784 \uc2dc\uc791 \uc624\ub958: ${c}`})}yield t.ArcadeDetail.dismiss(),yield t.global.CreateArcadeFrame({url:a.url}),t.global.CreateInfoSocket(a.url);const r=yield t.indexed.checkIfFileExist("servers/self/avatar.pck");console.log("\uc0ac\uc6a9\uc790 \uc544\ubc14\ud0c0 \uc5ec\ubd80: ",r),console.log("\uc2dc\uc791 \ubc84\ud2bc \ub20c\ub9bc: \uc774\ub984 \uc788\uc74c")})()}QuickLinkContextmenu(){var t=this;return function(){var r=(0,u.A)(function*(){let c=yield t.global.GetValueFromClipboard();"image/png"===c.type?t.SelectVoidDrawBackgroundImage({target:{files:[c.value]}}):document.getElementById("arcade_voiddraw_img").click()});return function(){return r.apply(this,arguments)}}()(),!1}SelectVoidDrawBackgroundImage(t){var a=this;return(0,u.A)(function*(){const r=t.target.files[0],c=`tmp_files/quick_act/${r.name}`;yield a.indexed.saveBlobToUserPath(r,c);let o=yield a.indexed.loadBlobFromUserPath(c,r.type);const s=URL.createObjectURL(o);new T(d=>{d.setup=()=>{document.getElementById("arcade_voiddraw_img").value="",d.noCanvas(),d.loadImage(s,_=>{a.global.PageDismissAct["voiddraw-remote"]=f=>{delete a.global.PageDismissAct["voiddraw-remote"]},a.global.ActLikeModal("portal/arcade/void-draw",{path:c,width:_.width,height:_.height,type:r.type,dismiss:"voiddraw-remote"}),URL.revokeObjectURL(s),d.remove()},_=>{console.log("\ube60\ub978 \ud3b8\uc9d1\uae30 \uc774\ub3d9 \uc2e4\ud328: ",_),URL.revokeObjectURL(s),d.remove()})}})})()}JoinSmallTalk(){"online"!=this.statusBar.settings.dedicated_groupchat&&"certified"!=this.statusBar.settings.dedicated_groupchat&&(this.statusBar.settings.dedicated_groupchat="pending"),this.client.RejoinGroupChat()}JoinInstantCall(){this.navCtrl.navigateForward("portal/arcade/instant-call",{animation:L.NC})}copy_address(t){this.global.WriteValueToClipboard("text/plain",t)}LoadCharacter(){var t=this;return(0,u.A)(function*(){if(t.global.AvatarThumbnailURL){const r=t.nakama.get_all_server_info(!0,!0);for(let c of r)try{var a;const s=null===(a=(yield t.nakama.servers[c.isOfficial][c.target].client.readStorageObjects(t.nakama.servers[c.isOfficial][c.target].session,{object_ids:[{collection:"user_public",key:"avatar",user_id:t.nakama.servers[c.isOfficial][c.target].session.user_id}]})).objects)||void 0===a||null===(a=a[0])||void 0===a||null===(a=a.value)||void 0===a?void 0:a.data;yield t.global.remove_file_from_storage(s.url,{apache_port:c.apache_port,cdn_port:c.cdn_port,user_id:t.nakama.servers[c.isOfficial][c.target].session.user_id}),yield t.global.remove_file_from_storage(s.thumbnail,{apache_port:c.apache_port,cdn_port:c.cdn_port,user_id:t.nakama.servers[c.isOfficial][c.target].session.user_id}),yield t.nakama.servers[c.isOfficial][c.target].client.deleteStorageObjects(t.nakama.servers[c.isOfficial][c.target].session,{object_ids:[{collection:"user_public",key:"avatar"}]})}catch(o){t.p5toast.show({text:`${t.lang.text.AdminTools.FailedClear}: ${o}`,lateable:!0})}t.indexed.removeFileFromUserPath("servers/self/avatar.pck"),t.indexed.removeFileFromUserPath("servers/self/avatar.pck_thumbnail.png"),t.global.AvatarThumbnailURL=null}else document.getElementById("avatar_file_load").click()})()}LoadUserCharacter(t){var a=this;const r=t.target.files[0];this.global.PageDismissAct["arcade-character-set"]=function(){var o=(0,u.A)(function*(s){yield a.WaitingCurrent(),a.global.ArcadeWithFullScreen=!1,a.loadAvatarImage(),a.global.RestoreShortCutAct("arcade-character-set"),delete a.global.PageDismissAct["arcade-character-set"]});return function(s){return o.apply(this,arguments)}}();let c={creator_name:"",character_name:"",file:r};this.global.StoreShortCutAct("arcade-character-set"),this.global.ActLikeModal("portal/arcade/register-character",{info:c,dismiss:"arcade-character-set"}),document.getElementById("avatar_file_load").value=null,setTimeout(()=>{this.global.CreateGodotIFrameWithDuplicateAct({blob:c.file},"avatar_sample",{path:"tmp_files/duplicate/arcade_avatar.pck",model:!0,success:(s,d)=>{c.creator_name=s,c.character_name=d}},void 0,()=>{this.navCtrl.pop()})},100)}LoadCharacterFromLink(){var t=this;return function(){var r=(0,u.A)(function*(){const c="AvatarLink",o=yield t.global.GetValueFromClipboard(c);if("text/plain"===o.type)try{const s=o.value.split(".").pop();if("pck"!=s)throw`${t.lang.text.RegAvatar.wrong_ext}: ${s}`;const d=yield t.global.downloadWithProgressAsBlob(o.value);t.LoadUserCharacter({target:{files:[d]}})}catch(s){console.log("\uc8fc\uc18c\ub85c\ubd80\ud130 \ubd88\ub7ec\uc624\uae30 \uc2e4\ud328: ",s),t.p5loading.update({id:c,message:s,progress:0,forceEnd:350})}});return function(){return r.apply(this,arguments)}}()(),!1}OpenScanner(){var t=this;return(0,u.A)(function*(){const a=`arcade_OpenScanner_${Date.now()}`;yield t.p5loading.update({id:a,message:t.lang.text.Arcade.OpeningCamera,forceEnd:null}),t.QRScanResult=null,t.global.StoreShortCutAct("qrcode-scanner");let c=yield(yield fetch("assets/p5js/zxing_scanner.js")).blob(),o=URL.createObjectURL(c),d=yield(yield fetch("assets/p5js/libraries/p5.min.js")).blob(),_=URL.createObjectURL(d),m=yield(yield fetch("assets/p5js/libraries/zxing@0.21.3.min.js")).blob(),x=URL.createObjectURL(m),h=yield(yield fetch("assets/p5js/zxing.html")).text();h=h.replace('<script language="javascript" type="text/javascript" src="libraries/p5.min.js"><\/script>',`<script language="javascript" type="text/javascript" src="${_}"><\/script>`).replace('<script language="javascript" type="text/javascript" src="libraries/zxing@0.21.3.min.js"><\/script>',`<script language="javascript" type="text/javascript" src="${x}"><\/script>`).replace('<script language="javascript" type="text/javascript" src="zxing_scanner.js"><\/script>',`<script language="javascript" type="text/javascript" src="${o}"><\/script>`);let k=new Blob([h],{type:"text/html"}),b=URL.createObjectURL(k);t.InAppQRScanner.onDidDismiss().then(()=>{URL.revokeObjectURL(b),URL.revokeObjectURL(o),URL.revokeObjectURL(_),URL.revokeObjectURL(x),t.ChangeDeviceFunc=null,t.global.RestoreShortCutAct("qrcode-scanner")}),yield t.InAppQRScanner.present(),t.p5loading.remove(a);let R=document.getElementById("qr_scan_frame");R.src=b;let j=R.contentWindow||R.contentDocument;setTimeout(()=>{t.ChangeDeviceFunc=j.ChangeDevice,j.load_failed=y=>{t.p5toast.show({text:`${t.lang.text.Subscribes.QRScanInitFailed}: ${y}`}),t.InAppQRScanner.dismiss()},j.scan_result=function(){var y=(0,u.A)(function*(F){try{t.QRScanResult=F.text,t.QRScanResult&&(yield t.nakama.open_url_link(t.QRScanResult,!1))&&t.InAppQRScanner.dismiss()}catch(P){console.log("QR\uc2a4\uce94 \uc2e4\ud328: ",P)}});return function(F){return y.apply(this,arguments)}}()},1e3)})()}ChangeScanDevice(){this.ChangeDeviceFunc&&this.ChangeDeviceFunc()}OpenQuickLink(){var t=this;const a=`arcade_OpenQuickLink_${Date.now()}`;return function(){var c=(0,u.A)(function*(){const o=yield t.global.GetValueFromClipboard(a);switch(o.type){case"text/plain":const s=o.value,d=t.global.GetConnectedAddress(),_=yield t.global.GetHeaderAddress();if(0==s.indexOf("https://is2you2.github.io/pjcone_pwa/?")||0==s.indexOf(`${d}?`)||0==s.indexOf(`${_}?`)){const f=t.global.CatchGETs(s)||{};try{const m=yield t.nakama.AddressToQRCodeAct(f,!0);yield t.nakama.act_from_QRInfo(m,"portal/arcade/")}catch(m){console.log("open_url_link: ",m),t.p5toast.show({text:`${t.lang.text.AddGroup.DiffFormat}: ${m}`})}}else t.p5loading.update({id:a,message:`${t.lang.text.AddGroup.DiffFormat}: ${s}`,progress:0});break;case"image/png":t.LoadFileFromLocalAct({target:{files:[o.value]}});break;case"error":t.p5toast.show({text:`${t.lang.text.GlobalAct.FailedToReadClipboard}: ${o.value}`})}});return function(){return c.apply(this,arguments)}}()(),!1}}return(n=g).\u0275fac=function(t){return new(t||n)(e.rXU(S.y),e.rXU(w.j),e.rXU(B.X),e.rXU($.q9),e.rXU(D.z),e.rXU(E.z3),e.rXU(O.n),e.rXU(p.Hx),e.rXU(U.G),e.rXU(V.f),e.rXU(p.hG))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-arcade"]],viewQuery:function(t,a){if(1&t&&(e.GBs(X,5),e.GBs(N,5),e.GBs(M,5)),2&t){let r;e.mGM(r=e.lsd())&&(a.ArcadeDetail=r.first),e.mGM(r=e.lsd())&&(a.ArcadeQRShare=r.first),e.mGM(r=e.lsd())&&(a.InAppQRScanner=r.first)}},decls:13,vars:6,consts:[["ArcadeDetail",""],["ArcadeQRShare",""],["InAppQRScanner",""],["ArcadePlayServer",""],["class","ion-no-border",4,"ngIf"],[3,"fullscreen"],[4,"ngIf"],[1,"transparent-modal",3,"enterAnimation","leaveAnimation"],[1,"transparent-modal"],[1,"ion-no-border"],["src","assets/icon/voidDraw.png",1,"add_group","top_icon_override_2",2,"width","32px","height","32px",3,"click","contextmenu"],["hidden","","type","file","id","arcade_voiddraw_img","accept","image/*",3,"change"],[1,"add_group","top_icon_override_1",3,"click"],["button","","name","call-outline",2,"width","24px","height","24px"],[1,"add_group",3,"click"],["button","","name","chatbubbles-outline",2,"width","24px","height","24px"],[1,"header_online_circle",3,"click"],[1,"fixed_btn_size"],[1,"list_ele","list_add_btn",3,"click","contextmenu"],[3,"style",4,"ngIf"],[1,"disconnect_info"],["style","width: 36px; height: 36px;","color","medium","name","person-circle-outline",4,"ngIf"],["color","medium"],["hidden","","type","file","id","avatar_file_load","accept",".pck",3,"change"],["color","medium","name","qr-code-outline",2,"width","36px","height","36px"],["hidden","","type","file","id","arcade_file_load","multiple","","accept","*",3,"change"],["color","medium","name","document-outline",2,"width","36px","height","36px"],["color","medium","name","person-circle-outline",2,"width","36px","height","36px"],[2,"position","absolute","right","16px"],["name","search-outline",2,"margin-right","8px","cursor","pointer"],["id","official_filter","type","text",1,"searchInput",3,"input","placeholder"],["class","list_ele list_add_btn",3,"hidden","click",4,"ngFor","ngForOf"],[1,"list_ele","list_add_btn",3,"click","hidden"],["class","cover_image",3,"style",4,"ngIf"],[1,"cover_image"],["id","dedicated_filter","type","text",1,"searchInput",3,"input","placeholder"],[1,"list_form"],["class","list_ele",3,"hidden","click",4,"ngFor","ngForOf"],[1,"list_ele",3,"click","hidden"],["id","arcade_pck_loaded",1,"full_screen",2,"position","fixed"],["id","arcade_detail",1,"OutterModal",3,"click"],[2,"justify-content","center","align-items","center","overflow-y","auto"],[1,"arcade_modal"],[2,"display","flex","flex-direction","column","width","100%","height","100%","background-color","var(--arcade-detail-modal)","padding","16px","border-radius","16px"],[2,"text-align","start","margin","8px 0px"],[2,"text-align","start","flex-grow","1","overflow-y","scroll"],["value","colors","expand","inset",3,"value","click",4,"ngIf"],["style","margin-bottom: 8px;",4,"ngIf"],[1,"ion-align-self-center",3,"click","disabled"],["value","colors","expand","inset",3,"click","value"],["value","colors"],["slot","header"],[2,"display","contents"],[1,"ion-text-right"],[1,"ion-accordion-toggle-icon","hide_accordion_icon"],["slot","content"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"],[2,"margin-bottom","8px"],["label","\uc8fc\uc18c \uc9c1\uc811 \uc785\ub825","type","text","placeholder","(wss://)0.0.0.0",1,"ion-text-end"],["id","arcade_qrmodal",1,"OutterModal",3,"click"],[2,"display","flex","justify-content","center","align-items","center"],[2,"width","400px","min-height","455px","background-color","var(--chatroom-background)","text-align","center","padding","16px"],["style","width: 100%; height: auto; cursor: copy; margin-bottom: 8px;","alt","ArcadeQuickLink",3,"src","click",4,"ngIf"],[1,"ion-text-center"],["alt","ArcadeQuickLink",2,"width","100%","height","auto","cursor","copy","margin-bottom","8px",3,"click","src"],["id","inapp_qrscanner",1,"OutterModal",3,"click"],[2,"width","400px","min-height","455px","background-color","var(--chatroom-background)","text-align","center","padding","16px","position","relative"],[2,"position","absolute","width","64px","height","64px","cursor","pointer","margin","16px","background-color","#8888","border-radius","24px","top","0","right","0","text-align","center","align-content","center",3,"click"],["name","camera-reverse-outline",2,"width","36px","height","36px"],["id","qr_scan_frame","frameborder","0",2,"width","100%","height","368px","margin-bottom","8px"],["class","ion-text-center","color","medium",4,"ngIf"],["class","ion-text-center",4,"ngIf"],["color","medium",1,"ion-text-center"]],template:function(t,a){1&t&&(e.DNE(0,Q,11,3,"ion-header",4),e.j41(1,"ion-content",5),e.DNE(2,ee,28,7,"div",6)(3,te,2,0,"div",6),e.j41(4,"ion-modal",7,0),e.DNE(6,re,15,9,"ng-template"),e.k0s(),e.j41(7,"ion-modal",8,1),e.DNE(9,ce,7,2,"ng-template"),e.k0s(),e.j41(10,"ion-modal",8,2),e.DNE(12,de,9,2,"ng-template"),e.k0s()()),2&t&&(e.Y8G("ngIf",!a.global.ArcadeLoaded),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(),e.Y8G("ngIf",!a.global.ArcadeLoaded),e.R7$(),e.Y8G("ngIf",a.global.ArcadeLoaded),e.R7$(),e.Y8G("enterAnimation",a.enterAnimation)("leaveAnimation",a.leaveAnimation))},dependencies:[A.Sq,A.bT,p.xk,p.YH,p.Jm,p.W9,p.eU,p.iq,p.$w,p.uz,p.Dg,p.he,p.BC,p.ai,p.Sb,p.Gw],styles:[".list_form[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(135px,1fr));padding:16px;gap:16px}.list_add_btn[_ngcontent-%COMP%]{flex:0 1}.fixed_btn_size[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:16px;overflow-x:auto;margin:16px 16px 0;padding-bottom:16px}.searchInput[_ngcontent-%COMP%]{border:none;border-bottom:1px solid;outline:none}.cover_image[_ngcontent-%COMP%]{width:100%;height:100%;background-size:cover;background-position:center;opacity:.35}.arcade_modal[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:400px;height:455px;background-color:var(--chatroom-background);text-align:center;border-radius:16px}.list_ele[_ngcontent-%COMP%]{overflow:hidden;cursor:pointer;border:1px solid var(--list-shortcut-hint-background);border-radius:8px;min-width:135px;min-height:90px;text-align:center;align-content:center;position:relative}.add_group[_ngcontent-%COMP%]{position:absolute;right:68px;top:16px;cursor:pointer}.top_icon_override_1[_ngcontent-%COMP%]{right:116px}.top_icon_override_2[_ngcontent-%COMP%]{right:164px;top:13px}"]}),g})()},{path:"instant-call",loadChildren:()=>l.e(6524).then(l.bind(l,6524)).then(n=>n.InstantCallPageModule)},{path:"void-draw",loadChildren:()=>l.e(2655).then(l.bind(l,2655)).then(n=>n.VoidDrawPageModule)},{path:"ionic-viewer",loadChildren:()=>Promise.all([l.e(4803),l.e(222)]).then(l.bind(l,4803)).then(n=>n.IonicViewerPageModule)},{path:"post-viewer",loadChildren:()=>Promise.all([l.e(222),l.e(526)]).then(l.bind(l,526)).then(n=>n.PostViewerPageModule)},{path:"register-character",loadChildren:()=>l.e(4168).then(l.bind(l,4168)).then(n=>n.RegisterCharacterPageModule)}];let pe=(()=>{var n;class g{}return(n=g).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[C.iI.forChild(ge),C.iI]}),g})(),ue=(()=>{var n;class g{}return(n=g).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[A.MD,G.YN,p.bv,pe]}),g})()}}]);