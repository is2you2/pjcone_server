"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6524],{6524:(Wt,F,_)=>{_.r(F),_.d(F,{InstantCallPageModule:()=>At});var k=_(177),M=_(4341),C=_(5374),P=_(9858),w=_(467),x=_(9969),N=_(617),W=_(5402),D=_(8326),B=_(92),T=_(7100),X=_(6514),t=_(3953),O=_(4234),Y=_(4020),Q=_(345),L=_(4237),U=_(9900),H=_(3307),J=_(3656),z=_(7476),q=_(5547);const K=["InstantCallServer"],Z=["InstCallQRShare"],$=["ChatInput"];function tt(l,r){if(1&l){const i=t.RV6();t.j41(0,"ion-icon",13),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.SwapRemoteCamera())}),t.k0s()}}function et(l,r){if(1&l){const i=t.RV6();t.j41(0,"ion-icon",14),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.OpenInstcallQRCode())}),t.k0s()}}function it(l,r){if(1&l){const i=t.RV6();t.j41(0,"ion-icon",15),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.toggleMainVideoExtend())}),t.k0s()}}function nt(l,r){if(1&l&&(t.j41(0,"ion-select-option",26),t.EFF(1),t.k0s()),2&l){const i=r.$implicit;t.Y8G("value",i),t.R7$(),t.JRh(i.info.name)}}function lt(l,r){if(1&l){const i=t.RV6();t.j41(0,"ion-item")(1,"ion-select",23,1),t.bIt("ionChange",function(e){t.eBV(i);const a=t.XpG(2);return t.Njj(a.SelectAddressTarget(e))}),t.j41(3,"ion-select-option",24),t.EFF(4),t.k0s(),t.DNE(5,nt,2,2,"ion-select-option",25),t.k0s()()}if(2&l){const i=t.XpG(2);t.R7$(),t.Y8G("label",i.lang.text.AddGroup.SelectServer),t.R7$(3),t.JRh(i.lang.text.voidDraw.InternalConn),t.R7$(),t.Y8G("ngForOf",i.ServerList)}}function at(l,r){if(1&l){const i=t.RV6();t.j41(0,"ion-item")(1,"ion-input",27),t.mxI("ngModelChange",function(e){t.eBV(i);const a=t.XpG(2);return t.DH7(a.UserInputCustomAddress,e)||(a.UserInputCustomAddress=e),t.Njj(e)}),t.k0s(),t.j41(2,"ion-icon",28),t.bIt("click",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.global.open_custom_site(e.UserInputCustomAddress))}),t.k0s()()}if(2&l){const i=t.XpG(2);t.R7$(),t.Y8G("label",i.lang.text.voidDraw.InputAddress),t.R50("ngModel",i.UserInputCustomAddress)}}function st(l,r){if(1&l){const i=t.RV6();t.j41(0,"ion-item")(1,"ion-input",29),t.mxI("ngModelChange",function(e){t.eBV(i);const a=t.XpG(2);return t.DH7(a.Port,e)||(a.Port=e),t.Njj(e)}),t.k0s()()}if(2&l){const i=t.XpG(2);t.R7$(),t.Y8G("label",i.lang.text.GroupServer.WebRTCPort),t.R50("ngModel",i.Port),t.Y8G("placeholder",i.lang.text.Settings.joinDedi_placeholder+" (3478)")}}function ot(l,r){if(1&l){const i=t.RV6();t.j41(0,"ion-item")(1,"ion-input",29),t.mxI("ngModelChange",function(e){t.eBV(i);const a=t.XpG(2);return t.DH7(a.signalPort,e)||(a.signalPort=e),t.Njj(e)}),t.k0s()()}if(2&l){const i=t.XpG(2);t.R7$(),t.Y8G("label",i.lang.text.GroupServer.SquarePort),t.R50("ngModel",i.signalPort),t.Y8G("placeholder",i.lang.text.Settings.joinDedi_placeholder+" (12013)")}}function rt(l,r){if(1&l){const i=t.RV6();t.j41(0,"ion-item")(1,"ion-input",29),t.mxI("ngModelChange",function(e){t.eBV(i);const a=t.XpG(2);return t.DH7(a.Username,e)||(a.Username=e),t.Njj(e)}),t.k0s()()}if(2&l){const i=t.XpG(2);t.R7$(),t.Y8G("label",i.lang.text.WebRTCDevManager.Username),t.R50("ngModel",i.Username),t.Y8G("placeholder",i.lang.text.Settings.joinDedi_placeholder+" (username)")}}function ct(l,r){if(1&l){const i=t.RV6();t.j41(0,"ion-item")(1,"ion-input",29),t.mxI("ngModelChange",function(e){t.eBV(i);const a=t.XpG(2);return t.DH7(a.Password,e)||(a.Password=e),t.Njj(e)}),t.k0s()()}if(2&l){const i=t.XpG(2);t.R7$(),t.Y8G("label",i.lang.text.WebRTCDevManager.Credential),t.R50("ngModel",i.Password),t.Y8G("placeholder",i.lang.text.Settings.joinDedi_placeholder+" (password)")}}function dt(l,r){if(1&l){const i=t.RV6();t.j41(0,"ion-item",30),t.bIt("ionChange",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.toggleUseCCTV())}),t.j41(1,"ion-toggle",18),t.mxI("ngModelChange",function(e){t.eBV(i);const a=t.XpG(2);return t.DH7(a.global.useCCTV,e)||(a.global.useCCTV=e),t.Njj(e)}),t.EFF(2),t.k0s()()}if(2&l){const i=t.XpG(2);t.R7$(),t.R50("ngModel",i.global.useCCTV),t.R7$(),t.JRh(i.lang.text.InstantCall.useAsCCVideo)}}function gt(l,r){if(1&l){const i=t.RV6();t.j41(0,"div",16),t.DNE(1,lt,6,3,"ion-item",11)(2,at,3,2,"ion-item",11)(3,st,2,3,"ion-item",11)(4,ot,2,3,"ion-item",11)(5,rt,2,3,"ion-item",11)(6,ct,2,3,"ion-item",11),t.j41(7,"ion-item",17)(8,"ion-toggle",18),t.mxI("ngModelChange",function(e){t.eBV(i);const a=t.XpG();return t.DH7(a.global.useVideo,e)||(a.global.useVideo=e),t.Njj(e)}),t.EFF(9),t.k0s()(),t.DNE(10,dt,3,2,"ion-item",19),t.j41(11,"ion-item",17)(12,"ion-input",20),t.mxI("ngModelChange",function(e){t.eBV(i);const a=t.XpG();return t.DH7(a.MaxLimit,e)||(a.MaxLimit=e),t.Njj(e)}),t.k0s()(),t.j41(13,"ion-item",21),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.LinkToServer())}),t.j41(14,"ion-label",22),t.EFF(15),t.k0s()()()}if(2&l){const i=t.XpG();t.R7$(),t.Y8G("ngIf",i.ServerList.length),t.R7$(),t.Y8G("ngIf",i.NeedInputCustomAddress),t.R7$(),t.Y8G("ngIf",i.NeedInputCustomAddress),t.R7$(),t.Y8G("ngIf",i.NeedInputCustomAddress),t.R7$(),t.Y8G("ngIf",i.NeedInputCustomAddress),t.R7$(),t.Y8G("ngIf",i.NeedInputCustomAddress),t.R7$(2),t.R50("ngModel",i.global.useVideo),t.R7$(),t.JRh(i.lang.text.InstantCall.useVideo),t.R7$(),t.Y8G("ngIf",i.global.useVideo),t.R7$(2),t.Y8G("label",i.lang.text.AddGroup.MemberMaxLimit),t.R50("ngModel",i.MaxLimit),t.R7$(3),t.JRh(i.lang.text.voidDraw.ConnectToAddress)}}function ut(l,r){if(1&l){const i=t.RV6();t.j41(0,"img",34),t.bIt("click",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.copy_qr_address())}),t.k0s()}if(2&l){const i=t.XpG(2);t.Y8G("src",i.global.InstcQRCodeSRC,t.B4B)}}function ht(l,r){if(1&l){const i=t.RV6();t.j41(0,"ion-item",21),t.bIt("click",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.copy_qr_address())}),t.j41(1,"ion-label",22),t.EFF(2),t.k0s()()}if(2&l){const i=t.XpG(2);t.R7$(2),t.JRh(i.global.InstcQRCodeAsString)}}function _t(l,r){if(1&l){const i=t.RV6();t.j41(0,"div"),t.DNE(1,ut,1,1,"img",31)(2,ht,3,1,"ion-item",32),t.j41(3,"ion-item",21),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.OpenDevManager())}),t.j41(4,"ion-label",33),t.EFF(5),t.k0s()()()}if(2&l){const i=t.XpG();t.R7$(),t.Y8G("ngIf",i.global.InstcQRCodeSRC),t.R7$(),t.Y8G("ngIf",i.global.InstcQRCodeAsString),t.R7$(3),t.JRh(i.lang.text.WebRTCDevManager.ManageInput)}}function pt(l,r){if(1&l&&(t.j41(0,"div")(1,"div",38),t.nrm(2,"ion-icon",39),t.j41(3,"div")(4,"ion-label",40),t.EFF(5),t.k0s()()()()),2&l){const i=t.XpG(2);t.R7$(2),t.Y8G("name",i.global.useVideo?"videocam-outline":"call-outline"),t.R7$(3),t.JRh(i.webrtc.StatusText||i.lang.text.InstantCall.Waiting)}}function Ct(l,r){if(1&l&&(t.j41(0,"div",41),t.EFF(1),t.k0s()),2&l){const i=t.XpG(2);t.R7$(),t.SpI(" ",i.lang.text.InstantCall.CurrentTime+": "+i.ShowDateTime,"")}}function mt(l,r){if(1&l&&t.nrm(0,"div",44),2&l){const i=r.$implicit;t.Y8G("@video_screen",void 0)("id","instc_"+i)}}function bt(l,r){if(1&l&&(t.j41(0,"div",42),t.DNE(1,mt,1,2,"div",43),t.k0s()),2&l){const i=t.XpG(2);t.R7$(),t.Y8G("ngForOf",i.webrtc.PeerGroups.instcall)}}function It(l,r){if(1&l&&(t.j41(0,"div"),t.DNE(1,pt,6,2,"div",11)(2,Ct,2,1,"div",35),t.j41(3,"div",36),t.DNE(4,bt,2,1,"div",37),t.k0s()()),2&l){const i=t.XpG();t.R7$(),t.Y8G("ngIf",!i.global.useVideo||i.ShowWaitingBubble),t.R7$(),t.Y8G("ngIf",i.global.useVideo&&i.global.useCCTV&&i.global.CCTVHost),t.R7$(2),t.Y8G("ngIf",i.global.useVideo&&!i.global.isOthersVideoExtended&&(!i.global.useCCTV||i.global.CCTVHost))}}function vt(l,r){if(1&l&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&l){const i=t.XpG().$implicit;t.Aen("color: #"+i.color),t.R7$(),t.JRh(" "+i.text)}}function ft(l,r){if(1&l&&(t.j41(0,"b"),t.EFF(1),t.k0s()),2&l){const i=t.XpG(2).$implicit;t.R7$(),t.SpI("",i.target,":")}}function xt(l,r){if(1&l&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&l){const i=t.XpG().$implicit;t.R7$(),t.JRh(i.text)}}function wt(l,r){if(1&l){const i=t.RV6();t.j41(0,"a",61),t.bIt("click",function(e){t.eBV(i);const a=t.XpG().$implicit,s=t.XpG(6);return t.Njj(s.nakama.open_url_link(e,a.text))}),t.EFF(1),t.k0s()}if(2&l){const i=t.XpG().$implicit;t.Y8G("href",i.text,t.B4B),t.R7$(),t.JRh(i.text)}}function Rt(l,r){if(1&l&&(t.j41(0,"span"),t.DNE(1,xt,2,1,"span",11)(2,wt,2,2,"a",60),t.k0s()),2&l){const i=r.$implicit;t.R7$(),t.Y8G("ngIf",!i.href),t.R7$(),t.Y8G("ngIf",i.href)}}function St(l,r){if(1&l&&(t.j41(0,"span"),t.DNE(1,Rt,3,2,"span",51),t.k0s()),2&l){const i=t.XpG(2).$implicit;t.Aen(i.isSystem?"color: var(--arcade-fix-system-color)":""),t.R7$(),t.Y8G("ngForOf",i.text)}}function Pt(l,r){if(1&l&&(t.j41(0,"span",59)(1,"span"),t.DNE(2,ft,2,1,"b",11),t.k0s(),t.DNE(3,St,2,3,"span",57),t.k0s()),2&l){const i=t.XpG().$implicit;t.R7$(),t.Aen("color: #"+i.color),t.R7$(),t.Y8G("ngIf",i.target),t.R7$(),t.Y8G("ngIf",i.text)}}function Tt(l,r){if(1&l&&(t.j41(0,"p"),t.DNE(1,vt,2,3,"span",57)(2,Pt,4,4,"span",58),t.k0s()),2&l){const i=r.$implicit;t.Y8G("@instc_chat",void 0),t.R7$(),t.Y8G("ngIf",!i.target),t.R7$(),t.Y8G("ngIf",i.target)}}function yt(l,r){if(1&l){const i=t.RV6();t.j41(0,"div",47)(1,"div",48)(2,"div",49)(3,"div",50),t.DNE(4,Tt,3,3,"p",51),t.k0s()(),t.j41(5,"table",52)(6,"tr")(7,"td",53)(8,"ion-input",54,2),t.bIt("ionFocus",function(){t.eBV(i);const e=t.XpG(2);return e.auto_scroll_down(120),t.Njj(e.global.toggleBlockMainShortcut(!0))})("ionBlur",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.global.toggleBlockMainShortcut(!1))})("keyup.enter",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.send())}),t.mxI("ngModelChange",function(e){t.eBV(i);const a=t.XpG(2);return t.DH7(a.global.instCallLog.text,e)||(a.global.instCallLog.text=e),t.Njj(e)}),t.k0s()(),t.j41(10,"td")(11,"ion-button",55),t.bIt("click",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.send())}),t.nrm(12,"ion-icon",56),t.k0s()()()()()()}if(2&l){const i=t.XpG(2);t.R7$(4),t.Y8G("ngForOf",i.global.instCallLog.logs),t.R7$(4),t.Y8G("disabled",i.global.DisableChatInput)("placeholder",i.lang.text.ChatRoom.input_placeholder),t.R50("ngModel",i.global.instCallLog.text),t.R7$(3),t.Y8G("disabled",i.global.DisableChatInput)}}function kt(l,r){if(1&l&&(t.j41(0,"div")(1,"div",45),t.DNE(2,yt,13,5,"div",46),t.k0s()()),2&l){const i=t.XpG();t.R7$(2),t.Y8G("ngIf",i.global.ShowChatInterface)}}function Mt(l,r){if(1&l){const i=t.RV6();t.j41(0,"img",65),t.bIt("click",function(){t.eBV(i);const e=t.XpG(2);return t.Njj(e.copy_qr_address())}),t.k0s()}if(2&l){const i=t.XpG(2);t.Y8G("src",i.global.InstcQRCodeSRC,t.B4B)}}function Vt(l,r){if(1&l){const i=t.RV6();t.j41(0,"div",62),t.bIt("click",function(e){t.eBV(i);const a=t.XpG();return t.Njj(a.CheckIfDismissAct(e))}),t.j41(1,"div",63),t.DNE(2,Mt,1,1,"img",64),t.j41(3,"ion-item",21),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.copy_qr_address())}),t.j41(4,"ion-label",22),t.EFF(5),t.k0s()()()()}if(2&l){const i=t.XpG();t.R7$(2),t.Y8G("ngIf",i.global.InstcQRCodeSRC),t.R7$(3),t.JRh(i.global.InstcQRCodeAsString)}}const jt=[{path:"",component:(()=>{var l;class r{constructor(n,e,a,s,g,h,d,c,u,p,f,o,m){this.global=n,this.lang=e,this.webrtc=a,this.title=s,this.nakama=g,this.router=h,this.route=d,this.p5toast=c,this.p5loading=u,this.navCtrl=p,this.floatbutton=f,this.noti=o,this.modalCtrl=m,this.UserInputCustomAddress="",this.NeedInputCustomAddress=!1,this.lnId=15,this.isQuickJoin=!1,this.AlreadyExistServer=!1,this.isCustomServer=!1,this.ShowDateTime="",this.ShowWaitingBubble=!1,this.PageOut=!1,this.CallClosed=!1}ngOnInit(){var n=this;this.ServerList=this.nakama.get_all_online_server(),setTimeout(()=>{this.InstantCallServer?(this.InstantCallServer.value=this.ServerList[0]||"local",this.SelectAddressTarget({detail:{value:this.InstantCallServer.value}})):this.NeedInputCustomAddress=!0},0),this.route.queryParams.subscribe(e=>{const a=this.router.getCurrentNavigation().extras.state;a&&(this.UserInputCustomAddress=a.address,this.ChannelId=a.channel,this.Port=a.port,this.signalPort=a.square_port,this.Username=a.username,this.Password=a.password,this.isQuickJoin=a.quick,this.global.useVideo=a.useVideo,this.global.useCCTV=a.useCCTV,this.global.CCTVHost=!1,this.LinkToServer(!0))}),this.webrtc.StatusText||(this.webrtc.StatusText=this.lang.text.InstantCall.Waiting),this.global.WindowOnBlurAct["instant-call"]=()=>{!function(){var a=(0,w.A)(function*(){var s,g;if(n.global.videoPIP&&null!==(s=n.webrtc.Peers[null===(g=n.webrtc.PeerGroups.instcall)||void 0===g?void 0:g[n.webrtc.FocusedRemoteId]])&&void 0!==s&&s.remoteMedia)try{var h,d,c,u,p;if(n.global.useCCTV)throw"CCTV\ub85c \uad6c\uc131\ub428";yield n.webrtc.Peers[null===(h=n.webrtc.PeerGroups.instcall)||void 0===h?void 0:h[n.webrtc.FocusedRemoteId]].remoteMedia.requestPictureInPicture(),n.webrtc.Peers[null===(d=n.webrtc.PeerGroups.instcall)||void 0===d?void 0:d[n.webrtc.FocusedRemoteId]].remoteMedia.style.width="0px",n.webrtc.Peers[null===(c=n.webrtc.PeerGroups.instcall)||void 0===c?void 0:c[n.webrtc.FocusedRemoteId]].remoteMedia.style.height="0px",n.webrtc.Peers[null===(u=n.webrtc.PeerGroups.instcall)||void 0===u?void 0:u[n.webrtc.FocusedRemoteId]].remoteMedia.style.objectFit="none",document.body.appendChild(n.webrtc.Peers[null===(p=n.webrtc.PeerGroups.instcall)||void 0===p?void 0:p[n.webrtc.FocusedRemoteId]].remoteMedia)}catch{}});return function(){return a.apply(this,arguments)}}()()},this.global.windowOnFocusAct["instant-call"]=()=>{!function(){var a=(0,w.A)(function*(){if(n.noti.ClearNoti(n.lnId),n.global.videoPIP&&n.webrtc.localMedia||n.global.useCCTV)try{var s,g;if(n.PageOut)throw"\ud398\uc774\uc9c0\ub97c \ubc97\uc5b4\ub0a8";null!==(s=n.webrtc.Peers[null===(g=n.webrtc.PeerGroups.instcall)||void 0===g?void 0:g[n.webrtc.FocusedRemoteId]])&&void 0!==s&&s.remoteMedia&&n.toggleMainVideoExtend(!1),n.global.useCCTV?n.toggleMainVideoExtend(!1):yield n.webrtc.localMedia.requestPictureInPicture()}catch{}});return function(){return a.apply(this,arguments)}}()()}}SwapRemoteCamera(){var n=this;return(0,w.A)(function*(){var e,a,s,g,h,d;if(null!==(e=n.webrtc.Peers[null===(a=n.webrtc.PeerGroups.instcall)||void 0===a?void 0:a[n.webrtc.FocusedRemoteId]])&&void 0!==e&&e.remoteMedia&&(n.webrtc.Peers[null===(g=n.webrtc.PeerGroups.instcall)||void 0===g?void 0:g[n.webrtc.FocusedRemoteId]].remoteMedia.style.width="0px",n.webrtc.Peers[null===(h=n.webrtc.PeerGroups.instcall)||void 0===h?void 0:h[n.webrtc.FocusedRemoteId]].remoteMedia.style.height="0px",document.body.appendChild(n.webrtc.Peers[null===(d=n.webrtc.PeerGroups.instcall)||void 0===d?void 0:d[n.webrtc.FocusedRemoteId]].remoteMedia)),n.webrtc.FocusedRemoteId=(n.webrtc.FocusedRemoteId+1)%((null===(s=n.webrtc.PeerGroups.instcall)||void 0===s?void 0:s.length)||1),n.global.videoPIP&&n.webrtc.localMedia)try{var c,u;yield n.webrtc.localMedia.requestPictureInPicture(),null!==(c=n.webrtc.Peers[null===(u=n.webrtc.PeerGroups.instcall)||void 0===u?void 0:u[n.webrtc.FocusedRemoteId]])&&void 0!==c&&c.remoteMedia&&n.toggleMainVideoExtend(!1)}catch{}})()}SelectAddressTarget(n){"local"===(this.title.setTitle(`Project: ${this.lang.text.InstantCall.Title}`),this.Port=void 0,this.signalPort=void 0,n.detail.value)?(this.UserInputCustomAddress="",this.NeedInputCustomAddress=!0):(this.SelectedServerInfo=n.detail.value.info,this.UserInputCustomAddress=`${this.SelectedServerInfo.useSSL?"wss":"ws"}://${this.SelectedServerInfo.address}`,this.Port=this.SelectedServerInfo.webrtc_port,12013!=this.SelectedServerInfo.square_port&&(this.signalPort=this.SelectedServerInfo.square_port),this.NeedInputCustomAddress=!1)}CheckIfDismissAct(n){"instc_qrshare"===n.target.id&&this.InstCallQRShare.dismiss()}OpenInstcallQRCode(){this.InstCallQRShare.present()}toggleUseCCTV(){this.global.CCTVHost=!0,this.global.isOthersVideoExtended=!1}LinkToServer(n=!1){var e=this;if(this.webrtc.OnUse||this.global.InstantCallWSClient)return void this.p5toast.show({text:this.lang.text.WebRTCDevManager.AlreadyCalling});if(this.webrtc.StatusText=this.lang.text.InstantCall.Waiting,W.R.requestAudioRecordingPermission(),n&&!this.ChannelId)return this.p5toast.show({text:this.lang.text.InstantCall.MissingInfo}),void this.navCtrl.pop();let h,d,a=this.UserInputCustomAddress.split("://"),s=a.pop(),g=a.pop();g||(g=this.global.checkProtocolFromAddress(s)?"wss":"ws"),this.global.useCCTV&&this.global.CCTVHost&&(h=setInterval(()=>{this.ShowDateTime=(new Date).toLocaleString()},1e3)),this.isCustomServer=n||!this.InstantCallServer||"local"==this.InstantCallServer.value,this.isCustomServer&&this.nakama.SaveWebRTCServer({urls:[`stun:${s}:${this.Port||3478}`,`turn:${s}:${this.Port||3478}`],username:this.Username||"username",credential:this.Password||"password"}).then(c=>this.AlreadyExistServer=c),this.global.InstantCallWSClient=new WebSocket(`${g}://${s}:${this.signalPort||12013}`),this.global.InstantCallWSClient.onopen=(0,w.A)(function*(){if(e.global.WaitingConnect=!0,e.p5loading.toast(e.lang.text.InstantCall.Waiting,"instcall"),e.global.useVideo)try{if(localStorage.removeItem("VideoInputDev"),localStorage.removeItem("AudioInputDev"),localStorage.removeItem("AudioOutputDev"),!e.global.CCTVHost&&(e.webrtc.localMedia=document.createElement("video"),e.webrtc.localMedia.id="webrtc_video",e.webrtc.localMedia.style.width="0px",e.webrtc.localMedia.style.height="0px",e.webrtc.localMedia.autoplay=!0,e.webrtc.localMedia.playsInline=!0,e.webrtc.localMedia.muted=!0,e.webrtc.localMedia.style.borderRadius="16px",document.body.appendChild(e.webrtc.localMedia),!n)){const c=yield e.webrtc.getMediaConst("video");try{e.webrtc.localStream=yield navigator.mediaDevices.getUserMedia(c)}catch{"DesktopPWA"==B.aH&&(e.webrtc.localStream=yield navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0}),e.webrtc.localStream.getVideoTracks()[0].onended=()=>{e.AsyncExitPIP()})}e.webrtc.localMedia.srcObject=e.webrtc.localStream}setTimeout(()=>{e.global.videoPIP=!0;const c=function(){var f=(0,w.A)(function*(){try{e.global.useCCTV?e.global.CCTVHost||e.toggleMainVideoExtend(!1):yield e.webrtc.localMedia.requestPictureInPicture()}catch(o){console.log("\uc65c \uc2e4\ud328\ud558\ub2c8: ",o),e.PageOut||setTimeout(()=>{c()},500)}});return function(){return f.apply(this,arguments)}}();c();let u=!1;const p=()=>{try{var f,o;null!==(f=e.webrtc.Peers[null===(o=e.webrtc.PeerGroups.instcall)||void 0===o?void 0:o[e.webrtc.FocusedRemoteId]])&&void 0!==f&&f.remoteMedia&&(e.toggleMainVideoExtend(!1),u=!0)}catch{setTimeout(()=>{!e.PageOut&&!u&&p()},500)}};p()},1e3)}catch(c){return console.log("navigator.getUserMedia error: ",c),yield e.webrtc.close_webrtc(void 0,"instcall"),e.p5toast.show({text:`${e.lang.text.WebRTCDevManager.InitErr}: ${(c.statusText?`${c.statusText}(${c.status})`:c.status)||c}`}),void(e.global.WaitingConnect=!1)}e.ChannelId?(e.global.InstantCallSend(JSON.stringify({type:"join",channel:e.ChannelId,quick:e.isQuickJoin})),yield new Promise(c=>setTimeout(c,e.global.WebsocketRetryTerm)),e.webrtc.StatusText=e.lang.text.InstantCall.Connecting,e.global.PeerConnected=!0,localStorage.removeItem("VideoInputDev"),localStorage.removeItem("AudioInputDev"),localStorage.removeItem("AudioOutputDev"),e.global.InstantCallSend(JSON.stringify({type:"init_req"}))):e.global.InstantCallSend(JSON.stringify({type:"initInfo",act:"instc",max:e.MaxLimit||4}))}),this.global.InstantCallWSClient.onmessage=c=>{var u,p,f;let o=JSON.parse(c.data);if(void 0===d)d=o.uid;else if(d==o.uid&&"text"!=o.type)return;const m=o.uid;switch(o.type){case"text":{var V;let b=o.msg.split(" "),v=[],I="";const R=d==o.uid,y=R?o.name?`${o.name} (${this.lang.text.MinimalChat.name_me})`:this.lang.text.MinimalChat.name_me:o.name||this.lang.text.MinimalChat.name_stranger_group,G=o.uid?(o.uid.replace(/[^5-79a-b]/g,"")+"abcdef").substring(0,6):T.ud?"888888":"444444";for(let S=0,Nt=b.length;S<Nt;S++)0==b[S].indexOf("http://")||0==b[S].indexOf("https://")?(v.push({text:" "+I+" "}),I="",v.push({href:!0,text:b[S]})):I+=" "+b[S];I&&v.push({text:" "+I}),this.global.instCallLog.logs.push({color:G,text:v,target:y,isMe:R}),null===(V=this.floatbutton.Buttons["instant-call"])||void 0===V||V.style(`background-color: #${G}88`),this.noti.PushLocal({id:this.lnId,title:y,body:o.msg,smallIcon_ln:"favicon",bgcolor:G},"instcall",()=>window.focus()),this.auto_scroll_down()}break;case"join":this.global.ShowChatInterface=!0,2==o.count&&(this.global.DisableChatInput=!1,this.global.instCallLog.logs.length=0,this.global.instCallLog.text=""),setTimeout(()=>{var b;const I=d==o.uid?o.name?`${o.name} (${this.lang.text.MinimalChat.name_me})`:this.lang.text.MinimalChat.name_me:o.name||this.lang.text.MinimalChat.name_stranger_group,R=o.uid?(o.uid.replace(/[^5-79a-b]/g,"")+"abcdef").substring(0,6):T.ud?"888888":"444444";this.global.instCallLog.logs.push({color:R,text:[{text:" "+this.lang.text.MinimalChat.user_join}],target:I,isSystem:!0}),this.auto_scroll_down(),null===(b=this.floatbutton.Buttons["instant-call"])||void 0===b||b.style(`background-color: #${R}88`)},100);break;case"leave":{var j;const v=d==o.uid?o.name?`${o.name} (${this.lang.text.MinimalChat.name_me})`:this.lang.text.MinimalChat.name_me:o.name||this.lang.text.MinimalChat.name_stranger_group,I=o.uid?(o.uid.replace(/[^5-79a-b]/g,"")+"abcdef").substring(0,6):T.ud?"888888":"444444";var E,A;this.global.instCallLog.logs.push({color:I,text:[{text:" "+this.lang.text.MinimalChat.user_out}],target:v,isSystem:!0}),this.auto_scroll_down(),null===(j=this.floatbutton.Buttons["instant-call"])||void 0===j||j.style(`background-color: #${I}88`),o.count<=1?(this.global.DisableChatInput=!0,this.global.InstantCallWSClient.close(1e3,"leave_pair"),this.webrtc.close_webrtc(m,"instcall"),null===(E=this.InstCallQRShare)||void 0===E||E.dismiss(),null===(A=this.QuickModal)||void 0===A||A.dismiss()):this.webrtc.PeerGroups.instcall.includes(m)&&this.webrtc.close_webrtc(m).then(()=>{this.global.useCCTV&&!this.global.CCTVHost?(this.global.DisableChatInput=!0,this.global.InstantCallWSClient.close(1e3,"leave_pair"),this.webrtc.close_webrtc(m,"instcall")):this.SwapRemoteCamera()})}break;case"init_id":const Gt=o.socketId;this.global.InstantCallSend(JSON.stringify({type:"join",channel:o.id,customInput:this.NeedInputCustomAddress,server_uid:null===(u=this.nakama.servers[null===(p=this.SelectedServerInfo)||void 0===p?void 0:p.isOfficial])||void 0===u||null===(u=u[null===(f=this.SelectedServerInfo)||void 0===f?void 0:f.target])||void 0===u?void 0:u.session.user_id})),this.ChannelId=o.id,this.global.InstcQRCodeAsString=`${this.global.CustomLocalAddress}?token=${this.global.CheckIfCanBlankSocketAddress(this.UserInputCustomAddress)},${12013==this.Port?"":this.Port||""},${o.socketId}`,this.global.InstcQRCodeSRC=this.global.readasQRCodeFromString(this.global.InstcQRCodeAsString),this.global.InstantCallSend(JSON.stringify({type:"update_reqInfo",socketId:Gt,keys:["channel_id","port","username","password","useVideo","useCCTV"],channel_id:this.ChannelId,port:this.Port,username:this.Username,password:this.Password,useVideo:this.global.useVideo,useCCTV:this.global.useCCTV}));break;case"expired":setTimeout(()=>{this.global.InstantCallWSClient.close(1e3,"expired")},500);break;case"init_req":if(this.global.useCCTV&&!this.global.CCTVHost)return;this.webrtc.StatusText=this.lang.text.InstantCall.Connecting,this.global.PeerConnected=!0,this.webrtc.initialize(this.global.useVideo?"video":"audio",m,"instcall").then((0,w.A)(function*(){var b,v;e.webrtc.Peers[m].HangUpCallBack=()=>{var I;null===(I=e.global.InstantCallWSClient)||void 0===I||I.close(1e3,"hangup_callback")},e.webrtc.Peers[m].signalChannelId=e.ChannelId,e.webrtc.Peers[m].signalingChannel=e.global.InstantCallWSClient,e.ShowWaiting(),yield e.webrtc.CreateOffer(m),yield new Promise(I=>setTimeout(I,e.global.WebsocketRetryTerm)),e.global.InstantCallSend(JSON.stringify({type:"socket_react",channel:e.ChannelId,act:"WEBRTC_INIT_REQ_SIGNAL",send_to:m})),null===(b=(v=e.global.windowOnFocusAct)["instant-call"])||void 0===b||b.call(v)})).catch(b=>{});break;case"socket_react":switch(o.act){case"WEBRTC_REPLY_INIT_SIGNAL_PART":this.webrtc.WEBRTC_REPLY_INIT_SIGNAL_PART({client:this.global.InstantCallWSClient,channel:this.ChannelId},m,this.global.useVideo?"video":"audio","instcall");break;case"WEBRTC_RECEIVE_ANSWER_PART":this.webrtc.WEBRTC_RECEIVE_ANSWER_PART({client:this.global.InstantCallWSClient,channel:this.ChannelId},m);break;case"WEBRTC_REPLY_INIT_SIGNAL":this.webrtc.WEBRTC_REPLY_INIT_SIGNAL(o.data_str,{client:this.global.InstantCallWSClient,channel:this.ChannelId},m),"EOL"==o.data_str&&this.webrtc.CreateAnswer({client:this.global.InstantCallWSClient,channel:this.ChannelId},m);break;case"WEBRTC_ICE_CANDIDATES":this.webrtc.WEBRTC_ICE_CANDIDATES(o.data_str,{client:this.global.InstantCallWSClient,channel:this.ChannelId},m),this.global.InstantCallSend(JSON.stringify({type:"init_end",channel:this.ChannelId,send_to:m})),this.global.InitEnd=!0,this.webrtc.StatusText=this.lang.text.InstantCall.Connected;break;case"WEBRTC_INIT_REQ_SIGNAL":this.ShowWaiting(),this.webrtc.WEBRTC_INIT_REQ_SIGNAL({client:this.global.InstantCallWSClient,channel:this.ChannelId},m,this.global.useVideo?"video":"audio","instcall").then(()=>{try{this.webrtc.Peers[m].HangUpCallBack=()=>{var v;null===(v=this.global.InstantCallWSClient)||void 0===v||v.close(1e3,"hangup_callback")}}catch{var b;null===(b=this.global.InstantCallWSClient)||void 0===b||b.close(1e3,"init_failed")}});break;case"WEBRTC_RECEIVE_ANSWER":this.webrtc.WEBRTC_RECEIVE_ANSWER(o.data_str,{client:this.global.InstantCallWSClient,channel:this.ChannelId},m)}break;case"init_end":this.global.InitEnd=!0,this.webrtc.StatusText=this.lang.text.InstantCall.Connected}},this.global.InstantCallWSClient.onerror=c=>{console.error("\uc989\uc11d \ud1b5\ud654 \uc6f9\uc18c\ucf13 \uc624\ub958: ",c),this.global.InstantCallWSClient.close(1e3,"error")},this.global.InstantCallWSClient.onclose=c=>{var u,p;switch(console.log("\uc989\uc11d\ud1b5\ud654 \uc885\ub8cc: ",c),null===(u=this.InstCallQRShare)||void 0===u||null===(p=u.dismiss)||void 0===p||p.call(u),c.reason){case"max_limit":this.p5toast.show({text:this.lang.text.MinimalChat.block});break;case"expired":this.p5toast.show({text:this.lang.text.InstantCall.ExpiredChannel});break;default:this.p5toast.show({text:this.lang.text.InstantCall.CallEnd})}this.global.videoPIP&&document.pictureInPictureElement&&this.AsyncExitPIP(),this.global.videoPIP=!1,this.floatbutton.RemoveFloatButton("instant-call"),this.global.WaitingConnect=!1,this.global.CCTVHost=!1,this.global.useCCTV=!1,this.global.InitEnd=!1,this.global.PeerConnected=!1,this.global.InstantCallWSClient.onopen=null,this.global.InstantCallWSClient.onclose=null,this.global.InstantCallWSClient.onmessage=null,this.global.InstantCallWSClient.onerror=null,this.global.InstantCallWSClient=null,this.webrtc.close_webrtc(void 0,"instcall"),this.global.InstcQRCodeAsString="",this.global.InstcQRCodeSRC=void 0,this.CallClosed=!0,this.ShowDateTime="",h&&clearInterval(h),this.PageOut||this.navCtrl.pop()}}toggleMainVideoExtend(n=!0){if(this.global.useVideo)if(n&&(this.global.isOthersVideoExtended=!this.global.isOthersVideoExtended),this.global.isOthersVideoExtended&&!this.global.useCCTV){var e,a,s,g;this.webrtc.Peers[null===(e=this.webrtc.PeerGroups.instcall)||void 0===e?void 0:e[this.webrtc.FocusedRemoteId]].remoteMedia.style.objectFit="cover",this.webrtc.Peers[null===(a=this.webrtc.PeerGroups.instcall)||void 0===a?void 0:a[this.webrtc.FocusedRemoteId]].remoteMedia.style.width="100%",this.webrtc.Peers[null===(s=this.webrtc.PeerGroups.instcall)||void 0===s?void 0:s[this.webrtc.FocusedRemoteId]].remoteMedia.style.height="100%",document.getElementById("instc_remote").appendChild(this.webrtc.Peers[null===(g=this.webrtc.PeerGroups.instcall)||void 0===g?void 0:g[this.webrtc.FocusedRemoteId]].remoteMedia)}else setTimeout(()=>{var h;if(this.global.useCCTV&&!this.global.CCTVHost)this.webrtc.localMedia.style.objectFit="cover",this.webrtc.localMedia.style.width="100%",this.webrtc.localMedia.style.height="100%",this.webrtc.localMedia.play(),null===(h=document.getElementById("instc_remote"))||void 0===h||h.appendChild(this.webrtc.localMedia);else for(const c of(null===(d=this.webrtc.PeerGroups)||void 0===d?void 0:d.instcall)||[]){var d;const u=document.getElementById(`instc_${c}`);this.webrtc.Peers[c].remoteMedia.style.objectFit="contain",this.webrtc.Peers[c].remoteMedia.style.width="100%",this.webrtc.Peers[c].remoteMedia.style.height="100%",this.webrtc.Peers[c].remoteMedia.play(),u.appendChild(this.webrtc.Peers[c].remoteMedia)}},500)}OpenDevManager(){var n=this;return(0,w.A)(function*(){let e=yield n.webrtc.getDeviceList();n.global.PageDismissAct["webrtc-manage"]=function(){var a=(0,w.A)(function*(s){try{var g;if(!Object.keys(s).length)throw"\uc7a5\uce58 \ubcc0\uacbd \uc815\ubcf4\uac00 \ube44\uc5b4\uc788\uc74c";let h={};n.global.useVideo&&s.data.videoinput&&(h.video={deviceId:{exact:s.data.videoinput.deviceId}}),s.data.audioinput&&(h.audio={deviceId:{exact:s.data.audioinput.deviceId}}),n.webrtc.localStream.getTracks().forEach(d=>d.stop()),n.global.useVideo&&null!==(g=s.data.videoinput)&&void 0!==g&&g.useScr?(n.webrtc.localStream=yield navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0}),n.webrtc.localStream.getVideoTracks()[0].onended=()=>{n.AsyncExitPIP()}):n.webrtc.localStream=yield navigator.mediaDevices.getUserMedia(h),n.webrtc.localMedia.srcObject=n.webrtc.localStream}catch(h){console.log("\ubbf8\ub514\uc5b4 \uc2a4\ud2b8\ub9bc \ubcc0\uacbd \uc624\ub958: ",h)}n.global.RestoreShortCutAct("webrtc-manage"),delete n.global.PageDismissAct["webrtc-manage"]});return function(s){return a.apply(this,arguments)}}(),n.global.StoreShortCutAct("webrtc-manage"),n.global.ActLikeModal("webrtc-manage-io-dev",{list:JSON.parse(JSON.stringify(e)),typein:n.global.useVideo?"video":"audio",dismiss:"webrtc-manage"})})()}copy_qr_address(n=this.global.InstcQRCodeAsString){this.global.WriteValueToClipboard("text/plain",n)}ShowWaiting(){if(this.p5canvas)return;this.ShowWaitingBubble=!0;const n=document.getElementById("InstantCallCanvasDiv");n&&(this.p5canvas=new D(e=>{let a=1;e.setup=()=>{e.pixelDensity(1),e.createCanvas(n.clientWidth,n.clientHeight).parent(n),e.noStroke()};class s{constructor(){this.color={r:0,g:0,b:0},this.size=1,this.targetSize=100,this.opacity=200,this.pos=e.createVector(0,0),this.dir=e.createVector(e.random(-1.4,1.4),e.random(-2,-4)),this.color.r=e.random(0,255),this.color.g=e.random(0,255),this.color.b=e.random(0,255),this.targetSize=e.random(80,150)}display(){this.size<this.targetSize&&(this.size+=6),this.size>this.targetSize&&(this.size=this.targetSize),e.push(),e.fill(this.color.r,this.color.g,this.color.b,this.opacity),e.circle(this.pos.x,this.pos.y,this.size*a),e.pop(),this.pos.add(this.dir),this.dir.y+=.04,this.opacity-=1}}let g=[],h=!0;e.draw=()=>{h&&(g.push(new s),h=!1,setTimeout(()=>{h=!0},500)),e.clear(),e.push(),e.translate(e.width/2,e.height/2);for(let d=g.length-1;d>=0;d--)g[d].display(),g[d].opacity<=0&&g.splice(d,1);e.pop(),this.global.InitEnd&&(a-=.02),a<=0&&(this.ShowWaitingBubble=!1,e.remove())},e.windowResized=()=>{n&&e.resizeCanvas(n.clientWidth,n.clientHeight)}}))}ionViewWillEnter(){var n,e;this.global.portalHint=!1,this.HeaderBefore=this.noti.Current,this.noti.Current="instcall",this.noti.ClearNoti(this.lnId),this.floatbutton.RemoveFloatButton("instant-call"),this.PageOut=!1,this.p5canvas&&this.p5canvas.windowResized(),this.global.StoreShortCutAct("instant-call"),this.CallClosed&&this.navCtrl.pop(),(this.global.videoPIP&&this.webrtc.localMedia||this.global.useCCTV)&&(this.global.useCCTV?this.toggleMainVideoExtend(!1):this.webrtc.localMedia.requestPictureInPicture()),null!==(n=this.webrtc.Peers[null===(e=this.webrtc.PeerGroups.instcall)||void 0===e?void 0:e[this.webrtc.FocusedRemoteId]])&&void 0!==n&&n.remoteMedia&&this.toggleMainVideoExtend(!1);const a=document.getElementById("instcall_log");a&&this.global.InitEnd&&a.scrollTo({top:a.scrollHeight,behavior:"smooth"}),this.global.p5KeyShortCut.EnterAct=()=>{var s;null===(s=this.ChatInput)||void 0===s||s.setFocus()}}AsyncExitPIP(){return(0,w.A)(function*(){try{yield document.exitPictureInPicture()}catch{}})()}ionViewWillLeave(){var e,a,s,g,h,d,c,n=this;if(this.noti.Current=this.HeaderBefore||"",this.title.setTitle("Project: Cone"),this.PageOut=!0,this.global.WaitingConnect||this.global.InitEnd){const u=this.floatbutton.AddFloatButton("instant-call",this.global.useVideo?"videocam-outline":"call-outline");null==u||u.mouseClicked(()=>{var p;this.global.SelectArcadeTab(),this.navCtrl.navigateForward("portal/arcade/instant-call",{animation:N.NC}),null===(p=this.QuickModal)||void 0===p||p.dismiss()}),null!=u&&u.elt&&(u.elt.oncontextmenu=()=>(function(){var f=(0,w.A)(function*(){if(!n.global.InstcQRCodeAsString||!n.global.InstcQRCodeAsString||n.QuickModal)return!1;n.global.QuickQRCodeAddress=n.global.InstcQRCodeAsString,n.global.QuickQRCodeText=n.global.InstcQRCodeAsString,n.QuickModal=yield n.modalCtrl.create({component:X.v,cssClass:"transparent-modal"}),n.QuickModal.onDidDismiss().then(()=>{n.QuickModal=null}),n.QuickModal.present()});return function(){return f.apply(this,arguments)}}()(),!1))}null!==(e=this.webrtc.Peers[null===(a=this.webrtc.PeerGroups.instcall)||void 0===a?void 0:a[this.webrtc.FocusedRemoteId]])&&void 0!==e&&e.remoteMedia&&this.global.videoPIP&&!this.global.useCCTV&&(this.webrtc.Peers[null===(s=this.webrtc.PeerGroups.instcall)||void 0===s?void 0:s[this.webrtc.FocusedRemoteId]].remoteMedia.requestPictureInPicture(),this.webrtc.Peers[null===(g=this.webrtc.PeerGroups.instcall)||void 0===g?void 0:g[this.webrtc.FocusedRemoteId]].remoteMedia.style.width="0px",this.webrtc.Peers[null===(h=this.webrtc.PeerGroups.instcall)||void 0===h?void 0:h[this.webrtc.FocusedRemoteId]].remoteMedia.style.height="0px",this.webrtc.Peers[null===(d=this.webrtc.PeerGroups.instcall)||void 0===d?void 0:d[this.webrtc.FocusedRemoteId]].remoteMedia.style.objectFit="none",document.body.appendChild(this.webrtc.Peers[null===(c=this.webrtc.PeerGroups.instcall)||void 0===c?void 0:c[this.webrtc.FocusedRemoteId]].remoteMedia)),delete this.global.p5KeyShortCut.EnterAct,this.global.RestoreShortCutAct("instant-call")}ionViewDidLeave(){this.global.portalHint=!0}ngOnDestroy(){this.InstCallQRShare.dismiss(),this.p5canvas&&this.p5canvas.remove(),this.isCustomServer&&!this.AlreadyExistServer&&this.nakama.RemoveWebRTCServer(this.UserInputCustomAddress.split("://").pop()),!this.global.InitEnd&&!this.global.PeerConnected&&this.global.InstantCallWSClient&&this.global.InstantCallWSClient.close(1e3),this.route.queryParams.unsubscribe(),delete this.global.windowOnFocusAct["instant-call"],delete this.global.WindowOnBlurAct["instant-call"]}auto_scroll_down(n){const e=document.getElementById("instcall_log");e&&setTimeout(()=>{const a=e.scrollHeight;a<e.scrollTop+e.clientHeight+120&&e.scrollTo({top:a,behavior:"smooth"})},n||0)}send(){let n={type:"text",msg:this.global.instCallLog.text};n.msg.trim()&&(n.name=this.nakama.users.self.display_name,this.global.InstantCallSend(JSON.stringify(n)),this.global.instCallLog.text="",this.auto_scroll_down())}}return(l=r).\u0275fac=function(n){return new(n||l)(t.rXU(T.z3),t.rXU(O.y),t.rXU(Y.j),t.rXU(Q.hE),t.rXU(L.X),t.rXU(P.Ix),t.rXU(P.nX),t.rXU(U.G),t.rXU(H.f),t.rXU(J.q9),t.rXU(z.u),t.rXU(q.r),t.rXU(C.W3))},l.\u0275cmp=t.VBU({type:l,selectors:[["app-instant-call"]],viewQuery:function(n,e){if(1&n&&(t.GBs(K,5),t.GBs(Z,5),t.GBs($,5)),2&n){let a;t.mGM(a=t.lsd())&&(e.InstantCallServer=a.first),t.mGM(a=t.lsd())&&(e.InstCallQRShare=a.first),t.mGM(a=t.lsd())&&(e.ChatInput=a.first)}},decls:18,vars:8,consts:[["InstCallQRShare",""],["InstantCallServer",""],["ChatInput",""],[1,"ion-no-border"],["slot","start"],["defaultHref","portal/arcade"],["class","top_icon","slot","end","name","swap-horizontal-outline",3,"click",4,"ngIf"],["class","top_icon","slot","end","name","qr-code-outline",3,"click",4,"ngIf"],["slot","end","name","expand-outline","class","top_icon","style","width: 24px; height: 24px;",3,"click",4,"ngIf"],["id","InstantCallCanvasDiv",2,"position","absolute","width","100%","height","100%","overflow","hidden","pointer-events","none"],["style","flex: 0 1 auto;",4,"ngIf"],[4,"ngIf"],[1,"transparent-modal"],["slot","end","name","swap-horizontal-outline",1,"top_icon",3,"click"],["slot","end","name","qr-code-outline",1,"top_icon",3,"click"],["slot","end","name","expand-outline",1,"top_icon",2,"width","24px","height","24px",3,"click"],[2,"flex","0 1 auto"],["button",""],[2,"pointer-events","none",3,"ngModelChange","ngModel"],["button","",3,"ionChange",4,"ngIf"],["type","number","min","2","placeholder","4",1,"ion-text-right",3,"ngModelChange","label","ngModel"],["button","",3,"click"],[1,"ion-text-center"],["value","local",2,"pointer-events","none",3,"ionChange","label"],["value","local"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","(wss://)0.0.0.0",1,"ion-text-right",3,"ngModelChange","label","ngModel"],["slot","end","name","open-outline",3,"click"],[1,"ion-text-right",3,"ngModelChange","label","ngModel","placeholder"],["button","",3,"ionChange"],["style","width: 100%; height: auto; cursor: copy;","alt","QRCode",3,"src","click",4,"ngIf"],["button","",3,"click",4,"ngIf"],["color","secondary",1,"ion-text-center"],["alt","QRCode",2,"width","100%","height","auto","cursor","copy",3,"click","src"],["style","margin: 16px 16px 0px 16px;",4,"ngIf"],["id","instc_remote",2,"display","flex","width","100%","height","100%"],["class","fixed_btn_size",4,"ngIf"],[1,"disconnect_info"],["color","medium",2,"width","60px","height","60px",3,"name"],["color","medium"],[2,"margin","16px 16px 0px 16px"],[1,"fixed_btn_size"],["class","list_ele",3,"id",4,"ngFor","ngForOf"],[1,"list_ele",3,"id"],["id","instcall",1,"full_screen",2,"display","block","overflow","hidden","background-color","black"],["style","display: flex; justify-content: center; align-items: center; width: 100%; position: fixed; bottom: 0px; color: var(--arcade-fix-color);",4,"ngIf"],[2,"display","flex","justify-content","center","align-items","center","width","100%","position","fixed","bottom","0px","color","var(--arcade-fix-color)"],[2,"width","100%","max-width","650px","overflow-y","hidden"],["id","instcall_log",2,"width","100%","height","fit-content","max-height","84px","overflow-y","scroll","padding","8px","background","linear-gradient(to top, var(--voidDraw-chat-bg-transparent), transparent)"],[2,"pointer-events","none","user-select","none"],[4,"ngFor","ngForOf"],[2,"width","100%","background-color","var(--voidDraw-chat-bg-transparent)"],[2,"width","100%"],["type","text",2,"margin-left","16px",3,"ionFocus","ionBlur","keyup.enter","ngModelChange","disabled","placeholder","ngModel"],["expand","block","fill","clear",3,"click","disabled"],["name","send"],[3,"style",4,"ngIf"],["class","default_text",4,"ngIf"],[1,"default_text"],["target","_system","onclick","return false;","style","pointer-events: all;",3,"href","click",4,"ngIf"],["target","_system","onclick","return false;",2,"pointer-events","all",3,"click","href"],["id","instc_qrshare",1,"OutterModal",3,"click"],[2,"width","400px","min-height","455px","background-color","var(--chatroom-background)","text-align","center","padding","16px"],["style","width: 100%; height: auto; cursor: copy; margin-bottom: 8px;","alt","QuickLink",3,"src","click",4,"ngIf"],["alt","QuickLink",2,"width","100%","height","auto","cursor","copy","margin-bottom","8px",3,"click","src"]],template:function(n,e){1&n&&(t.j41(0,"ion-header",3)(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.k0s(),t.j41(4,"ion-buttons",4),t.nrm(5,"ion-back-button",5),t.k0s(),t.DNE(6,tt,1,0,"ion-icon",6)(7,et,1,0,"ion-icon",7)(8,it,1,0,"ion-icon",8),t.k0s()(),t.j41(9,"ion-content"),t.nrm(10,"div",9),t.DNE(11,gt,16,12,"div",10)(12,_t,6,3,"div",11)(13,It,5,3,"div",11)(14,kt,3,1,"div",11),t.j41(15,"ion-modal",12,0),t.DNE(17,Vt,6,2,"ng-template"),t.k0s()()),2&n&&(t.R7$(3),t.JRh(e.lang.text.InstantCall.Title),t.R7$(3),t.Y8G("ngIf",e.global.useVideo&&!e.global.useCCTV&&e.global.InitEnd&&e.global.isOthersVideoExtended),t.R7$(),t.Y8G("ngIf",e.global.InstcQRCodeAsString),t.R7$(),t.Y8G("ngIf",e.global.useVideo&&!e.global.useCCTV&&e.global.InitEnd),t.R7$(3),t.Y8G("ngIf",!e.global.WaitingConnect),t.R7$(),t.Y8G("ngIf",e.global.WaitingConnect&&!e.global.InitEnd&&!e.ShowWaitingBubble),t.R7$(),t.Y8G("ngIf",e.global.WaitingConnect&&e.global.InitEnd||e.ShowWaitingBubble),t.R7$(),t.Y8G("ngIf",e.global.InitEnd||e.global.ShowChatInterface))},dependencies:[k.Sq,k.bT,M.BC,M.vS,C.Jm,C.QW,C.W9,C.eU,C.iq,C.$w,C.uz,C.he,C.Nm,C.Ip,C.BC,C.BY,C.ai,C.Sb,C.hB,C.su,C.Je,C.Gw,C.el,C.T6],styles:["ion-input[_ngcontent-%COMP%]{--highlight-color-valid: var(--ion-color-primary)}p[_ngcontent-%COMP%]{margin:8px 0 0}.fixed_btn_size[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;flex-direction:row;overflow-x:auto;gap:16px;margin:16px}.list_ele[_ngcontent-%COMP%]{width:640px;height:480px;border-radius:16px;background-color:#000;overflow:hidden}"],data:{animation:[(0,x.hZ)("instc_chat",[(0,x.kY)(":enter",[(0,x.iF)({opacity:0}),(0,x.i0)(".3s ease-out",(0,x.iF)({opacity:1}))])]),(0,x.hZ)("video_screen",[(0,x.kY)(":enter",[(0,x.iF)({opacity:0}),(0,x.i0)(".5s ease-out",(0,x.iF)({opacity:1}))]),(0,x.kY)(":leave",[(0,x.i0)(".5s ease-in",(0,x.iF)({opacity:0,height:0}))])])]}}),r})()}];let Et=(()=>{var l;class r{}return(l=r).\u0275fac=function(n){return new(n||l)},l.\u0275mod=t.$C({type:l}),l.\u0275inj=t.G2t({imports:[P.iI.forChild(jt),P.iI]}),r})(),At=(()=>{var l;class r{}return(l=r).\u0275fac=function(n){return new(n||l)},l.\u0275mod=t.$C({type:l}),l.\u0275inj=t.G2t({imports:[k.MD,M.YN,C.bv,Et]}),r})()}}]);