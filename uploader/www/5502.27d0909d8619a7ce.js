"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5502],{5502:($t,V,p)=>{p.r(V),p.d(V,{MinimalChatPageModule:()=>jt});var D=p(177),N=p(4341),f=p(5374),G=p(9858),x=p(467),F=p(92),P=p(7100),X=p(8326),O=p(5402),U=p(2682),t=p(3953),J=p(9347),H=p(5547),Y=p(345),Q=p(3656),q=p(8065),W=p(4234),z=p(9900),K=p(755),Z=p(4237),tt=p(7476),et=p(3307);const it=["MinimalChatServer"],nt=["SquareQRShare"],at=["minimalchat_input"];function lt(l,m){if(1&l){const n=t.RV6();t.j41(0,"ion-icon",25),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.OpenSquareQRCode())}),t.k0s()}}function st(l,m){if(1&l&&(t.j41(0,"ion-select-option",36),t.EFF(1),t.k0s()),2&l){const n=m.$implicit;t.Y8G("value",n),t.R7$(),t.JRh(n.info.name)}}function ot(l,m){if(1&l){const n=t.RV6();t.j41(0,"ion-item")(1,"ion-select",33,2),t.bIt("ionChange",function(e){t.eBV(n);const a=t.XpG(2);return t.Njj(a.SelectAddressTarget(e))}),t.j41(3,"ion-select-option",34),t.EFF(4),t.k0s(),t.DNE(5,st,2,2,"ion-select-option",35),t.k0s()()}if(2&l){const n=t.XpG(2);t.R7$(),t.Y8G("label",n.lang.text.AddGroup.SelectServer),t.R7$(3),t.JRh(n.lang.text.voidDraw.InternalConn),t.R7$(),t.Y8G("ngForOf",n.ServerList)}}function rt(l,m){if(1&l){const n=t.RV6();t.j41(0,"ion-item",28)(1,"ion-input",37),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.UserInputCustomAddress,e)||(a.UserInputCustomAddress=e),t.Njj(e)}),t.k0s(),t.j41(2,"ion-icon",38),t.bIt("click",function(){t.eBV(n);const e=t.XpG(2);return t.Njj(e.global.open_custom_site(e.UserInputCustomAddress))}),t.k0s()()}if(2&l){const n=t.XpG(2);t.R7$(),t.Y8G("label",n.lang.text.voidDraw.InputAddress),t.R50("ngModel",n.UserInputCustomAddress)}}function ct(l,m){if(1&l){const n=t.RV6();t.j41(0,"ion-item",28)(1,"ion-input",39),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.client.JoinedChannel,e)||(a.client.JoinedChannel=e),t.Njj(e)}),t.k0s()()}if(2&l){const n=t.XpG(2);t.R7$(),t.Y8G("label",n.lang.text.voidDraw.ChannelIdAddress),t.R50("ngModel",n.client.JoinedChannel)}}function ht(l,m){if(1&l){const n=t.RV6();t.j41(0,"ion-item",28)(1,"ion-input",40),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG(2);return t.DH7(a.client.MaxChannelMember,e)||(a.client.MaxChannelMember=e),t.Njj(e)}),t.k0s()()}if(2&l){const n=t.XpG(2);t.R7$(),t.Y8G("label",n.lang.text.AddGroup.MemberMaxLimit),t.R50("ngModel",n.client.MaxChannelMember)}}function dt(l,m){1&l&&(t.j41(0,"div",41),t.EFF(1," Ctrl + Enter "),t.k0s())}function ut(l,m){if(1&l){const n=t.RV6();t.j41(0,"div",26),t.DNE(1,ot,6,3,"ion-item",13)(2,rt,3,2,"ion-item",27)(3,ct,2,2,"ion-item",27)(4,ht,2,2,"ion-item",27),t.j41(5,"ion-item",28)(6,"ion-toggle",29),t.mxI("ngModelChange",function(e){t.eBV(n);const a=t.XpG();return t.DH7(a.client.CreateOwnChannel,e)||(a.client.CreateOwnChannel=e),t.Njj(e)}),t.EFF(7),t.k0s()(),t.j41(8,"div"),t.DNE(9,dt,2,0,"div",30),t.j41(10,"ion-item",31),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.init_joinChat())}),t.j41(11,"ion-label",32),t.EFF(12),t.k0s()()()()}if(2&l){const n=t.XpG();t.R7$(),t.Y8G("ngIf",n.ServerList.length),t.R7$(),t.Y8G("ngIf",n.NeedInputCustomAddress),t.R7$(),t.Y8G("ngIf",!n.client.CreateOwnChannel),t.R7$(),t.Y8G("ngIf",n.client.CreateOwnChannel),t.R7$(2),t.R50("ngModel",n.client.CreateOwnChannel),t.R7$(),t.JRh(n.lang.text.MinimalChat.OwnChannel),t.R7$(2),t.Y8G("ngIf",n.global.ShowHint),t.R7$(3),t.JRh(n.lang.text.voidDraw.ConnectToAddress)}}function mt(l,m){if(1&l){const n=t.RV6();t.j41(0,"div")(1,"img",42),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.copy_qr_address())}),t.k0s(),t.j41(2,"ion-item",31),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.copy_qr_address(e.client.JoinedChannel))}),t.j41(3,"ion-label",43),t.EFF(4),t.k0s()()()}if(2&l){const n=t.XpG();t.R7$(),t.Y8G("src",n.QRCodeSRC,t.B4B),t.R7$(3),t.JRh(n.client.JoinedChannel)}}function _t(l,m){if(1&l&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&l){const n=t.XpG().$implicit;t.Aen("color: #"+n.color),t.R7$(),t.JRh(" "+n.text)}}function gt(l,m){if(1&l&&(t.j41(0,"b"),t.EFF(1),t.k0s()),2&l){const n=t.XpG(2).$implicit;t.R7$(),t.SpI("",n.target,":")}}function pt(l,m){if(1&l&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&l){const n=t.XpG().$implicit;t.R7$(),t.JRh(n.text)}}function ft(l,m){if(1&l){const n=t.RV6();t.j41(0,"a",48),t.bIt("click",function(e){t.eBV(n);const a=t.XpG().$implicit,c=t.XpG(4);return t.Njj(c.nakama.open_url_link(e,a.text))}),t.EFF(1),t.k0s()}if(2&l){const n=t.XpG().$implicit;t.Y8G("href",n.text,t.B4B),t.R7$(),t.JRh(n.text)}}function Ct(l,m){if(1&l&&(t.j41(0,"span"),t.DNE(1,pt,2,1,"span",13)(2,ft,2,2,"a",47),t.k0s()),2&l){const n=m.$implicit;t.R7$(),t.Y8G("ngIf",!n.href),t.R7$(),t.Y8G("ngIf",n.href)}}function xt(l,m){if(1&l&&(t.j41(0,"span"),t.DNE(1,Ct,3,2,"span",15),t.k0s()),2&l){const n=t.XpG(2).$implicit;t.Aen(n.isSystem?"color: var(--miniranchat-system-text)":""),t.R7$(),t.Y8G("ngForOf",n.text)}}function vt(l,m){if(1&l&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&l){const n=t.XpG(3).$implicit;t.R7$(),t.SpI(" ",n.Progress," ")}}function bt(l,m){if(1&l){const n=t.RV6();t.j41(0,"span")(1,"span",49),t.bIt("click",function(){t.eBV(n);const e=t.XpG(2).$implicit,a=t.XpG();return t.Njj(a.open_file_viewer(e.file.info))})("contextmenu",function(){t.eBV(n);const e=t.XpG(2).$implicit,a=t.XpG();return t.Njj(a.download_file(e.file.info))}),t.EFF(2),t.k0s(),t.DNE(3,vt,2,1,"span",13),t.k0s()}if(2&l){const n=t.XpG(2).$implicit,i=t.XpG();t.R7$(2),t.JRh(i.lang.text.ChatRoom.attachments+": "+n.file.info.filename),t.R7$(),t.Y8G("ngIf",n.Progress)}}function kt(l,m){if(1&l&&(t.j41(0,"span",46)(1,"span"),t.DNE(2,gt,2,1,"b",13),t.k0s(),t.DNE(3,xt,2,3,"span",44)(4,bt,4,2,"span",13),t.k0s()),2&l){const n=t.XpG().$implicit;t.R7$(),t.Aen("color: #"+n.color),t.R7$(),t.Y8G("ngIf",n.target),t.R7$(),t.Y8G("ngIf",n.text),t.R7$(),t.Y8G("ngIf",n.file)}}function yt(l,m){if(1&l&&(t.j41(0,"p"),t.DNE(1,_t,2,3,"span",44)(2,kt,5,5,"span",45),t.k0s()),2&l){const n=m.$implicit;t.R7$(),t.Y8G("ngIf",!n.target),t.R7$(),t.Y8G("ngIf",n.target)}}function Mt(l,m){if(1&l){const n=t.RV6();t.j41(0,"img",53),t.bIt("click",function(){t.eBV(n);const e=t.XpG(2);return t.Njj(e.copy_qr_address())}),t.k0s()}if(2&l){const n=t.XpG(2);t.Y8G("src",n.QRCodeSRC,t.B4B)}}function St(l,m){if(1&l){const n=t.RV6();t.j41(0,"div",50),t.bIt("click",function(e){t.eBV(n);const a=t.XpG();return t.Njj(a.CheckIfDismissAct(e))}),t.j41(1,"div",51),t.DNE(2,Mt,1,1,"img",52),t.j41(3,"ion-item",31),t.bIt("click",function(){t.eBV(n);const e=t.XpG();return t.Njj(e.copy_qr_address(e.client.JoinedChannel))}),t.j41(4,"ion-label",32),t.EFF(5),t.k0s()()()()}if(2&l){const n=t.XpG();t.R7$(2),t.Y8G("ngIf",n.QRCodeSRC),t.R7$(3),t.JRh(n.client.JoinedChannel)}}function Rt(l,m){if(1&l&&t.nrm(0,"ion-icon",60),2&l){const n=t.XpG().$implicit;t.Y8G("name",n.icon||"close-circle")}}function At(l,m){if(1&l&&t.nrm(0,"img",61),2&l){const n=t.XpG().$implicit;t.Y8G("src","assets/icon/"+n.icon_img,t.B4B)("alt",n.title)}}function wt(l,m){if(1&l){const n=t.RV6();t.j41(0,"div",56)(1,"div",57),t.bIt("click",function(){const e=t.eBV(n).$implicit;return t.Njj(e.act())})("contextmenu",function(){const e=t.eBV(n).$implicit;return t.Njj(e.context?e.context():null)}),t.DNE(2,Rt,1,1,"ion-icon",58)(3,At,1,2,"img",59),t.j41(4,"div"),t.EFF(5),t.k0s()()()}if(2&l){const n=m.$implicit;t.R7$(),t.Aen("cursor: "+(n.cursor||"pointer")+";"),t.Y8G("hidden",n.isHide),t.R7$(),t.Y8G("ngIf",n.icon),t.R7$(),t.Y8G("ngIf",n.icon_img),t.R7$(2),t.JRh(n.name)}}function It(l,m){if(1&l&&(t.j41(0,"div",54),t.DNE(1,wt,6,6,"div",55),t.k0s()),2&l){const n=t.XpG();t.R7$(),t.Y8G("ngForOf",n.extended_buttons)}}const Tt=[{path:"",component:(()=>{var l;class m{constructor(i,e,a,c,u,s,r,d,h,o,g,v,y,M,k){var C,_=this;this.client=i,this.noti=e,this.title=a,this.navCtrl=c,this.route=u,this.router=s,this.statusBar=r,this.lang=d,this.global=h,this.p5toast=o,this.indexed=g,this.alertCtrl=v,this.nakama=y,this.floatButton=M,this.p5loading=k,this.Header="simplechat",this.iconColor="d8d8d8",this.lnId=12,this.req_refreshed=!1,this.open_this=C=>{this.noti.Current==this.Header?window.focus():this.client.RejoinGroupChat()},this.ShowExtMenus=!1,this.useVoiceRecording=!1,this.extended_buttons=[{icon:"document-attach-outline",name:this.lang.text.ChatRoom.attachments,act:(C=(0,x.A)(function*(){_.new_attach({detail:{value:"load"}})}),function(){return C.apply(this,arguments)}),context:()=>(this.new_attach({detail:{value:"link"}}),!1)},{icon_img:"voidDraw.png",name:this.lang.text.ChatRoom.voidDraw,act:()=>{this.new_attach({detail:{value:"image"}})},context:()=>(function(){var A=(0,x.A)(function*(){const b="voiddraw",R=yield _.global.GetValueFromClipboard(b);switch(R.type){case"image/png":_.SelectVoidDrawBackgroundImage({target:{files:[R.value]}});break;case"text/plain":const $={file_ext:R.value.split(".").pop()};if(_.global.set_viewer_category_from_ext($),"image"==$.viewer)try{_.p5loading.update({id:b,message:`${_.lang.text.Arcade.TryingDownload}: ${R.value.split("/").pop()}`,forceEnd:null});const w=yield fetch(R.value);if(!w.ok)throw`${w.statusText} (${w.status})`;const j=yield w.blob();_.p5loading.update({id:b,message:`${_.lang.text.Arcade.TryingDownload}: ${R.value.split("/").pop()}`,progress:1,forceEnd:350}),_.SelectVoidDrawBackgroundImage({target:{files:[j]}});break}catch(w){console.log("\uadf8\ub9bc\ud310 \ube60\ub978 \uc9c4\uc785 \uc624\ub958: ",w)}default:_.extended_buttons[1].act()}});return function(){return A.apply(this,arguments)}}()(),!1)},{icon:"reader-outline",name:this.lang.text.ChatRoom.newText,act:()=>{this.new_attach({detail:{value:"text"}})}},{icon:"camera-outline",name:this.lang.text.ChatRoom.Camera,act:()=>{this.new_attach({detail:{value:"camera"}})}},{icon:"mic-circle-outline",name:this.lang.text.ChatRoom.Voice,act:function(){var C=(0,x.A)(function*(){if(_.useVoiceRecording=!_.useVoiceRecording,_.useVoiceRecording){if(_.global.useVoiceRecording&&"SquareRecording"!=_.global.useVoiceRecording)return void _.p5toast.show({text:_.lang.text.GlobalAct[_.global.useVoiceRecording]});(yield O.R.hasAudioRecordingPermission()).value?(_.global.useVoiceRecording="SquareRecording",_.extended_buttons[4].icon="stop-circle-outline",_.extended_buttons[4].name=_.lang.text.ChatRoom.VoiceStop,_.p5loading.toast(_.lang.text.ChatRoom.StartVRecord),yield O.R.startRecording(),_.CreateFloatingVoiceTimeHistoryAddButton()):(_.useVoiceRecording=!1,_.extended_buttons[4].icon="mic-circle-outline",yield O.R.requestAudioRecordingPermission())}else yield _.StopAndSaveVoiceRecording()});return function(){return C.apply(this,arguments)}}()},{icon:"link-outline",name:this.lang.text.AddPost.UseOutLink,act:C=>{this.client.AutoOpenLink=null!=C?C:!this.client.AutoOpenLink,this.client.AutoOpenLink?(this.extended_buttons[5].icon="link-outline",this.extended_buttons[5].name=this.lang.text.MinimalChat.AutoOpen):(this.extended_buttons[5].icon="unlink-outline",this.extended_buttons[5].name=this.lang.text.AddPost.UseOutLink)}},{icon:"volume-mute-outline",name:this.lang.text.ChatRoom.ReadText,act:function(){var C=(0,x.A)(function*(){_.toggle_speakermode()});return function(){return C.apply(this,arguments)}}()},{icon:"trash-outline",name:this.lang.text.MinimalChat.TrashChat,act:()=>{this.client.userInput.logs.length=0,this.client.userInput.logs.push({color:P.ud?"bbb":"444",text:this.lang.text.MinimalChat.TrashChatLog,isSystem:!0}),this.ShowExtMenus=!1}}],this.NeedInputCustomAddress=!1,this.JoinedQuick=!1,this.UserInputCustomAddress=void 0,this.WaitingLoaded=!1,this.useSpeaker=!1,this.isSpeeching=!1,this.SpeechThese=[]}ToggleExtMenu(i){this.ShowExtMenus=null!=i?i:!this.ShowExtMenus,setTimeout(()=>{this.auto_scroll_down()},0)}SelectVoidDrawBackgroundImage(i){var e=this;return(0,x.A)(function*(){const a=i.target.files[0],c=`tmp_files/minimal_chat/${a.name}`;yield e.indexed.saveBlobToUserPath(a,c);const u=yield e.indexed.loadBlobFromUserPath(c,a.type),s=URL.createObjectURL(u);new X(r=>{r.setup=()=>{r.noCanvas(),r.loadImage(s,d=>{e.global.PageDismissAct["minimal-image"]=function(){var h=(0,x.A)(function*(o){if(o.data){let g=yield e.global.voidDraw_fileAct_callback(o,"tmp_files/square/",{display_name:e.nakama.users.self.display_name});e.TrySendingAttach(g,"minimal_chat")}delete e.global.PageDismissAct["minimal-image"]});return function(o){return h.apply(this,arguments)}}(),e.global.ActLikeModal("void-draw",{path:c,width:d.width,height:d.height,type:a.type,dismiss:"minimal-image"}),URL.revokeObjectURL(s),r.remove()},d=>{console.log("\ube60\ub978 \uadf8\ub9bc\ud310 \uc5f4\uae30 \uc2e4\ud328: ",d),URL.revokeObjectURL(s),r.remove()})}})})()}CreateFloatingVoiceTimeHistoryAddButton(){this.floatButton.RemoveFloatButton("sqaure-record"),this.floatButton.AddFloatButton("sqaure-record","mic-outline").mouseClicked(()=>{this.p5toast.show({text:`${this.lang.text.GlobalAct.SquareRecording}`})})}StopAndSaveVoiceRecording(){var i=this;return(0,x.A)(function*(){i.floatButton.RemoveFloatButton("sqaure-record");const e="minimal_chat";i.p5loading.update({id:e,message:i.lang.text.AddPost.SavingRecord});try{let a=yield i.global.StopAndSaveVoiceRecording();yield i.SendAttachAct({target:{files:[a]}},e)}catch{}i.p5loading.remove(e),i.extended_buttons[4].icon="mic-circle-outline",i.extended_buttons[4].name=i.lang.text.ChatRoom.Voice})()}ngOnInit(){var i=this;this.global.StoreShortCutAct("minimal-chat-init"),this.useSpeaker=!!localStorage.getItem("useChannelSpeaker"),this.toggle_speakermode(this.useSpeaker),this.route.queryParams.subscribe(function(){var e=(0,x.A)(function*(a){const c=i.router.getCurrentNavigation().extras.state;yield new Promise(u=>setTimeout(u,100)),c&&(i.client.JoinedChannel=c.channel||i.client.JoinedChannel,i.JoinedQuick=c.quick,c.address&&(c.channel&&(i.client.CreateOwnChannel=!1),i.UserInputCustomAddress=c.address,i.init_joinChat(i.client.AutoOpenLink)))});return function(a){return e.apply(this,arguments)}}()),this.global.windowOnFocusAct.minimalchat=()=>{this.lnId&&this.noti.ClearNoti(this.lnId),this.noti.Current=this.Header},this.header_title=this.lang.text.MinimalChat.header_title_group,this.minimal_chat_log=document.getElementById("minimal_chat_div"),this.minimal_chat_log.onscroll=e=>{this.minimal_chat_log.scrollHeight==this.minimal_chat_log.scrollTop+this.minimal_chat_log.clientHeight&&this.scroll_down()},this.ServerList=this.client.nakama.get_all_online_server(),setTimeout(()=>{this.MinimalChatServer?(this.MinimalChatServer.value=this.ServerList[0]||"local",this.SelectAddressTarget({detail:{value:this.MinimalChatServer.value}})):this.NeedInputCustomAddress=!0},0),this.client.cacheAddress&&this.CreateQRCode(),setTimeout(()=>{this.CreateDrop()},100)}ionViewWillEnter(){this.HeaderBefore=this.noti.Current,this.noti.Current=this.Header,this.WaitingLoaded=!0,this.DomMinimalChatInput=document.getElementById("minimalchat_input").childNodes[1].childNodes[1].childNodes[1],this.client.RemoveFloatButton(),this.DomMinimalChatInput.onpaste=i=>{let e=[];for(const a of i.clipboardData.files)e.push({file:a});if(1==e.length)return this.SendAttachAct({target:{files:[e[0].file]}},"minimal_chat"),!1},this.client.IsConnected&&this.focus_on_input()}AddShortCut(){this.global.p5KeyShortCut.EnterAct=i=>{i.ctrlKey?"idle"==this.client.status&&this.init_joinChat():document.activeElement==this.DomMinimalChatInput?this.scroll_down():setTimeout(()=>{this.focus_on_input()},0)}}new_attach(i){var e=this;return(0,x.A)(function*(){const a="minimal_chat";switch(i.detail.value){case"camera":try{let s=yield e.global.from_camera("tmp_files/square/",{display_name:e.nakama.users.self.display_name},a);s&&e.TrySendingAttach(s,a)}catch{}e.AddShortCut();break;case"text":let c=e.global.TextEditorNewFileName();e.global.PageDismissAct["minimal-textedit"]=s=>{if(s.data){let r=e.global.TextEditorAfterAct(s.data,{display_name:e.nakama.users.self.display_name});e.TrySendingAttach(r,a)}delete e.global.PageDismissAct["minimal-textedit"]},e.global.ActLikeModal("ionic-viewer",{info:{content:{is_new:"text",type:"text/plain",viewer:"text",filename:c}},noEdit:!0,dismiss:"minimal-textedit"});break;case"image":e.global.PageDismissAct["minimal-image"]=function(){var s=(0,x.A)(function*(r){if(r.data){let d=yield e.global.voidDraw_fileAct_callback(r,"tmp_files/square/",{display_name:e.nakama.users.self.display_name});e.TrySendingAttach(d,a)}delete e.global.PageDismissAct["minimal-image"]});return function(r){return s.apply(this,arguments)}}(),e.global.ActLikeModal("void-draw",{dismiss:"minimal-image"});break;case"load":e.SelectAttach(),e.AddShortCut();break;case"link":let u;try{try{let h=yield e.global.GetValueFromClipboard(a);switch(h.type){case"text/plain":u=h.value;break;case"image/png":return void e.SendAttachAct({target:{files:[h.value]}},a);case"error":throw h.value}}catch(h){throw h}try{let h=e.global.Base64ToBlob(u),o=u.split(";")[0].split(":")[1],g=new File([h],`${e.lang.text.ChatRoom.FileLink}.${o.split("/").pop()}`,{type:o});throw e.SendAttachAct({target:{files:[g]}},a),"done"}catch(h){if("done"===h)throw h}try{if(0!=u.indexOf("http:")&&0!=u.indexOf("https:"))throw"\uc62c\ubc14\ub978 \uc6f9 \uc8fc\uc18c\uac00 \uc544\ub2d8"}catch(h){throw h}let s={};s.url=u,s.content_related_creator=[],s.content_related_creator.push({user_id:e.client.uuid,timestamp:(new Date).getTime(),display_name:e.nakama.users.self.display_name,various:"link"}),s.content_creator={user_id:e.client.uuid,timestamp:(new Date).getTime(),display_name:e.nakama.users.self.display_name,various:"link"};let r=s.url.split(".");s.file_ext=r.pop().split("?").shift(),s.filename=decodeURIComponent(s.url.split("/").pop()||`${e.lang.text.ChatRoom.ExternalLinkFile}.${s.file_ext}`),e.global.set_viewer_category_from_ext(s),s.type="",s.typeheader=s.viewer,e.client.send(JSON.stringify({type:"file",info:s,name:e.nakama.users.self.display_name}))}catch(s){throw"done"==s?s:`\uc778\uc2dd \ubd88\uac00\ub2a5\ud55c URL \uc815\ubcf4: ${(s.statusText?`${s.statusText}(${s.status})`:s.status)||s}`}}})()}CreateDrop(){var i=this;let e=document.getElementById("p5Drop_chatroom");this.p5canvas=new X(a=>{a.setup=()=>{let d=a.createCanvas(e.clientWidth,e.clientHeight);d.parent(e),a.pixelDensity(.1),d.drop(h=>{let o=a.millis();s<o-400?(u=!1,r.length=0,r.push(h)):(u=!0,r.push(h)),s=o,clearTimeout(c),c=setTimeout((0,x.A)(function*(){const g="minimal_chat";u?i.alertCtrl.create({header:i.lang.text.ChatRoom.MultipleSend,message:`${i.lang.text.ChatRoom.CountFile}: ${r.length}`,buttons:[{text:i.lang.text.ChatRoom.Send,handler:()=>{!function(){var y=(0,x.A)(function*(){i.p5loading.update({id:g,progress:0});for(let M=0,k=r.length;M<k;M++)i.p5loading.update({id:g,progress:M/k}),yield i.SendAttachAct({target:{files:[r[M].file]}},g);i.p5loading.remove(g)});return function(){return y.apply(this,arguments)}}()()}}]}).then(v=>{i.global.StoreShortCutAct("minimal-multiple-send"),v.onDidDismiss().then(()=>{i.global.RestoreShortCutAct("minimal-multiple-send")}),v.present()}):(i.p5loading.update({id:g}),yield i.SendAttachAct({target:{files:[h.file]}},g),i.p5loading.remove(g))}),400)})};let c,u=!1,s=0,r=[];a.mouseMoved=d=>{d.dataTransfer?(e.style.pointerEvents="all",e.style.backgroundColor="#0008"):(e.style.pointerEvents="none",e.style.backgroundColor="transparent")}})}CreateQRCode(){var i=this;return(0,x.A)(function*(){if(i.JoinedQuick)return;i.QRCodeSRC="";const e=yield i.global.GetHeaderAddress();i.QRCodeTargetString=`${e}?group_dedi=${i.client.cacheAddress},${i.client.JoinedChannel||"public"}`,i.QRCodeSRC=i.global.readasQRCodeFromString(i.QRCodeTargetString.replace(/ /g,"%20")),i.focus_on_input()})()}SelectAddressTarget(i){"local"===(this.header_title=this.lang.text.MinimalChat.header_title_group,this.title.setTitle(this.lang.text.MinimalChat.WebTitle_group),i.detail.value)?(this.client.cacheServerInfo=void 0,this.UserInputCustomAddress="",this.NeedInputCustomAddress=!0):(this.client.cacheServerInfo=i.detail.value.info,this.UserInputCustomAddress=`${this.client.cacheServerInfo.useSSL?"wss":"ws"}://${this.client.cacheServerInfo.address}:${this.client.cacheServerInfo.square_port||12013}`,this.NeedInputCustomAddress=!1)}init_joinChat(i=!1){var e=this;this.client.status="custom",this.Header="simplechat",this.noti.ClearNoti(this.lnId),document.getElementById("favicon").setAttribute("href","assets/icon/simplechat.png"),this.extended_buttons[5].isHide=!(this.client.CreateOwnChannel&&2==this.client.MaxChannelMember),this.extended_buttons[5].act(i);try{if(!this.client.client||this.client.client.readyState!=this.client.client.OPEN&&!this.client.p5OnDediMessage){this.client.userInput.logs.length=0,this.client.userInput.logs.push({color:P.ud?"bbb":"444",text:this.lang.text.MinimalChat.joinChat_group,isSystem:!0});let s=this.UserInputCustomAddress.split("://"),r=s.pop().split(":"),d=s.pop();d?d+=":":d=this.global.checkProtocolFromAddress(r[0])?"wss:":"ws:",this.client.initialize(`${d}//${r[0]}`,r[1])}const c=[{title:this.lang.text.MinimalChat.Noti_Reply,action:"sq_reply",type:"text"}];this.client.funcs.onmessage=u=>{var s,r;try{var d,h;let o=JSON.parse(u);this.client.JoinedChannel||(this.client.JoinedChannel=o.channel),this.client.uuid||(this.client.uuid=o.uid);let g=this.client.uuid==o.uid,v=g?this.nakama.users.self.display_name||this.lang.text.MinimalChat.name_me:o.name||this.lang.text.MinimalChat.name_stranger_group,y=o.uid?(o.uid.replace(/[^5-79a-b]/g,"")+"abcdef").substring(0,6):P.ud?"888888":"444444";null===(d=(h=this.client).p5OnDediMessage)||void 0===d||d.call(h,y);let M="certified";if(o.msg){this.useSpeaker&&this.SpeechReceivedMessage(o.msg);let k=o.msg.split(" "),_=[],C="";for(let b=0,R=k.length;b<R;b++)0==k[b].indexOf("http://")||0==k[b].indexOf("https://")?(_.push({text:" "+C+" "}),C="",_.push({href:!0,text:k[b]}),this.client.AutoOpenLink&&!g&&this.nakama.open_url_link(null,k[b]).then(T=>{T&&k[b].indexOf("?token=")>=0&&this.client.disconnect(1e3,"token_act")})):C+=" "+k[b];C&&_.push({text:" "+C}),this.client.userInput.logs.push({color:y,text:_,target:v,isMe:g}),this.noti.PushLocal({id:this.lnId,title:v,body:o.msg,actions_wm:c,smallIcon_ln:"simplechat",bgcolor:y},this.Header,this.open_this)}else if(o.type)switch(o.type){case"join":this.client.userInput.logs.push({color:y,text:[{text:" "+this.lang.text.MinimalChat.user_join_comment}],target:v,isSystem:!0}),this.QRCodeSRC||(this.client.JoinedChannel=o.channel,this.CreateQRCode()),this.noti.PushLocal({id:this.lnId,title:this.lang.text.MinimalChat.user_join,body:v+` | ${this.lang.text.MinimalChat.user_join_comment}`,actions_wm:c,smallIcon_ln:"simplechat",bgcolor:y},this.Header,this.open_this);break;case"expired":this.WebSocketOnCloseAct("expired channel");break;case"leave":this.client.userInput.logs.push({color:y,text:[{text:" "+this.lang.text.MinimalChat.user_out_comment}],target:v,isSystem:!0}),M="pending",this.noti.PushLocal({id:this.lnId,title:this.lang.text.MinimalChat.user_out,body:v+` | ${this.lang.text.MinimalChat.user_out_comment}`,actions_wm:c,smallIcon_ln:"simplechat",bgcolor:y},this.Header,this.open_this),this.client.AutoOpenLink&&this.client.disconnect(1e3,"auto_pair_leave");break;case"file":let C={color:y,file:o,target:v,isMe:g};this.client.userInput.logs.push(C);let A=o.info;o.info.url?this.client.AutoOpenLink&&!g&&this.global.download_file(A):(this.client.DownloadPartManager[o.uid]||(this.client.DownloadPartManager[o.uid]={}),this.client.DownloadPartManager[o.uid][o.temp_id]||(this.client.DownloadPartManager[o.uid][o.temp_id]=C),C.Progress=A.partsize),this.noti.PushLocal({id:this.lnId,title:v,body:this.lang.text.MinimalChat.user_send_attach,image:"image"==(null===(s=o.info)||void 0===s?void 0:s.viewer)?null===(r=o.info)||void 0===r?void 0:r.url:void 0,actions_wm:c,smallIcon_ln:"simplechat",bgcolor:y},this.Header,this.open_this);break;case"part":return this.client.DownloadPartManager[o.uid][o.temp_id].Progress--,void this.indexed.checkIfFileExist(o.path).then(b=>{b||this.indexed.saveBase64ToUserPath(","+o.part,`${o.path}_${o.index}`)});case"EOF":return void this.indexed.checkIfFileExist(o.path).then(function(){var b=(0,x.A)(function*(R){if(R)e.indexed.removeFileFromUserPath(`${o.path}.history`);else if(yield new Promise(function(){var T=(0,x.A)(function*($,w){let j=[],L=0;for(let I=0,B=o.partsize;I<B;I++)try{let S=yield e.indexed.GetFileInfoFromDB(`${o.path}_${I}`);L+=S.contents.length,j[I]=S}catch(S){console.log("\ud30c\uc77c \ubcd1\ud569\ud558\uae30 \uc624\ub958: ",S);break}try{let I=new Int8Array(L),B=0;for(let S=0,E=j.length;S<E;S++)I.set(j[S].contents,B),B+=j[S].contents.length;yield e.indexed.saveInt8ArrayToUserPath(I,o.path);for(let S=0,E=o.partsize;S<E;S++)e.indexed.removeFileFromUserPath(`${o.path}_${S}`);yield e.indexed.removeFileFromUserPath(`${o.path}.history`)}catch(I){console.log("\ud30c\uc77c \ucd5c\uc885 \uc800\uc7a5\ud558\uae30 \uc624\ub958: ",I),w()}$(void 0)});return function($,w){return T.apply(this,arguments)}}()),delete e.client.DownloadPartManager[o.uid][o.temp_id].Progress,delete e.client.DownloadPartManager[o.uid][o.temp_id],e.client.AutoOpenLink&&!g){let T=o.info;e.indexed.DownloadFileFromUserPath(o.path,T.type,T.filename)}});return function(R){return b.apply(this,arguments)}}())}o.max&&(this.client.MaxChannelMember=o.max),o.isOwnChannel&&(this.client.CreateOwnChannel=o.isOwnChannel),this.extended_buttons[5].isHide=!(this.client.CreateOwnChannel&&2==this.client.MaxChannelMember),o.count&&(this.client.ConnectedNow=o.count),this.statusBar.settings.dedicated_groupchat=M,setTimeout(()=>{this.statusBar.settings.dedicated_groupchat==M&&(this.statusBar.settings.dedicated_groupchat="online")},250)}catch{}this.auto_scroll_down()},this.client.funcs.onclose=u=>{this.WebSocketOnCloseAct(u)},this.client.funcs.onopen=u=>{var s,r,d;"MobilePWA"==F.aH&&this.global.forceUseBackgroundMode(),this.statusBar.settings.dedicated_groupchat="online";let h={name:this.nakama.users.self.display_name,type:"join",channel:this.client.CreateOwnChannel?void 0:this.client.JoinedChannel||"public",max:this.client.CreateOwnChannel?this.client.MaxChannelMember:void 0,customInput:!this.JoinedQuick&&this.NeedInputCustomAddress,quick:this.JoinedQuick,server_uid:null===(s=this.nakama.servers[null===(r=this.client.cacheServerInfo)||void 0===r?void 0:r.isOfficial])||void 0===s||null===(s=s[null===(d=this.client.cacheServerInfo)||void 0===d?void 0:d.target])||void 0===s?void 0:s.session.user_id};this.client.send(JSON.stringify(h)),this.client.funcs.onclose=o=>{var g,v;this.UserInputCustomAddress="",this.statusBar.settings.dedicated_groupchat="missing",setTimeout(()=>{this.statusBar.settings.dedicated_groupchat="offline"},1500);let M=`${this.lang.text.MinimalChat.cannot_join}: ${this.lang.text.MinimalChat[o.reason]||o.reason} (${o.code})`;this.client.userInput.logs.push({color:"faa",text:M,isSystem:!0}),this.noti.PushLocal({id:this.lnId,title:M,actions_wm:c,smallIcon_ln:"simplechat",bgcolor:"ffaaaa"},this.Header,null),null===(g=(v=this.client).p5OnDediMessage)||void 0===g||g.call(v,"ff0000"),this.client.disconnect(1e3,`init_close_func: ${o}`)}}}catch(c){console.log("\uad11\uc7a5 \ucc44\ub110 \uc811\uc18d \uc2e4\ud328: ",c),this.WebSocketOnCloseAct(c)}}WebSocketOnCloseAct(i){var e,a;this.statusBar.settings.dedicated_groupchat="missing",setTimeout(()=>{this.statusBar.settings.dedicated_groupchat="offline"},1500),this.client.userInput.logs.push({color:"faa",text:this.lang.text.MinimalChat.failed_to_join,isSystem:!0}),this.noti.PushLocal({id:this.lnId,title:this.lang.text.MinimalChat.failed_to_join,smallIcon_ln:"simplechat",bgcolor:"ffaaaa"},this.Header,null),this.UserInputCustomAddress="",null===(e=(a=this.client).p5OnDediMessage)||void 0===e||e.call(a,"ff0000"),this.client.disconnect(1e3,i)}copy_qr_address(i=this.QRCodeTargetString){this.global.WriteValueToClipboard("text/plain",i,void 0,"minimal_chat")}SelectAttach(){document.getElementById("minimal_chat_file").click()}SendAttachAct(i,e){var a=this;return(0,x.A)(function*(){for(let c=0,u=i.target.files.length;c<u;c++){let s=i.target.files[c],r={};r.blob=s,r.filename=s.name,r.size=s.size,r.file_ext=s.name.split(".").pop(),r.type=s.type,a.global.set_viewer_category(r),r.content_related_creator=[{user_id:a.client.uuid,timestamp:(new Date).getTime(),display_name:a.nakama.users.self.display_name,various:"loaded"}],r.content_creator={user_id:a.client.uuid,timestamp:(new Date).getTime(),display_name:a.nakama.users.self.display_name,various:"loaded"},yield a.TrySendingAttach(r,e)}})()}TrySendingAttach(i,e){var a=this;return(0,x.A)(function*(){let c=`${Date.now()}`,u={type:"file",info:i,temp_id:c,name:a.nakama.users.self.display_name};try{let s;try{s=`${a.client.cacheServerInfo.useSSL?"https":"http"}://${a.client.cacheServerInfo.address},${a.client.cacheServerInfo.cdn_port||9001},${a.client.cacheServerInfo.apache_port||9002}`}catch{}const r=(new Date).getTime(),d=`tmp_${a.client.JoinedChannel||"public"}_${a.client.uuid}`;i.override_name=`${d.replace(/\//g,"_")}_${r}_${i.filename}`,i.override_path="",i.override_filename=i.override_name,delete i.thumbnail;let h=yield a.global.try_upload_to_user_custom_fs(i,d,e,a.lang.text.MinimalChat.header_title_group,s);if(!h)throw"\ubd84\ud560 \uc804\uc1a1 \uc2dc\ub3c4 \ud544\uc694";i.url=h,delete i.blob,a.client.send(JSON.stringify(u)),a.focus_on_input()}catch{if(i.url){let h=yield fetch(i.url);if(h.ok){let o=yield h.blob();i.blob=o}}i.path=`tmp_files/sqaure/${c}.${i.file_ext}`,yield a.indexed.saveBlobToUserPath(i.blob,i.path);let r=yield a.indexed.GetFileInfoFromDB(i.path);i.partsize=Math.ceil(i.size/P.xM),delete i.blob,a.client.send(JSON.stringify(u)),a.focus_on_input();for(let h=0;h<i.partsize;h++){yield new Promise(v=>setTimeout(v,a.global.WebsocketRetryTerm));let o=a.global.req_file_part_base64(r,h,i.path);a.client.send(JSON.stringify({type:"part",path:i.path,index:h,part:o,temp_id:c}))}yield new Promise(h=>setTimeout(h,a.global.WebsocketRetryTerm)),a.client.send(JSON.stringify({type:"EOF",path:i.path,info:i,partsize:i.partsize,temp_id:c}))}a.p5loading.remove(e),a.auto_scroll_down()})()}WaitingCurrent(){var i=this;return(0,x.A)(function*(){for(;!i.WaitingLoaded;)yield new Promise(e=>setTimeout(e,0));return!0})()}CheckIfDismissAct(i){"square_qrshare"===i.target.id&&this.SquareQRShare.dismiss()}toggle_speakermode(i){var e=this;return(0,x.A)(function*(){if(e.useSpeaker=null!=i?i:!e.useSpeaker,e.extended_buttons[6].icon=e.useSpeaker?"volume-high-outline":"volume-mute-outline",e.useSpeaker?localStorage.setItem("useChannelSpeaker",`${e.useSpeaker}`):localStorage.removeItem("useChannelSpeaker"),!e.useSpeaker)try{yield U.x.stop()}catch{}})()}SpeechReceivedMessage(i){try{i&&i.trim()&&this.SpeechThese.push(i),this.isSpeeching||this.SpeechingTexts()}catch{}}SpeechingTexts(){var i=this;return(0,x.A)(function*(){let e=i.SpeechThese.shift();i.isSpeeching=!0,e&&e.trim()&&(yield U.x.speak({text:e,lang:i.lang.lang})),i.SpeechThese.length?i.SpeechingTexts():i.isSpeeching=!1})()}OpenSquareQRCode(){this.SquareQRShare.present()}open_file_viewer(i){var e=this;const a="minimal_chat";let c=[];for(let u=0,s=this.client.userInput.logs.length;u<s;u++)try{this.client.userInput.logs[u].file.info.filename&&c.push({content:JSON.parse(JSON.stringify(this.client.userInput.logs[u].file.info))})}catch{}this.global.PageDismissAct["minimal-ionic-viewer"]=function(){var u=(0,x.A)(function*(s){if(s.data)switch(s.data.type){case"image":let r=[];if(s.data.msg.content.content_related_creator&&(r=[...s.data.msg.content.content_related_creator]),s.data.msg.content.content_creator){let d=!1;for(let h=0,o=r.length;h<o;h++)if(r[h].user_id==s.data.msg.content.content_creator.user_id){d=!0;break}d||r.push(s.data.msg.content.content_creator)}return e.global.PageDismissAct["minimal-ionic-viewer-edit"]=d=>{if(d.data){e.p5loading.remove(d.data.loadingCtrl);let h=d.data.img;e.indexed.saveBase64ToUserPath(h,`tmp_files/sqaure/${d.data.name}`);let g=e.global.Base64ToBlob(h,"image/png");g.name=d.data.name,e.SendAttachAct({target:{files:[g]}},a)}delete e.global.PageDismissAct["minimal-ionic-viewer-edit"]},yield e.WaitingCurrent(),void e.global.ActLikeModal("void-draw",{path:s.data.path||i.path,width:s.data.width,height:s.data.height,type:s.data.filetype,isDarkMode:s.data.isDarkMode,scrollHeight:s.data.scrollHeight,dismiss:"minimal-ionic-viewer-edit"});case"text":s.data.blob.name=e.global.TextEditorNewFileName(),s.data.path=`tmp_files/texteditor/${s.data.blob.name}`,e.SendAttachAct({target:{files:[s.data.blob]}},a)}delete e.global.PageDismissAct["minimal-ionic-viewer"]});return function(s){return u.apply(this,arguments)}}(),this.global.ActLikeModal("ionic-viewer",{info:{content:i},isOfficial:"local",path:i.path,relevance:c,dismiss:"minimal-ionic-viewer"})}download_file(i){return this.global.download_file(i),!1}ionViewDidEnter(){this.AddShortCut(),setTimeout(()=>{this.scroll_down()},0)}scroll_down(){this.minimal_chat_log.scrollTo({top:this.minimal_chat_log.scrollHeight,behavior:"smooth"})}focus_on_input(i){"DesktopPWA"==F.aH&&this.minimalchat_input.setFocus(),this.auto_scroll_down(i)}auto_scroll_down(i){setTimeout(()=>{let e=this.minimal_chat_log.scrollHeight;e<this.minimal_chat_log.scrollTop+this.minimal_chat_log.clientHeight+120&&this.minimal_chat_log.scrollTo({top:e,behavior:"smooth"})},i||0)}send(i){this.statusBar.settings.dedicated_groupchat="certified",setTimeout(()=>{"certified"==this.statusBar.settings.dedicated_groupchat&&(this.statusBar.settings.dedicated_groupchat="online")},250);let e={msg:i||this.client.userInput.text};e.msg.trim()&&(this.ToggleExtMenu(!1),e.name=this.nakama.users.self.display_name,this.client.send(JSON.stringify(e)),this.client.userInput.text="",this.focus_on_input())}quit_chat(){this.client.funcs.onclose=()=>{this.UserInputCustomAddress="",this.statusBar.settings.dedicated_groupchat="missing",setTimeout(()=>{this.statusBar.settings.dedicated_groupchat="offline"},1500),this.client.userInput.logs.push({color:P.ud?"ffa":"884",text:this.lang.text.MinimalChat.leave_chat_group,isSystem:!0}),this.minimal_chat_log.scrollTo({top:this.minimal_chat_log.scrollHeight,behavior:"smooth"})},this.noti.ClearNoti(this.lnId),this.navCtrl.pop(),this.indexed.GetFileListFromDB("tmp_files/sqaure").then(i=>i.forEach(e=>this.indexed.removeFileFromUserPath(e))),this.client.disconnect(),this.client.DownloadPartManager={}}ionViewWillLeave(){this.WaitingLoaded=!1,this.title.setTitle("Project: Cone"),document.getElementById("favicon").setAttribute("href","assets/icon/favicon.png"),this.noti.Current=this.HeaderBefore||"",delete this.global.p5KeyShortCut.EnterAct,this.useVoiceRecording&&this.StopAndSaveVoiceRecording()}ionViewDidLeave(){this.client.IsConnected&&this.client.CreateRejoinButton()}ngOnDestroy(){this.useSpeaker=!1,this.SquareQRShare.dismiss(),this.p5loading.update({id:"minimal_chat",forceEnd:0},!0),this.global.RestoreShortCutAct("minimal-chat-init"),this.route.queryParams.unsubscribe(),delete this.global.windowOnFocusAct.minimalchat,this.minimal_chat_log.onscroll=null,this.DomMinimalChatInput.onpaste=null,this.p5canvas&&this.p5canvas.remove()}}return(l=m).\u0275fac=function(i){return new(i||l)(t.rXU(J.z),t.rXU(H.r),t.rXU(Y.hE),t.rXU(Q.q9),t.rXU(G.nX),t.rXU(G.Ix),t.rXU(q.j),t.rXU(W.y),t.rXU(P.z3),t.rXU(z.G),t.rXU(K.n),t.rXU(f.hG),t.rXU(Z.X),t.rXU(tt.u),t.rXU(et.f))},l.\u0275cmp=t.VBU({type:l,selectors:[["app-minimal-chat"]],viewQuery:function(i,e){if(1&i&&(t.GBs(it,5),t.GBs(nt,5),t.GBs(at,5)),2&i){let a;t.mGM(a=t.lsd())&&(e.MinimalChatServer=a.first),t.mGM(a=t.lsd())&&(e.SquareQRShare=a.first),t.mGM(a=t.lsd())&&(e.minimalchat_input=a.first)}},decls:37,vars:10,consts:[["SquareQRShare",""],["minimalchat_input",""],["MinimalChatServer",""],[1,"ion-no-border"],["slot","start",3,"click"],["defaultHref",""],["class","top_icon","slot","end","name","qr-code-outline",3,"click",4,"ngIf"],["slot","end",2,"margin","8px 16px"],["scrollY","false"],["id","p5Drop_chatroom",2,"position","absolute","width","100%","height","100%","display","flex","pointer-events","none","z-index","500"],[2,"display","flex","flex-direction","column","height","100%"],["style","flex: 0 1 auto;",4,"ngIf"],["id","minimal_chat_div",1,"main",2,"flex","1 1 auto"],[4,"ngIf"],[2,"user-select","text"],[4,"ngFor","ngForOf"],[1,"transparent-modal"],[2,"width","100%"],["expand","block","fill","clear",3,"click"],["name","exit"],["id","minimalchat_input","type","text",3,"ionFocus","keyup.enter","ngModelChange","placeholder","ngModel"],["name","add-outline"],["hidden","","type","file","id","minimal_chat_file","accept","*","multiple","",3,"change"],["name","send"],["style","height: 240px; overflow-x: hidden; overflow-y: auto; scroll-behavior: smooth; text-align: center; background-color: var(--chatroom-background);",4,"ngIf"],["slot","end","name","qr-code-outline",1,"top_icon",3,"click"],[2,"flex","0 1 auto"],["button","",4,"ngIf"],["button",""],[3,"ngModelChange","ngModel"],["class","shortcut_hint",4,"ngIf"],["button","",3,"click"],[1,"ion-text-center"],["value","local",2,"pointer-events","none",3,"ionChange","label"],["value","local"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","(wss://)0.0.0.0:12013",1,"ion-text-right",3,"ngModelChange","label","ngModel"],["slot","end","name","open-outline",3,"click"],["placeholder","public",1,"ion-text-right",3,"ngModelChange","label","ngModel"],["type","number","min","0","placeholder","0",1,"ion-text-right",3,"ngModelChange","label","ngModel"],[1,"shortcut_hint"],["alt","QRCode",2,"width","100%","height","auto","cursor","copy",3,"click","src"],["disabled","","color","medium",1,"ion-text-center"],[3,"style",4,"ngIf"],["class","default_text",4,"ngIf"],[1,"default_text"],["target","_system","onclick","return false;",3,"href","click",4,"ngIf"],["target","_system","onclick","return false;",3,"click","href"],[1,"file_attach_box",3,"click","contextmenu"],["id","square_qrshare",1,"OutterModal",3,"click"],[2,"width","400px","min-height","455px","background-color","var(--chatroom-background)","text-align","center","padding","16px"],["style","width: 100%; height: auto; cursor: copy; margin-bottom: 8px;","alt","QuickLink",3,"src","click",4,"ngIf"],["alt","QuickLink",2,"width","100%","height","auto","cursor","copy","margin-bottom","8px",3,"click","src"],[2,"height","240px","overflow-x","hidden","overflow-y","auto","scroll-behavior","smooth","text-align","center","background-color","var(--chatroom-background)"],["style","display: inline-block;",4,"ngFor","ngForOf"],[2,"display","inline-block"],[1,"ext_button",3,"click","contextmenu","hidden"],["slot","icon-only","style","width: 36px; height: 36px;",3,"name",4,"ngIf"],["class","ext_icon_img",3,"src","alt",4,"ngIf"],["slot","icon-only",2,"width","36px","height","36px",3,"name"],[1,"ext_icon_img",3,"src","alt"]],template:function(i,e){if(1&i){const a=t.RV6();t.j41(0,"ion-header",3)(1,"ion-toolbar")(2,"ion-buttons",4),t.bIt("click",function(){return t.eBV(a),t.Njj(e.navCtrl.pop())}),t.nrm(3,"ion-back-button",5),t.k0s(),t.j41(4,"ion-title"),t.EFF(5),t.k0s(),t.DNE(6,lt,1,0,"ion-icon",6),t.j41(7,"div",7),t.EFF(8),t.k0s()()(),t.j41(9,"ion-content",8),t.nrm(10,"div",9),t.j41(11,"div",10),t.DNE(12,ut,13,8,"div",11),t.j41(13,"div",12),t.DNE(14,mt,5,2,"div",13),t.j41(15,"div",14),t.DNE(16,yt,3,2,"p",15),t.k0s()()(),t.j41(17,"ion-modal",16,0),t.DNE(19,St,6,2,"ng-template"),t.k0s()(),t.j41(20,"ion-footer")(21,"table",17)(22,"tr")(23,"td")(24,"ion-button",18),t.bIt("click",function(){return t.eBV(a),t.Njj(e.quit_chat())}),t.nrm(25,"ion-icon",19),t.k0s()(),t.j41(26,"td",17)(27,"ion-input",20,1),t.bIt("ionFocus",function(){return t.eBV(a),t.Njj(e.focus_on_input(120))})("keyup.enter",function(){return t.eBV(a),t.Njj(e.send())}),t.mxI("ngModelChange",function(u){return t.eBV(a),t.DH7(e.client.userInput.text,u)||(e.client.userInput.text=u),t.Njj(u)}),t.k0s()(),t.j41(29,"td")(30,"ion-button",18),t.bIt("click",function(){return t.eBV(a),t.Njj(e.ToggleExtMenu())}),t.nrm(31,"ion-icon",21),t.k0s(),t.j41(32,"input",22),t.bIt("change",function(u){return t.eBV(a),t.Njj(e.SendAttachAct(u))}),t.k0s()(),t.j41(33,"td")(34,"ion-button",18),t.bIt("click",function(){return t.eBV(a),t.Njj(e.send())}),t.nrm(35,"ion-icon",23),t.k0s()()()(),t.DNE(36,It,2,1,"div",24),t.k0s()}2&i&&(t.R7$(5),t.JRh(e.header_title),t.R7$(),t.Y8G("ngIf","idle"!=e.client.status&&e.client.MaxChannelMember!=e.client.ConnectedNow),t.R7$(2),t.Lme("",e.lang.text.MinimalChat.concurrent_users,": ",e.client.ConnectedNow,""),t.R7$(4),t.Y8G("ngIf","idle"==e.client.status),t.R7$(2),t.Y8G("ngIf",e.QRCodeSRC&&!e.JoinedQuick&&"idle"!=e.client.status&&1==e.client.ConnectedNow),t.R7$(2),t.Y8G("ngForOf",e.client.userInput.logs),t.R7$(11),t.Y8G("placeholder",e.lang.text.ChatRoom.input_placeholder),t.R50("ngModel",e.client.userInput.text),t.R7$(9),t.Y8G("ngIf",e.ShowExtMenus))},dependencies:[D.Sq,D.bT,N.BC,N.vS,f.Jm,f.QW,f.W9,f.M0,f.eU,f.iq,f.$w,f.uz,f.he,f.Nm,f.Ip,f.BC,f.BY,f.ai,f.Sb,f.hB,f.su,f.Je,f.Gw,f.el,f.T6],styles:[".main[_ngcontent-%COMP%]{width:100%;padding:8px;overflow-x:hidden;overflow-y:auto;scroll-behavior:smooth}p[_ngcontent-%COMP%]{margin:8px 0 0}.default_text[_ngcontent-%COMP%]{color:var(--miniranchat-default-text)}.bottom_thumbnail[_ngcontent-%COMP%]{width:100%;max-width:100vw;height:-moz-fit-content;height:fit-content;max-height:96px;transform:translateY(-100%);position:absolute;background:var(--chatroom-last-msg-viewer-bg);padding:8px;overflow:hidden}ion-button[_ngcontent-%COMP%]{--padding-start: 12px;--padding-end: 12px}.file_attach_box[_ngcontent-%COMP%]{margin-left:8px;padding:2px 8px;border-radius:6px;background-color:#8888;cursor:pointer}ion-input[_ngcontent-%COMP%]{--highlight-color-valid: var(--ion-color-primary)}"]}),m})()}];let Pt=(()=>{var l;class m{}return(l=m).\u0275fac=function(i){return new(i||l)},l.\u0275mod=t.$C({type:l}),l.\u0275inj=t.G2t({imports:[G.iI.forChild(Tt),G.iI]}),m})(),jt=(()=>{var l;class m{}return(l=m).\u0275fac=function(i){return new(i||l)},l.\u0275mod=t.$C({type:l}),l.\u0275inj=t.G2t({imports:[D.MD,N.YN,f.bv,Pt]}),m})()}}]);